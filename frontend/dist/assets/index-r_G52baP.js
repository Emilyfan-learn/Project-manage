import{r as d,a as _s,L as te,u as Re,B as Ns,R as vs,b as je,c as ws}from"./react-vendor-BNBxMtok.js";import{G as Ss}from"./chart-vendor-B5Xyzo6s.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();var Wt={exports:{}},Ze={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cs=d,ks=Symbol.for("react.element"),Es=Symbol.for("react.fragment"),Fs=Object.prototype.hasOwnProperty,Rs=Cs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ds={key:!0,ref:!0,__self:!0,__source:!0};function Ut(t,s,n){var a,r={},l=null,i=null;n!==void 0&&(l=""+n),s.key!==void 0&&(l=""+s.key),s.ref!==void 0&&(i=s.ref);for(a in s)Fs.call(s,a)&&!Ds.hasOwnProperty(a)&&(r[a]=s[a]);if(t&&t.defaultProps)for(a in s=t.defaultProps,s)r[a]===void 0&&(r[a]=s[a]);return{$$typeof:ks,type:t,key:l,ref:i,props:r,_owner:Rs.current}}Ze.Fragment=Es;Ze.jsx=Ut;Ze.jsxs=Ut;Wt.exports=Ze;var e=Wt.exports,ot={},wt=_s;ot.createRoot=wt.createRoot,ot.hydrateRoot=wt.hydrateRoot;function Ht(t,s){return function(){return t.apply(s,arguments)}}const{toString:Ps}=Object.prototype,{getPrototypeOf:pt}=Object,{iterator:et,toStringTag:qt}=Symbol,tt=(t=>s=>{const n=Ps.call(s);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),fe=t=>(t=t.toLowerCase(),s=>tt(s)===t),st=t=>s=>typeof s===t,{isArray:De}=Array,Fe=st("undefined");function Ie(t){return t!==null&&!Fe(t)&&t.constructor!==null&&!Fe(t.constructor)&&xe(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const zt=fe("ArrayBuffer");function Os(t){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(t):s=t&&t.buffer&&zt(t.buffer),s}const Ts=st("string"),xe=st("function"),Jt=st("number"),Be=t=>t!==null&&typeof t=="object",$s=t=>t===!0||t===!1,Ye=t=>{if(tt(t)!=="object")return!1;const s=pt(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(qt in t)&&!(et in t)},Ls=t=>{if(!Be(t)||Ie(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},Is=fe("Date"),Bs=fe("File"),As=fe("Blob"),Ms=fe("FileList"),Ws=t=>Be(t)&&xe(t.pipe),Us=t=>{let s;return t&&(typeof FormData=="function"&&t instanceof FormData||xe(t.append)&&((s=tt(t))==="formdata"||s==="object"&&xe(t.toString)&&t.toString()==="[object FormData]"))},Hs=fe("URLSearchParams"),[qs,zs,Js,Vs]=["ReadableStream","Request","Response","Headers"].map(fe),Ys=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ae(t,s,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let a,r;if(typeof t!="object"&&(t=[t]),De(t))for(a=0,r=t.length;a<r;a++)s.call(null,t[a],a,t);else{if(Ie(t))return;const l=n?Object.getOwnPropertyNames(t):Object.keys(t),i=l.length;let x;for(a=0;a<i;a++)x=l[a],s.call(null,t[x],x,t)}}function Vt(t,s){if(Ie(t))return null;s=s.toLowerCase();const n=Object.keys(t);let a=n.length,r;for(;a-- >0;)if(r=n[a],s===r.toLowerCase())return r;return null}const Ce=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Yt=t=>!Fe(t)&&t!==Ce;function ut(){const{caseless:t,skipUndefined:s}=Yt(this)&&this||{},n={},a=(r,l)=>{const i=t&&Vt(n,l)||l;Ye(n[i])&&Ye(r)?n[i]=ut(n[i],r):Ye(r)?n[i]=ut({},r):De(r)?n[i]=r.slice():(!s||!Fe(r))&&(n[i]=r)};for(let r=0,l=arguments.length;r<l;r++)arguments[r]&&Ae(arguments[r],a);return n}const Gs=(t,s,n,{allOwnKeys:a}={})=>(Ae(s,(r,l)=>{n&&xe(r)?t[l]=Ht(r,n):t[l]=r},{allOwnKeys:a}),t),Ks=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Xs=(t,s,n,a)=>{t.prototype=Object.create(s.prototype,a),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:s.prototype}),n&&Object.assign(t.prototype,n)},Qs=(t,s,n,a)=>{let r,l,i;const x={};if(s=s||{},t==null)return s;do{for(r=Object.getOwnPropertyNames(t),l=r.length;l-- >0;)i=r[l],(!a||a(i,t,s))&&!x[i]&&(s[i]=t[i],x[i]=!0);t=n!==!1&&pt(t)}while(t&&(!n||n(t,s))&&t!==Object.prototype);return s},Zs=(t,s,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=s.length;const a=t.indexOf(s,n);return a!==-1&&a===n},ea=t=>{if(!t)return null;if(De(t))return t;let s=t.length;if(!Jt(s))return null;const n=new Array(s);for(;s-- >0;)n[s]=t[s];return n},ta=(t=>s=>t&&s instanceof t)(typeof Uint8Array<"u"&&pt(Uint8Array)),sa=(t,s)=>{const a=(t&&t[et]).call(t);let r;for(;(r=a.next())&&!r.done;){const l=r.value;s.call(t,l[0],l[1])}},aa=(t,s)=>{let n;const a=[];for(;(n=t.exec(s))!==null;)a.push(n);return a},na=fe("HTMLFormElement"),ra=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,a,r){return a.toUpperCase()+r}),St=(({hasOwnProperty:t})=>(s,n)=>t.call(s,n))(Object.prototype),la=fe("RegExp"),Gt=(t,s)=>{const n=Object.getOwnPropertyDescriptors(t),a={};Ae(n,(r,l)=>{let i;(i=s(r,l,t))!==!1&&(a[l]=i||r)}),Object.defineProperties(t,a)},ia=t=>{Gt(t,(s,n)=>{if(xe(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const a=t[n];if(xe(a)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},ca=(t,s)=>{const n={},a=r=>{r.forEach(l=>{n[l]=!0})};return De(t)?a(t):a(String(t).split(s)),n},da=()=>{},oa=(t,s)=>t!=null&&Number.isFinite(t=+t)?t:s;function ua(t){return!!(t&&xe(t.append)&&t[qt]==="FormData"&&t[et])}const xa=t=>{const s=new Array(10),n=(a,r)=>{if(Be(a)){if(s.indexOf(a)>=0)return;if(Ie(a))return a;if(!("toJSON"in a)){s[r]=a;const l=De(a)?[]:{};return Ae(a,(i,x)=>{const p=n(i,r+1);!Fe(p)&&(l[x]=p)}),s[r]=void 0,l}}return a};return n(t,0)},ma=fe("AsyncFunction"),ha=t=>t&&(Be(t)||xe(t))&&xe(t.then)&&xe(t.catch),Kt=((t,s)=>t?setImmediate:s?((n,a)=>(Ce.addEventListener("message",({source:r,data:l})=>{r===Ce&&l===n&&a.length&&a.shift()()},!1),r=>{a.push(r),Ce.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",xe(Ce.postMessage)),pa=typeof queueMicrotask<"u"?queueMicrotask.bind(Ce):typeof process<"u"&&process.nextTick||Kt,ga=t=>t!=null&&xe(t[et]),N={isArray:De,isArrayBuffer:zt,isBuffer:Ie,isFormData:Us,isArrayBufferView:Os,isString:Ts,isNumber:Jt,isBoolean:$s,isObject:Be,isPlainObject:Ye,isEmptyObject:Ls,isReadableStream:qs,isRequest:zs,isResponse:Js,isHeaders:Vs,isUndefined:Fe,isDate:Is,isFile:Bs,isBlob:As,isRegExp:la,isFunction:xe,isStream:Ws,isURLSearchParams:Hs,isTypedArray:ta,isFileList:Ms,forEach:Ae,merge:ut,extend:Gs,trim:Ys,stripBOM:Ks,inherits:Xs,toFlatObject:Qs,kindOf:tt,kindOfTest:fe,endsWith:Zs,toArray:ea,forEachEntry:sa,matchAll:aa,isHTMLForm:na,hasOwnProperty:St,hasOwnProp:St,reduceDescriptors:Gt,freezeMethods:ia,toObjectSet:ca,toCamelCase:ra,noop:da,toFiniteNumber:oa,findKey:Vt,global:Ce,isContextDefined:Yt,isSpecCompliantForm:ua,toJSONObject:xa,isAsyncFn:ma,isThenable:ha,setImmediate:Kt,asap:pa,isIterable:ga};function V(t,s,n,a,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",s&&(this.code=s),n&&(this.config=n),a&&(this.request=a),r&&(this.response=r,this.status=r.status?r.status:null)}N.inherits(V,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:N.toJSONObject(this.config),code:this.code,status:this.status}}});const Xt=V.prototype,Qt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Qt[t]={value:t}});Object.defineProperties(V,Qt);Object.defineProperty(Xt,"isAxiosError",{value:!0});V.from=(t,s,n,a,r,l)=>{const i=Object.create(Xt);N.toFlatObject(t,i,function(c){return c!==Error.prototype},u=>u!=="isAxiosError");const x=t&&t.message?t.message:"Error",p=s==null&&t?t.code:s;return V.call(i,x,p,n,a,r),t&&i.cause==null&&Object.defineProperty(i,"cause",{value:t,configurable:!0}),i.name=t&&t.name||"Error",l&&Object.assign(i,l),i};const fa=null;function xt(t){return N.isPlainObject(t)||N.isArray(t)}function Zt(t){return N.endsWith(t,"[]")?t.slice(0,-2):t}function Ct(t,s,n){return t?t.concat(s).map(function(r,l){return r=Zt(r),!n&&l?"["+r+"]":r}).join(n?".":""):s}function ya(t){return N.isArray(t)&&!t.some(xt)}const ja=N.toFlatObject(N,{},null,function(s){return/^is[A-Z]/.test(s)});function at(t,s,n){if(!N.isObject(t))throw new TypeError("target must be an object");s=s||new FormData,n=N.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,y){return!N.isUndefined(y[w])});const a=n.metaTokens,r=n.visitor||c,l=n.dots,i=n.indexes,p=(n.Blob||typeof Blob<"u"&&Blob)&&N.isSpecCompliantForm(s);if(!N.isFunction(r))throw new TypeError("visitor must be a function");function u(m){if(m===null)return"";if(N.isDate(m))return m.toISOString();if(N.isBoolean(m))return m.toString();if(!p&&N.isBlob(m))throw new V("Blob is not supported. Use a Buffer instead.");return N.isArrayBuffer(m)||N.isTypedArray(m)?p&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function c(m,w,y){let k=m;if(m&&!y&&typeof m=="object"){if(N.endsWith(w,"{}"))w=a?w:w.slice(0,-2),m=JSON.stringify(m);else if(N.isArray(m)&&ya(m)||(N.isFileList(m)||N.endsWith(w,"[]"))&&(k=N.toArray(m)))return w=Zt(w),k.forEach(function(g,S){!(N.isUndefined(g)||g===null)&&s.append(i===!0?Ct([w],S,l):i===null?w:w+"[]",u(g))}),!1}return xt(m)?!0:(s.append(Ct(y,w,l),u(m)),!1)}const _=[],o=Object.assign(ja,{defaultVisitor:c,convertValue:u,isVisitable:xt});function R(m,w){if(!N.isUndefined(m)){if(_.indexOf(m)!==-1)throw Error("Circular reference detected in "+w.join("."));_.push(m),N.forEach(m,function(k,h){(!(N.isUndefined(k)||k===null)&&r.call(s,k,N.isString(h)?h.trim():h,w,o))===!0&&R(k,w?w.concat(h):[h])}),_.pop()}}if(!N.isObject(t))throw new TypeError("data must be an object");return R(t),s}function kt(t){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(a){return s[a]})}function gt(t,s){this._pairs=[],t&&at(t,this,s)}const es=gt.prototype;es.append=function(s,n){this._pairs.push([s,n])};es.toString=function(s){const n=s?function(a){return s.call(this,a,kt)}:kt;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};function ba(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function ts(t,s,n){if(!s)return t;const a=n&&n.encode||ba;N.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let l;if(r?l=r(s,n):l=N.isURLSearchParams(s)?s.toString():new gt(s,n).toString(a),l){const i=t.indexOf("#");i!==-1&&(t=t.slice(0,i)),t+=(t.indexOf("?")===-1?"?":"&")+l}return t}class Et{constructor(){this.handlers=[]}use(s,n,a){return this.handlers.push({fulfilled:s,rejected:n,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){N.forEach(this.handlers,function(a){a!==null&&s(a)})}}const ss={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},_a=typeof URLSearchParams<"u"?URLSearchParams:gt,Na=typeof FormData<"u"?FormData:null,va=typeof Blob<"u"?Blob:null,wa={isBrowser:!0,classes:{URLSearchParams:_a,FormData:Na,Blob:va},protocols:["http","https","file","blob","url","data"]},ft=typeof window<"u"&&typeof document<"u",mt=typeof navigator=="object"&&navigator||void 0,Sa=ft&&(!mt||["ReactNative","NativeScript","NS"].indexOf(mt.product)<0),Ca=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ka=ft&&window.location.href||"http://localhost",Ea=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ft,hasStandardBrowserEnv:Sa,hasStandardBrowserWebWorkerEnv:Ca,navigator:mt,origin:ka},Symbol.toStringTag,{value:"Module"})),ce={...Ea,...wa};function Fa(t,s){return at(t,new ce.classes.URLSearchParams,{visitor:function(n,a,r,l){return ce.isNode&&N.isBuffer(n)?(this.append(a,n.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...s})}function Ra(t){return N.matchAll(/\w+|\[(\w*)]/g,t).map(s=>s[0]==="[]"?"":s[1]||s[0])}function Da(t){const s={},n=Object.keys(t);let a;const r=n.length;let l;for(a=0;a<r;a++)l=n[a],s[l]=t[l];return s}function as(t){function s(n,a,r,l){let i=n[l++];if(i==="__proto__")return!0;const x=Number.isFinite(+i),p=l>=n.length;return i=!i&&N.isArray(r)?r.length:i,p?(N.hasOwnProp(r,i)?r[i]=[r[i],a]:r[i]=a,!x):((!r[i]||!N.isObject(r[i]))&&(r[i]=[]),s(n,a,r[i],l)&&N.isArray(r[i])&&(r[i]=Da(r[i])),!x)}if(N.isFormData(t)&&N.isFunction(t.entries)){const n={};return N.forEachEntry(t,(a,r)=>{s(Ra(a),r,n,0)}),n}return null}function Pa(t,s,n){if(N.isString(t))try{return(s||JSON.parse)(t),N.trim(t)}catch(a){if(a.name!=="SyntaxError")throw a}return(n||JSON.stringify)(t)}const Me={transitional:ss,adapter:["xhr","http","fetch"],transformRequest:[function(s,n){const a=n.getContentType()||"",r=a.indexOf("application/json")>-1,l=N.isObject(s);if(l&&N.isHTMLForm(s)&&(s=new FormData(s)),N.isFormData(s))return r?JSON.stringify(as(s)):s;if(N.isArrayBuffer(s)||N.isBuffer(s)||N.isStream(s)||N.isFile(s)||N.isBlob(s)||N.isReadableStream(s))return s;if(N.isArrayBufferView(s))return s.buffer;if(N.isURLSearchParams(s))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let x;if(l){if(a.indexOf("application/x-www-form-urlencoded")>-1)return Fa(s,this.formSerializer).toString();if((x=N.isFileList(s))||a.indexOf("multipart/form-data")>-1){const p=this.env&&this.env.FormData;return at(x?{"files[]":s}:s,p&&new p,this.formSerializer)}}return l||r?(n.setContentType("application/json",!1),Pa(s)):s}],transformResponse:[function(s){const n=this.transitional||Me.transitional,a=n&&n.forcedJSONParsing,r=this.responseType==="json";if(N.isResponse(s)||N.isReadableStream(s))return s;if(s&&N.isString(s)&&(a&&!this.responseType||r)){const i=!(n&&n.silentJSONParsing)&&r;try{return JSON.parse(s,this.parseReviver)}catch(x){if(i)throw x.name==="SyntaxError"?V.from(x,V.ERR_BAD_RESPONSE,this,null,this.response):x}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ce.classes.FormData,Blob:ce.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};N.forEach(["delete","get","head","post","put","patch"],t=>{Me.headers[t]={}});const Oa=N.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ta=t=>{const s={};let n,a,r;return t&&t.split(`
`).forEach(function(i){r=i.indexOf(":"),n=i.substring(0,r).trim().toLowerCase(),a=i.substring(r+1).trim(),!(!n||s[n]&&Oa[n])&&(n==="set-cookie"?s[n]?s[n].push(a):s[n]=[a]:s[n]=s[n]?s[n]+", "+a:a)}),s},Ft=Symbol("internals");function Le(t){return t&&String(t).trim().toLowerCase()}function Ge(t){return t===!1||t==null?t:N.isArray(t)?t.map(Ge):String(t)}function $a(t){const s=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=n.exec(t);)s[a[1]]=a[2];return s}const La=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function it(t,s,n,a,r){if(N.isFunction(a))return a.call(this,s,n);if(r&&(s=n),!!N.isString(s)){if(N.isString(a))return s.indexOf(a)!==-1;if(N.isRegExp(a))return a.test(s)}}function Ia(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,n,a)=>n.toUpperCase()+a)}function Ba(t,s){const n=N.toCamelCase(" "+s);["get","set","has"].forEach(a=>{Object.defineProperty(t,a+n,{value:function(r,l,i){return this[a].call(this,s,r,l,i)},configurable:!0})})}let me=class{constructor(s){s&&this.set(s)}set(s,n,a){const r=this;function l(x,p,u){const c=Le(p);if(!c)throw new Error("header name must be a non-empty string");const _=N.findKey(r,c);(!_||r[_]===void 0||u===!0||u===void 0&&r[_]!==!1)&&(r[_||p]=Ge(x))}const i=(x,p)=>N.forEach(x,(u,c)=>l(u,c,p));if(N.isPlainObject(s)||s instanceof this.constructor)i(s,n);else if(N.isString(s)&&(s=s.trim())&&!La(s))i(Ta(s),n);else if(N.isObject(s)&&N.isIterable(s)){let x={},p,u;for(const c of s){if(!N.isArray(c))throw TypeError("Object iterator must return a key-value pair");x[u=c[0]]=(p=x[u])?N.isArray(p)?[...p,c[1]]:[p,c[1]]:c[1]}i(x,n)}else s!=null&&l(n,s,a);return this}get(s,n){if(s=Le(s),s){const a=N.findKey(this,s);if(a){const r=this[a];if(!n)return r;if(n===!0)return $a(r);if(N.isFunction(n))return n.call(this,r,a);if(N.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,n){if(s=Le(s),s){const a=N.findKey(this,s);return!!(a&&this[a]!==void 0&&(!n||it(this,this[a],a,n)))}return!1}delete(s,n){const a=this;let r=!1;function l(i){if(i=Le(i),i){const x=N.findKey(a,i);x&&(!n||it(a,a[x],x,n))&&(delete a[x],r=!0)}}return N.isArray(s)?s.forEach(l):l(s),r}clear(s){const n=Object.keys(this);let a=n.length,r=!1;for(;a--;){const l=n[a];(!s||it(this,this[l],l,s,!0))&&(delete this[l],r=!0)}return r}normalize(s){const n=this,a={};return N.forEach(this,(r,l)=>{const i=N.findKey(a,l);if(i){n[i]=Ge(r),delete n[l];return}const x=s?Ia(l):String(l).trim();x!==l&&delete n[l],n[x]=Ge(r),a[x]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const n=Object.create(null);return N.forEach(this,(a,r)=>{a!=null&&a!==!1&&(n[r]=s&&N.isArray(a)?a.join(", "):a)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,n])=>s+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...n){const a=new this(s);return n.forEach(r=>a.set(r)),a}static accessor(s){const a=(this[Ft]=this[Ft]={accessors:{}}).accessors,r=this.prototype;function l(i){const x=Le(i);a[x]||(Ba(r,i),a[x]=!0)}return N.isArray(s)?s.forEach(l):l(s),this}};me.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);N.reduceDescriptors(me.prototype,({value:t},s)=>{let n=s[0].toUpperCase()+s.slice(1);return{get:()=>t,set(a){this[n]=a}}});N.freezeMethods(me);function ct(t,s){const n=this||Me,a=s||n,r=me.from(a.headers);let l=a.data;return N.forEach(t,function(x){l=x.call(n,l,r.normalize(),s?s.status:void 0)}),r.normalize(),l}function ns(t){return!!(t&&t.__CANCEL__)}function Pe(t,s,n){V.call(this,t??"canceled",V.ERR_CANCELED,s,n),this.name="CanceledError"}N.inherits(Pe,V,{__CANCEL__:!0});function rs(t,s,n){const a=n.config.validateStatus;!n.status||!a||a(n.status)?t(n):s(new V("Request failed with status code "+n.status,[V.ERR_BAD_REQUEST,V.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Aa(t){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return s&&s[1]||""}function Ma(t,s){t=t||10;const n=new Array(t),a=new Array(t);let r=0,l=0,i;return s=s!==void 0?s:1e3,function(p){const u=Date.now(),c=a[l];i||(i=u),n[r]=p,a[r]=u;let _=l,o=0;for(;_!==r;)o+=n[_++],_=_%t;if(r=(r+1)%t,r===l&&(l=(l+1)%t),u-i<s)return;const R=c&&u-c;return R?Math.round(o*1e3/R):void 0}}function Wa(t,s){let n=0,a=1e3/s,r,l;const i=(u,c=Date.now())=>{n=c,r=null,l&&(clearTimeout(l),l=null),t(...u)};return[(...u)=>{const c=Date.now(),_=c-n;_>=a?i(u,c):(r=u,l||(l=setTimeout(()=>{l=null,i(r)},a-_)))},()=>r&&i(r)]}const Xe=(t,s,n=3)=>{let a=0;const r=Ma(50,250);return Wa(l=>{const i=l.loaded,x=l.lengthComputable?l.total:void 0,p=i-a,u=r(p),c=i<=x;a=i;const _={loaded:i,total:x,progress:x?i/x:void 0,bytes:p,rate:u||void 0,estimated:u&&x&&c?(x-i)/u:void 0,event:l,lengthComputable:x!=null,[s?"download":"upload"]:!0};t(_)},n)},Rt=(t,s)=>{const n=t!=null;return[a=>s[0]({lengthComputable:n,total:t,loaded:a}),s[1]]},Dt=t=>(...s)=>N.asap(()=>t(...s)),Ua=ce.hasStandardBrowserEnv?((t,s)=>n=>(n=new URL(n,ce.origin),t.protocol===n.protocol&&t.host===n.host&&(s||t.port===n.port)))(new URL(ce.origin),ce.navigator&&/(msie|trident)/i.test(ce.navigator.userAgent)):()=>!0,Ha=ce.hasStandardBrowserEnv?{write(t,s,n,a,r,l,i){if(typeof document>"u")return;const x=[`${t}=${encodeURIComponent(s)}`];N.isNumber(n)&&x.push(`expires=${new Date(n).toUTCString()}`),N.isString(a)&&x.push(`path=${a}`),N.isString(r)&&x.push(`domain=${r}`),l===!0&&x.push("secure"),N.isString(i)&&x.push(`SameSite=${i}`),document.cookie=x.join("; ")},read(t){if(typeof document>"u")return null;const s=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return s?decodeURIComponent(s[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function qa(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function za(t,s){return s?t.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):t}function ls(t,s,n){let a=!qa(s);return t&&(a||n==!1)?za(t,s):s}const Pt=t=>t instanceof me?{...t}:t;function Ee(t,s){s=s||{};const n={};function a(u,c,_,o){return N.isPlainObject(u)&&N.isPlainObject(c)?N.merge.call({caseless:o},u,c):N.isPlainObject(c)?N.merge({},c):N.isArray(c)?c.slice():c}function r(u,c,_,o){if(N.isUndefined(c)){if(!N.isUndefined(u))return a(void 0,u,_,o)}else return a(u,c,_,o)}function l(u,c){if(!N.isUndefined(c))return a(void 0,c)}function i(u,c){if(N.isUndefined(c)){if(!N.isUndefined(u))return a(void 0,u)}else return a(void 0,c)}function x(u,c,_){if(_ in s)return a(u,c);if(_ in t)return a(void 0,u)}const p={url:l,method:l,data:l,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:x,headers:(u,c,_)=>r(Pt(u),Pt(c),_,!0)};return N.forEach(Object.keys({...t,...s}),function(c){const _=p[c]||r,o=_(t[c],s[c],c);N.isUndefined(o)&&_!==x||(n[c]=o)}),n}const is=t=>{const s=Ee({},t);let{data:n,withXSRFToken:a,xsrfHeaderName:r,xsrfCookieName:l,headers:i,auth:x}=s;if(s.headers=i=me.from(i),s.url=ts(ls(s.baseURL,s.url,s.allowAbsoluteUrls),t.params,t.paramsSerializer),x&&i.set("Authorization","Basic "+btoa((x.username||"")+":"+(x.password?unescape(encodeURIComponent(x.password)):""))),N.isFormData(n)){if(ce.hasStandardBrowserEnv||ce.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(N.isFunction(n.getHeaders)){const p=n.getHeaders(),u=["content-type","content-length"];Object.entries(p).forEach(([c,_])=>{u.includes(c.toLowerCase())&&i.set(c,_)})}}if(ce.hasStandardBrowserEnv&&(a&&N.isFunction(a)&&(a=a(s)),a||a!==!1&&Ua(s.url))){const p=r&&l&&Ha.read(l);p&&i.set(r,p)}return s},Ja=typeof XMLHttpRequest<"u",Va=Ja&&function(t){return new Promise(function(n,a){const r=is(t);let l=r.data;const i=me.from(r.headers).normalize();let{responseType:x,onUploadProgress:p,onDownloadProgress:u}=r,c,_,o,R,m;function w(){R&&R(),m&&m(),r.cancelToken&&r.cancelToken.unsubscribe(c),r.signal&&r.signal.removeEventListener("abort",c)}let y=new XMLHttpRequest;y.open(r.method.toUpperCase(),r.url,!0),y.timeout=r.timeout;function k(){if(!y)return;const g=me.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),F={data:!x||x==="text"||x==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:g,config:t,request:y};rs(function(v){n(v),w()},function(v){a(v),w()},F),y=null}"onloadend"in y?y.onloadend=k:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(k)},y.onabort=function(){y&&(a(new V("Request aborted",V.ECONNABORTED,t,y)),y=null)},y.onerror=function(S){const F=S&&S.message?S.message:"Network Error",O=new V(F,V.ERR_NETWORK,t,y);O.event=S||null,a(O),y=null},y.ontimeout=function(){let S=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const F=r.transitional||ss;r.timeoutErrorMessage&&(S=r.timeoutErrorMessage),a(new V(S,F.clarifyTimeoutError?V.ETIMEDOUT:V.ECONNABORTED,t,y)),y=null},l===void 0&&i.setContentType(null),"setRequestHeader"in y&&N.forEach(i.toJSON(),function(S,F){y.setRequestHeader(F,S)}),N.isUndefined(r.withCredentials)||(y.withCredentials=!!r.withCredentials),x&&x!=="json"&&(y.responseType=r.responseType),u&&([o,m]=Xe(u,!0),y.addEventListener("progress",o)),p&&y.upload&&([_,R]=Xe(p),y.upload.addEventListener("progress",_),y.upload.addEventListener("loadend",R)),(r.cancelToken||r.signal)&&(c=g=>{y&&(a(!g||g.type?new Pe(null,t,y):g),y.abort(),y=null)},r.cancelToken&&r.cancelToken.subscribe(c),r.signal&&(r.signal.aborted?c():r.signal.addEventListener("abort",c)));const h=Aa(r.url);if(h&&ce.protocols.indexOf(h)===-1){a(new V("Unsupported protocol "+h+":",V.ERR_BAD_REQUEST,t));return}y.send(l||null)})},Ya=(t,s)=>{const{length:n}=t=t?t.filter(Boolean):[];if(s||n){let a=new AbortController,r;const l=function(u){if(!r){r=!0,x();const c=u instanceof Error?u:this.reason;a.abort(c instanceof V?c:new Pe(c instanceof Error?c.message:c))}};let i=s&&setTimeout(()=>{i=null,l(new V(`timeout ${s} of ms exceeded`,V.ETIMEDOUT))},s);const x=()=>{t&&(i&&clearTimeout(i),i=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(l):u.removeEventListener("abort",l)}),t=null)};t.forEach(u=>u.addEventListener("abort",l));const{signal:p}=a;return p.unsubscribe=()=>N.asap(x),p}},Ga=function*(t,s){let n=t.byteLength;if(n<s){yield t;return}let a=0,r;for(;a<n;)r=a+s,yield t.slice(a,r),a=r},Ka=async function*(t,s){for await(const n of Xa(t))yield*Ga(n,s)},Xa=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const s=t.getReader();try{for(;;){const{done:n,value:a}=await s.read();if(n)break;yield a}}finally{await s.cancel()}},Ot=(t,s,n,a)=>{const r=Ka(t,s);let l=0,i,x=p=>{i||(i=!0,a&&a(p))};return new ReadableStream({async pull(p){try{const{done:u,value:c}=await r.next();if(u){x(),p.close();return}let _=c.byteLength;if(n){let o=l+=_;n(o)}p.enqueue(new Uint8Array(c))}catch(u){throw x(u),u}},cancel(p){return x(p),r.return()}},{highWaterMark:2})},Tt=64*1024,{isFunction:Je}=N,Qa=(({Request:t,Response:s})=>({Request:t,Response:s}))(N.global),{ReadableStream:$t,TextEncoder:Lt}=N.global,It=(t,...s)=>{try{return!!t(...s)}catch{return!1}},Za=t=>{t=N.merge.call({skipUndefined:!0},Qa,t);const{fetch:s,Request:n,Response:a}=t,r=s?Je(s):typeof fetch=="function",l=Je(n),i=Je(a);if(!r)return!1;const x=r&&Je($t),p=r&&(typeof Lt=="function"?(m=>w=>m.encode(w))(new Lt):async m=>new Uint8Array(await new n(m).arrayBuffer())),u=l&&x&&It(()=>{let m=!1;const w=new n(ce.origin,{body:new $t,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!w}),c=i&&x&&It(()=>N.isReadableStream(new a("").body)),_={stream:c&&(m=>m.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!_[m]&&(_[m]=(w,y)=>{let k=w&&w[m];if(k)return k.call(w);throw new V(`Response type '${m}' is not supported`,V.ERR_NOT_SUPPORT,y)})});const o=async m=>{if(m==null)return 0;if(N.isBlob(m))return m.size;if(N.isSpecCompliantForm(m))return(await new n(ce.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(N.isArrayBufferView(m)||N.isArrayBuffer(m))return m.byteLength;if(N.isURLSearchParams(m)&&(m=m+""),N.isString(m))return(await p(m)).byteLength},R=async(m,w)=>{const y=N.toFiniteNumber(m.getContentLength());return y??o(w)};return async m=>{let{url:w,method:y,data:k,signal:h,cancelToken:g,timeout:S,onDownloadProgress:F,onUploadProgress:O,responseType:v,headers:b,withCredentials:C="same-origin",fetchOptions:I}=is(m),M=s||fetch;v=v?(v+"").toLowerCase():"text";let Y=Ya([h,g&&g.toAbortSignal()],S),B=null;const W=Y&&Y.unsubscribe&&(()=>{Y.unsubscribe()});let T;try{if(O&&u&&y!=="get"&&y!=="head"&&(T=await R(b,k))!==0){let ae=new n(w,{method:"POST",body:k,duplex:"half"}),oe;if(N.isFormData(k)&&(oe=ae.headers.get("content-type"))&&b.setContentType(oe),ae.body){const[ye,ne]=Rt(T,Xe(Dt(O)));k=Ot(ae.body,Tt,ye,ne)}}N.isString(C)||(C=C?"include":"omit");const E=l&&"credentials"in n.prototype,H={...I,signal:Y,method:y.toUpperCase(),headers:b.normalize().toJSON(),body:k,duplex:"half",credentials:E?C:void 0};B=l&&new n(w,H);let G=await(l?M(B,I):M(w,H));const Z=c&&(v==="stream"||v==="response");if(c&&(F||Z&&W)){const ae={};["status","statusText","headers"].forEach(ue=>{ae[ue]=G[ue]});const oe=N.toFiniteNumber(G.headers.get("content-length")),[ye,ne]=F&&Rt(oe,Xe(Dt(F),!0))||[];G=new a(Ot(G.body,Tt,ye,()=>{ne&&ne(),W&&W()}),ae)}v=v||"text";let ie=await _[N.findKey(_,v)||"text"](G,m);return!Z&&W&&W(),await new Promise((ae,oe)=>{rs(ae,oe,{data:ie,headers:me.from(G.headers),status:G.status,statusText:G.statusText,config:m,request:B})})}catch(E){throw W&&W(),E&&E.name==="TypeError"&&/Load failed|fetch/i.test(E.message)?Object.assign(new V("Network Error",V.ERR_NETWORK,m,B),{cause:E.cause||E}):V.from(E,E&&E.code,m,B)}}},en=new Map,cs=t=>{let s=t&&t.env||{};const{fetch:n,Request:a,Response:r}=s,l=[a,r,n];let i=l.length,x=i,p,u,c=en;for(;x--;)p=l[x],u=c.get(p),u===void 0&&c.set(p,u=x?new Map:Za(s)),c=u;return u};cs();const yt={http:fa,xhr:Va,fetch:{get:cs}};N.forEach(yt,(t,s)=>{if(t){try{Object.defineProperty(t,"name",{value:s})}catch{}Object.defineProperty(t,"adapterName",{value:s})}});const Bt=t=>`- ${t}`,tn=t=>N.isFunction(t)||t===null||t===!1;function sn(t,s){t=N.isArray(t)?t:[t];const{length:n}=t;let a,r;const l={};for(let i=0;i<n;i++){a=t[i];let x;if(r=a,!tn(a)&&(r=yt[(x=String(a)).toLowerCase()],r===void 0))throw new V(`Unknown adapter '${x}'`);if(r&&(N.isFunction(r)||(r=r.get(s))))break;l[x||"#"+i]=r}if(!r){const i=Object.entries(l).map(([p,u])=>`adapter ${p} `+(u===!1?"is not supported by the environment":"is not available in the build"));let x=n?i.length>1?`since :
`+i.map(Bt).join(`
`):" "+Bt(i[0]):"as no adapter specified";throw new V("There is no suitable adapter to dispatch the request "+x,"ERR_NOT_SUPPORT")}return r}const ds={getAdapter:sn,adapters:yt};function dt(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Pe(null,t)}function At(t){return dt(t),t.headers=me.from(t.headers),t.data=ct.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),ds.getAdapter(t.adapter||Me.adapter,t)(t).then(function(a){return dt(t),a.data=ct.call(t,t.transformResponse,a),a.headers=me.from(a.headers),a},function(a){return ns(a)||(dt(t),a&&a.response&&(a.response.data=ct.call(t,t.transformResponse,a.response),a.response.headers=me.from(a.response.headers))),Promise.reject(a)})}const os="1.13.2",nt={};["object","boolean","number","function","string","symbol"].forEach((t,s)=>{nt[t]=function(a){return typeof a===t||"a"+(s<1?"n ":" ")+t}});const Mt={};nt.transitional=function(s,n,a){function r(l,i){return"[Axios v"+os+"] Transitional option '"+l+"'"+i+(a?". "+a:"")}return(l,i,x)=>{if(s===!1)throw new V(r(i," has been removed"+(n?" in "+n:"")),V.ERR_DEPRECATED);return n&&!Mt[i]&&(Mt[i]=!0,console.warn(r(i," has been deprecated since v"+n+" and will be removed in the near future"))),s?s(l,i,x):!0}};nt.spelling=function(s){return(n,a)=>(console.warn(`${a} is likely a misspelling of ${s}`),!0)};function an(t,s,n){if(typeof t!="object")throw new V("options must be an object",V.ERR_BAD_OPTION_VALUE);const a=Object.keys(t);let r=a.length;for(;r-- >0;){const l=a[r],i=s[l];if(i){const x=t[l],p=x===void 0||i(x,l,t);if(p!==!0)throw new V("option "+l+" must be "+p,V.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new V("Unknown option "+l,V.ERR_BAD_OPTION)}}const Ke={assertOptions:an,validators:nt},be=Ke.validators;let ke=class{constructor(s){this.defaults=s||{},this.interceptors={request:new Et,response:new Et}}async request(s,n){try{return await this._request(s,n)}catch(a){if(a instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const l=r.stack?r.stack.replace(/^.+\n/,""):"";try{a.stack?l&&!String(a.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+l):a.stack=l}catch{}}throw a}}_request(s,n){typeof s=="string"?(n=n||{},n.url=s):n=s||{},n=Ee(this.defaults,n);const{transitional:a,paramsSerializer:r,headers:l}=n;a!==void 0&&Ke.assertOptions(a,{silentJSONParsing:be.transitional(be.boolean),forcedJSONParsing:be.transitional(be.boolean),clarifyTimeoutError:be.transitional(be.boolean)},!1),r!=null&&(N.isFunction(r)?n.paramsSerializer={serialize:r}:Ke.assertOptions(r,{encode:be.function,serialize:be.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Ke.assertOptions(n,{baseUrl:be.spelling("baseURL"),withXsrfToken:be.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let i=l&&N.merge(l.common,l[n.method]);l&&N.forEach(["delete","get","head","post","put","patch","common"],m=>{delete l[m]}),n.headers=me.concat(i,l);const x=[];let p=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(n)===!1||(p=p&&w.synchronous,x.unshift(w.fulfilled,w.rejected))});const u=[];this.interceptors.response.forEach(function(w){u.push(w.fulfilled,w.rejected)});let c,_=0,o;if(!p){const m=[At.bind(this),void 0];for(m.unshift(...x),m.push(...u),o=m.length,c=Promise.resolve(n);_<o;)c=c.then(m[_++],m[_++]);return c}o=x.length;let R=n;for(;_<o;){const m=x[_++],w=x[_++];try{R=m(R)}catch(y){w.call(this,y);break}}try{c=At.call(this,R)}catch(m){return Promise.reject(m)}for(_=0,o=u.length;_<o;)c=c.then(u[_++],u[_++]);return c}getUri(s){s=Ee(this.defaults,s);const n=ls(s.baseURL,s.url,s.allowAbsoluteUrls);return ts(n,s.params,s.paramsSerializer)}};N.forEach(["delete","get","head","options"],function(s){ke.prototype[s]=function(n,a){return this.request(Ee(a||{},{method:s,url:n,data:(a||{}).data}))}});N.forEach(["post","put","patch"],function(s){function n(a){return function(l,i,x){return this.request(Ee(x||{},{method:s,headers:a?{"Content-Type":"multipart/form-data"}:{},url:l,data:i}))}}ke.prototype[s]=n(),ke.prototype[s+"Form"]=n(!0)});let nn=class us{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(l){n=l});const a=this;this.promise.then(r=>{if(!a._listeners)return;let l=a._listeners.length;for(;l-- >0;)a._listeners[l](r);a._listeners=null}),this.promise.then=r=>{let l;const i=new Promise(x=>{a.subscribe(x),l=x}).then(r);return i.cancel=function(){a.unsubscribe(l)},i},s(function(l,i,x){a.reason||(a.reason=new Pe(l,i,x),n(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const n=this._listeners.indexOf(s);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const s=new AbortController,n=a=>{s.abort(a)};return this.subscribe(n),s.signal.unsubscribe=()=>this.unsubscribe(n),s.signal}static source(){let s;return{token:new us(function(r){s=r}),cancel:s}}};function rn(t){return function(n){return t.apply(null,n)}}function ln(t){return N.isObject(t)&&t.isAxiosError===!0}const ht={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(ht).forEach(([t,s])=>{ht[s]=t});function xs(t){const s=new ke(t),n=Ht(ke.prototype.request,s);return N.extend(n,ke.prototype,s,{allOwnKeys:!0}),N.extend(n,s,null,{allOwnKeys:!0}),n.create=function(r){return xs(Ee(t,r))},n}const se=xs(Me);se.Axios=ke;se.CanceledError=Pe;se.CancelToken=nn;se.isCancel=ns;se.VERSION=os;se.toFormData=at;se.AxiosError=V;se.Cancel=se.CanceledError;se.all=function(s){return Promise.all(s)};se.spread=rn;se.isAxiosError=ln;se.mergeConfig=Ee;se.AxiosHeaders=me;se.formToJSON=t=>as(N.isHTMLForm(t)?new FormData(t):t);se.getAdapter=ds.getAdapter;se.HttpStatusCode=ht;se.default=se;const{Axios:Pn,AxiosError:On,CanceledError:Tn,isCancel:$n,CancelToken:Ln,VERSION:In,all:Bn,Cancel:An,isAxiosError:Mn,spread:Wn,toFormData:Un,AxiosHeaders:Hn,HttpStatusCode:qn,formToJSON:zn,getAdapter:Jn,mergeConfig:Vn}=se,L=se.create({baseURL:"/api",timeout:1e4,headers:{"Content-Type":"application/json"}});L.interceptors.request.use(t=>t,t=>Promise.reject(t));L.interceptors.response.use(t=>t.data,t=>{var n,a;const s=((a=(n=t.response)==null?void 0:n.data)==null?void 0:a.detail)||t.message||"An error occurred";return Promise.reject(new Error(s))});const cn=()=>{const[t,s]=d.useState({projects:{total:0,active:0},wbs:{total:0,completed:0,inProgress:0,notStarted:0,overdue:0},pending:{total:0,pending:0,inProgress:0,completed:0,overdue:0},issues:{total:0,open:0,inProgress:0,resolved:0,critical:0},dependencies:{total:0,active:0}}),[n,a]=d.useState([]),[r,l]=d.useState([]),[i,x]=d.useState([]),[p,u]=d.useState([]),[c,_]=d.useState(!0),[o,R]=d.useState(null);d.useEffect(()=>{m()},[]);const m=async()=>{var h;_(!0),R(null);try{const[g,S,F,O,v]=await Promise.all([L.get("/projects/"),L.get("/wbs/",{params:{limit:1e3}}),L.get("/pending/",{params:{limit:1e3}}),L.get("/issues/",{params:{limit:1e3}}),L.get("/dependencies/").catch(()=>({items:[],total:0}))]),b=((h=g.items)==null?void 0:h.filter(j=>j.status==="Active"||j.status==="ÈÄ≤Ë°å‰∏≠").length)||0,C=S.items||[],I=C.filter(j=>j.status==="Â∑≤ÂÆåÊàê").length,M=C.filter(j=>j.status==="ÈÄ≤Ë°å‰∏≠").length,Y=C.filter(j=>j.status==="Êú™ÈñãÂßã").length,B=C.filter(j=>j.is_overdue&&j.status!=="Â∑≤ÂÆåÊàê").length,W=F.items||[],T=W.filter(j=>j.status==="ÂæÖËôïÁêÜ").length,E=W.filter(j=>j.status==="ËôïÁêÜ‰∏≠").length,H=W.filter(j=>j.status==="Â∑≤ÂÆåÊàê").length,G=W.filter(j=>!j.expected_reply_date||j.status==="Â∑≤ÂÆåÊàê"?!1:new Date(j.expected_reply_date)<new Date).length,Z=O.items||[],ie=Z.filter(j=>j.status==="Open").length,ae=Z.filter(j=>j.status==="In Progress").length,oe=Z.filter(j=>j.status==="Resolved"||j.status==="Closed").length,ye=Z.filter(j=>(j.severity==="Critical"||j.priority==="Urgent")&&j.status!=="Resolved"&&j.status!=="Closed").length,ue=(v.items||[]).filter(j=>j.is_active).length;s({projects:{total:g.total||0,active:b},wbs:{total:S.total||0,completed:I,inProgress:M,notStarted:Y,overdue:B},pending:{total:F.total||0,pending:T,inProgress:E,completed:H,overdue:G},issues:{total:O.total||0,open:ie,inProgress:ae,resolved:oe,critical:ye},dependencies:{total:v.total||0,active:ue}});const P=[...C.filter(j=>j.is_overdue&&j.status!=="Â∑≤ÂÆåÊàê").map(j=>({type:"WBS",id:j.wbs_id,code:j.wbs_id,name:j.task_name,dueDate:j.revised_planned_end||j.original_planned_end,status:j.status,projectId:j.project_id})),...W.filter(j=>!j.expected_reply_date||j.status==="Â∑≤ÂÆåÊàê"?!1:new Date(j.expected_reply_date)<new Date).map(j=>({type:"Pending",id:j.pending_id,code:j.pending_id,name:j.description,dueDate:j.expected_reply_date,status:j.status,projectId:j.project_id})),...Z.filter(j=>!j.target_resolution_date||j.status==="Resolved"||j.status==="Closed"?!1:new Date(j.target_resolution_date)<new Date).map(j=>({type:"Issue",id:j.issue_id,code:j.issue_id,name:j.issue_title,dueDate:j.target_resolution_date,status:j.status,projectId:j.project_id}))];a(P.slice(0,5));const q=new Date,re=[...C.filter(j=>{if(j.status==="Â∑≤ÂÆåÊàê")return!1;const ee=j.revised_planned_start||j.original_planned_start;return!ee||new Date(ee)>q?!1:!j.actual_start_date||j.status==="Êú™ÈñãÂßã"}).map(j=>({type:"WBS",id:j.wbs_id,code:j.wbs_id,name:j.task_name,startDate:j.revised_planned_start||j.original_planned_start,status:j.status,projectId:j.project_id}))];l(re.slice(0,5));const D=new Date(q);D.setHours(0,0,0,0);const A=new Date(D);A.setDate(A.getDate()+1);const Q=[...C.filter(j=>{if(j.status==="Â∑≤ÂÆåÊàê")return!1;const ee=new Date(j.revised_planned_end||j.original_planned_end);return ee.setHours(0,0,0,0),ee.getTime()===D.getTime()}).map(j=>({type:"WBS",id:j.wbs_id,code:j.wbs_id,name:j.task_name,dueDate:j.revised_planned_end||j.original_planned_end,status:j.status,projectId:j.project_id})),...W.filter(j=>{if(!j.expected_reply_date||j.status==="Â∑≤ÂÆåÊàê")return!1;const ee=new Date(j.expected_reply_date);return ee.setHours(0,0,0,0),ee.getTime()===D.getTime()}).map(j=>({type:"Pending",id:j.pending_id,code:j.pending_id,name:j.description,dueDate:j.expected_reply_date,status:j.status,projectId:j.project_id})),...Z.filter(j=>{if(!j.target_resolution_date||j.status==="Resolved"||j.status==="Closed")return!1;const ee=new Date(j.target_resolution_date);return ee.setHours(0,0,0,0),ee.getTime()===D.getTime()}).map(j=>({type:"Issue",id:j.issue_id,code:j.issue_id,name:j.issue_title,dueDate:j.target_resolution_date,status:j.status,projectId:j.project_id}))];x(Q.slice(0,5));const X=new Date(q.getTime()+7*24*60*60*1e3),pe=[...C.filter(j=>{if(j.status==="Â∑≤ÂÆåÊàê")return!1;const ee=new Date(j.revised_planned_end||j.original_planned_end);return ee>q&&ee<=X}).map(j=>({type:"WBS",id:j.wbs_id,code:j.wbs_id,name:j.task_name,dueDate:j.revised_planned_end||j.original_planned_end,daysUntilDue:Math.ceil((new Date(j.revised_planned_end||j.original_planned_end)-q)/(1e3*60*60*24)),projectId:j.project_id})),...W.filter(j=>{if(!j.expected_reply_date||j.status==="Â∑≤ÂÆåÊàê")return!1;const ee=new Date(j.expected_reply_date);return ee>q&&ee<=X}).map(j=>({type:"Pending",id:j.pending_id,code:j.pending_id,name:j.description,dueDate:j.expected_reply_date,daysUntilDue:Math.ceil((new Date(j.expected_reply_date)-q)/(1e3*60*60*24)),projectId:j.project_id}))];u(pe.slice(0,5))}catch(g){R(g.message)}finally{_(!1)}},w=({title:h,value:g,subtitle:S,color:F,icon:O,link:v,alert:b})=>e.jsx(te,{to:v,className:`bg-white overflow-hidden shadow rounded-lg hover:shadow-lg transition-shadow duration-200 ${b?"ring-2 ring-red-500":""}`,children:e.jsx("div",{className:"p-5",children:e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("dt",{className:"text-sm font-medium text-gray-500 truncate flex items-center gap-2",children:[O&&e.jsx("span",{children:O}),h,b&&e.jsx("span",{className:"text-red-500",children:"‚ö†Ô∏è"})]}),e.jsxs("dd",{className:"mt-1",children:[e.jsx("div",{className:`text-3xl font-semibold ${F}`,children:g}),S&&e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:S})]})]})})})}),k=(()=>{const h=t.wbs.overdue+t.pending.overdue,g=t.wbs.total+t.pending.total,S=g>0?h/g*100:0;return S===0?{color:"green",label:"ÂÅ•Â∫∑",icon:"üü¢"}:S<10?{color:"yellow",label:"Ê≥®ÊÑè",icon:"üü°"}:{color:"red",label:"Ë≠¶Âëä",icon:"üî¥"}})();return c?e.jsx("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"ËºâÂÖ•‰∏≠..."})]})}):o?e.jsx("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:o})}):e.jsx("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"px-4 py-6 sm:px-0",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Â∞àÊ°àËøΩËπ§ÁÆ°ÁêÜÁ≥ªÁµ±"}),e.jsx("p",{className:"text-gray-600",children:"Êï¥ÂêàÂºèÂ∞àÊ°àÁÆ°ÁêÜÂÑÄË°®Êùø"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-5xl ${k.icon}`,children:k.icon}),e.jsx("div",{className:`text-sm font-semibold mt-1 text-${k.color}-600`,children:k.label})]})]})}),i.length>0&&e.jsxs("div",{className:"mb-6 bg-blue-50 border-l-4 border-blue-600 p-4 rounded shadow-md",children:[e.jsx("div",{className:"flex items-center mb-3",children:e.jsxs("span",{className:"text-blue-700 font-bold text-xl",children:["üéØ ‰ªäÊó•Âà∞ÊúüÈ†ÖÁõÆ (",i.length,")"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:i.map((h,g)=>{const S=h.type==="WBS"?`/wbs?project=${h.projectId}&highlight=${h.projectId}_${h.id}`:h.type==="Pending"?`/pending?project=${h.projectId}&highlight=${h.id}`:`/issues?project=${h.projectId}&highlight=${h.id}`;return e.jsx(te,{to:S,className:"bg-white p-3 rounded border border-blue-200 hover:border-blue-400 hover:shadow-md transition-all cursor-pointer",children:e.jsxs("div",{className:"text-sm text-blue-900 flex justify-between items-center",children:[e.jsxs("span",{className:"flex-1",children:[e.jsx("span",{className:"inline-block px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-xs font-semibold mr-2",children:h.type}),e.jsxs("span",{className:"text-blue-600 font-mono text-xs mr-2",children:["[",h.code,"]"]}),e.jsx("span",{className:"font-medium hover:text-blue-700",children:h.name})]}),e.jsx("span",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded ml-2",children:h.status})]})},g)})})]}),(n.length>0||r.length>0||t.issues.critical>0)&&e.jsxs("div",{className:"mb-6 grid grid-cols-1 lg:grid-cols-2 gap-4",children:[n.length>0&&e.jsxs("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:[e.jsx("div",{className:"flex items-center mb-2",children:e.jsxs("span",{className:"text-red-600 font-semibold text-lg",children:["‚ö†Ô∏è ÈÄæÊúüÈ†ÖÁõÆ (",n.length,")"]})}),e.jsx("div",{className:"space-y-2",children:n.map((h,g)=>{const S=h.type==="WBS"?`/wbs?project=${h.projectId}&highlight=${h.projectId}_${h.id}`:h.type==="Pending"?`/pending?project=${h.projectId}&highlight=${h.id}`:`/issues?project=${h.projectId}&highlight=${h.id}`;return e.jsxs(te,{to:S,className:"flex justify-between items-center text-sm text-red-800 hover:text-red-900 hover:bg-red-100 p-2 rounded transition-colors",children:[e.jsxs("span",{children:[e.jsxs("span",{className:"font-semibold",children:["[",h.type,"]"]}),e.jsxs("span",{className:"text-red-600 font-mono text-xs mx-2",children:["[",h.code,"]"]}),h.name]}),e.jsx("span",{className:"text-red-600 text-xs",children:h.dueDate})]},g)})})]}),r.length>0&&e.jsxs("div",{className:"bg-purple-50 border-l-4 border-purple-500 p-4 rounded",children:[e.jsx("div",{className:"flex items-center mb-2",children:e.jsxs("span",{className:"text-purple-600 font-semibold text-lg",children:["üöÄ ÊáâË©≤ÈñãÂßãËÄåÊú™ÈñãÂßã (",r.length,")"]})}),e.jsx("div",{className:"space-y-2",children:r.map((h,g)=>{const S=h.type==="WBS"?`/wbs?project=${h.projectId}&highlight=${h.projectId}_${h.id}`:h.type==="Pending"?`/pending?project=${h.projectId}&highlight=${h.id}`:`/issues?project=${h.projectId}&highlight=${h.id}`;return e.jsxs(te,{to:S,className:"flex justify-between items-center text-sm text-purple-800 hover:text-purple-900 hover:bg-purple-100 p-2 rounded transition-colors",children:[e.jsxs("span",{children:[e.jsxs("span",{className:"font-semibold",children:["[",h.type,"]"]}),e.jsxs("span",{className:"text-purple-600 font-mono text-xs mx-2",children:["[",h.code,"]"]}),h.name]}),e.jsx("span",{className:"text-purple-600 text-xs",children:h.startDate})]},g)})})]}),t.issues.critical>0&&e.jsxs("div",{className:"bg-orange-50 border-l-4 border-orange-500 p-4 rounded",children:[e.jsx("div",{className:"flex items-center mb-2",children:e.jsxs("span",{className:"text-orange-600 font-semibold text-lg",children:["üî• Á∑äÊÄ•ÂïèÈ°å (",t.issues.critical,")"]})}),e.jsxs("p",{className:"text-sm text-orange-800",children:["Êúâ ",t.issues.critical," ÂÄãÈ´òÂÑ™ÂÖàÁ¥öÊàñÈóúÈçµÂïèÈ°åÈúÄË¶ÅÁ´ãÂç≥ËôïÁêÜ"]}),e.jsx(te,{to:"/issues",className:"text-sm text-orange-600 hover:text-orange-800 font-semibold mt-2 inline-block",children:"Êü•ÁúãË©≥ÊÉÖ ‚Üí"})]})]}),p.length>0&&e.jsxs("div",{className:"mb-6 bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded",children:[e.jsx("div",{className:"flex items-center mb-2",children:e.jsxs("span",{className:"text-yellow-700 font-semibold text-lg",children:["üìÖ Êú¨ÈÄ±Âç≥Â∞áÂà∞Êúü (",p.length,")"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:p.map((h,g)=>{const S=h.type==="WBS"?`/wbs?project=${h.projectId}&highlight=${h.projectId}_${h.id}`:h.type==="Pending"?`/pending?project=${h.projectId}&highlight=${h.id}`:`/issues?project=${h.projectId}&highlight=${h.id}`;return e.jsxs(te,{to:S,className:"flex justify-between items-center text-sm text-yellow-800 hover:text-yellow-900 hover:bg-yellow-100 p-2 rounded transition-colors",children:[e.jsxs("span",{children:[e.jsxs("span",{className:"font-semibold",children:["[",h.type,"]"]}),e.jsxs("span",{className:"text-yellow-700 font-mono text-xs mx-2",children:["[",h.code,"]"]}),h.name]}),e.jsxs("span",{className:"text-yellow-600 text-xs",children:[h.daysUntilDue," Â§©Âæå"]})]},g)})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4 mb-8",children:[e.jsx(w,{title:"Â∞àÊ°àÁ∏ΩÊï∏",value:t.projects.total,subtitle:`${t.projects.active} ÂÄãÈÄ≤Ë°å‰∏≠`,color:"text-blue-600",icon:"üìÅ",link:"/projects"}),e.jsx(w,{title:"WBS È†ÖÁõÆ",value:t.wbs.total,subtitle:`${t.wbs.completed} Â∑≤ÂÆåÊàê / ${t.wbs.inProgress} ÈÄ≤Ë°å‰∏≠`,color:"text-green-600",icon:"üìä",link:"/wbs",alert:t.wbs.overdue>0}),e.jsx(w,{title:"ÂæÖËæ¶‰∫ãÈ†Ö",value:t.pending.total,subtitle:`${t.pending.pending} ÂæÖËôïÁêÜ / ${t.pending.inProgress} ËôïÁêÜ‰∏≠`,color:"text-orange-600",icon:"‚úÖ",link:"/pending",alert:t.pending.overdue>0}),e.jsx(w,{title:"ÂïèÈ°åËøΩËπ§",value:t.issues.total,subtitle:`${t.issues.open} ÂæÖËß£Ê±∫ / ${t.issues.inProgress} ËôïÁêÜ‰∏≠`,color:"text-red-600",icon:"üêõ",link:"/issues",alert:t.issues.critical>0})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-5 lg:grid-cols-3 mb-8",children:[e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"WBS ÈÄ≤Â∫¶ÂàÜ‰Ωà"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Â∑≤ÂÆåÊàê"}),e.jsxs("span",{className:"font-semibold text-green-600",children:[t.wbs.completed," (",t.wbs.total>0?Math.round(t.wbs.completed/t.wbs.total*100):0,"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${t.wbs.total>0?t.wbs.completed/t.wbs.total*100:0}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"ÈÄ≤Ë°å‰∏≠"}),e.jsxs("span",{className:"font-semibold text-blue-600",children:[t.wbs.inProgress," (",t.wbs.total>0?Math.round(t.wbs.inProgress/t.wbs.total*100):0,"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${t.wbs.total>0?t.wbs.inProgress/t.wbs.total*100:0}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Êú™ÈñãÂßã"}),e.jsxs("span",{className:"font-semibold text-gray-600",children:[t.wbs.notStarted," (",t.wbs.total>0?Math.round(t.wbs.notStarted/t.wbs.total*100):0,"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gray-400 h-2 rounded-full",style:{width:`${t.wbs.total>0?t.wbs.notStarted/t.wbs.total*100:0}%`}})})]}),t.wbs.overdue>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"ÈÄæÊúü"}),e.jsxs("span",{className:"font-semibold text-red-600",children:[t.wbs.overdue," (",t.wbs.total>0?Math.round(t.wbs.overdue/t.wbs.total*100):0,"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-red-600 h-2 rounded-full",style:{width:`${t.wbs.total>0?t.wbs.overdue/t.wbs.total*100:0}%`}})})]})]})]})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"ÂïèÈ°åÁãÄÊÖãÂàÜ‰Ωà"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"ÂæÖËß£Ê±∫"}),e.jsxs("span",{className:"font-semibold text-red-600",children:[t.issues.open," (",t.issues.total>0?Math.round(t.issues.open/t.issues.total*100):0,"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-red-600 h-2 rounded-full",style:{width:`${t.issues.total>0?t.issues.open/t.issues.total*100:0}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"ËôïÁêÜ‰∏≠"}),e.jsxs("span",{className:"font-semibold text-blue-600",children:[t.issues.inProgress," (",t.issues.total>0?Math.round(t.issues.inProgress/t.issues.total*100):0,"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${t.issues.total>0?t.issues.inProgress/t.issues.total*100:0}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Â∑≤Ëß£Ê±∫"}),e.jsxs("span",{className:"font-semibold text-green-600",children:[t.issues.resolved," (",t.issues.total>0?Math.round(t.issues.resolved/t.issues.total*100):0,"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${t.issues.total>0?t.issues.resolved/t.issues.total*100:0}%`}})})]})]})]})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"ÂÖ∂‰ªñÁµ±Ë®à"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"‰æùË≥¥Èóú‰øÇÁ∏ΩÊï∏"}),e.jsx("span",{className:"text-2xl font-semibold text-purple-600",children:t.dependencies.total})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"ÂïüÁî®‰∏≠ÁöÑ‰æùË≥¥"}),e.jsx("span",{className:"text-lg font-semibold text-purple-500",children:t.dependencies.active})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Êï¥È´îÂÆåÊàêÁéá"}),e.jsxs("span",{className:"text-lg font-semibold text-green-600",children:[t.wbs.total>0?Math.round(t.wbs.completed/t.wbs.total*100):0,"%"]})]})}),e.jsx(te,{to:"/dependencies",className:"block text-center text-sm text-purple-600 hover:text-purple-800 font-semibold",children:"Êü•Áúã‰æùË≥¥Èóú‰øÇ ‚Üí"})]})]})})]}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Âø´ÈÄüÊìç‰Ωú"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:[e.jsxs(te,{to:"/projects",className:"flex flex-col items-center justify-center px-4 py-3 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:[e.jsx("span",{className:"text-2xl mb-1",children:"üìÅ"}),"Â∞àÊ°àÁÆ°ÁêÜ"]}),e.jsxs(te,{to:"/wbs",className:"flex flex-col items-center justify-center px-4 py-3 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:[e.jsx("span",{className:"text-2xl mb-1",children:"üìä"}),"WBS ÁÆ°ÁêÜ"]}),e.jsxs(te,{to:"/wbs/tree",className:"flex flex-col items-center justify-center px-4 py-3 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:[e.jsx("span",{className:"text-2xl mb-1",children:"üå≥"}),"WBS Ê®πÁãÄÂúñ"]}),e.jsxs(te,{to:"/dependencies",className:"flex flex-col items-center justify-center px-4 py-3 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:[e.jsx("span",{className:"text-2xl mb-1",children:"üîó"}),"‰æùË≥¥Èóú‰øÇ"]}),e.jsxs(te,{to:"/pending",className:"flex flex-col items-center justify-center px-4 py-3 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:[e.jsx("span",{className:"text-2xl mb-1",children:"‚úÖ"}),"ÂæÖËæ¶Ê∏ÖÂñÆ"]}),e.jsxs(te,{to:"/issues",className:"flex flex-col items-center justify-center px-4 py-3 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:[e.jsx("span",{className:"text-2xl mb-1",children:"üêõ"}),"ÂïèÈ°åËøΩËπ§"]}),e.jsxs(te,{to:"/gantt",className:"flex flex-col items-center justify-center px-4 py-3 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 transition-colors",children:[e.jsx("span",{className:"text-2xl mb-1",children:"üìÖ"}),"ÁîòÁâπÂúñ"]})]})]})})]})})},_e=()=>{const[t,s]=d.useState([]),[n,a]=d.useState(!1),[r,l]=d.useState(null),[i,x]=d.useState(0),p=d.useCallback(async(m={})=>{a(!0),l(null);try{const w={...m},y=await L.get("/projects/",{params:w});s(y.items||[]),x(y.total||0)}catch(w){l(w.message),s([])}finally{a(!1)}},[]),u=d.useCallback(async m=>{a(!0),l(null);try{return await L.get(`/projects/${m}`)}catch(w){throw l(w.message),w}finally{a(!1)}},[]),c=d.useCallback(async m=>{a(!0),l(null);try{return await L.get(`/projects/${m}/stats`)}catch(w){throw l(w.message),w}finally{a(!1)}},[]),_=d.useCallback(async m=>{a(!0),l(null);try{const w=await L.post("/projects/",m);return await p(),w}catch(w){throw l(w.message),w}finally{a(!1)}},[p]),o=d.useCallback(async(m,w)=>{a(!0),l(null);try{const y=await L.put(`/projects/${m}`,w);return await p(),y}catch(y){throw l(y.message),y}finally{a(!1)}},[p]),R=d.useCallback(async m=>{a(!0),l(null);try{await L.delete(`/projects/${m}`),await p()}catch(w){throw l(w.message),w}finally{a(!1)}},[p]);return d.useEffect(()=>{p()},[p]),{projectsList:t,loading:n,error:r,total:i,fetchProjects:p,getProject:u,getProjectStats:c,createProject:_,updateProject:o,deleteProject:R}},Ne=()=>{const[t,s]=d.useState([]),[n,a]=d.useState([]),[r,l]=d.useState([]),[i,x]=d.useState(!1),[p,u]=d.useState(null),c=d.useCallback(async()=>{x(!0),u(null);try{const v=await L.get("/settings/system");return s(v),v}catch(v){throw u(v.message),v}finally{x(!1)}},[]),_=d.useCallback(async(v,b)=>{try{const C=await L.put(`/settings/system/${v}`,{setting_value:b});return s(I=>I.map(M=>M.setting_key===v?C:M)),C}catch(C){throw u(C.message),C}},[]),o=d.useCallback((v,b=null)=>{const C=t.find(I=>I.setting_key===v);return C?C.setting_type==="number"?parseFloat(C.setting_value):C.setting_type==="boolean"?C.setting_value.toLowerCase()==="true":C.setting_value:b},[t]),R=d.useCallback(async(v,b=null)=>{x(!0),u(null);try{const C=`/settings/project/${v}${b?`?setting_key=${b}`:""}`,I=await L.get(C);return a(I),I}catch(C){throw u(C.message),C}finally{x(!1)}},[]),m=d.useCallback(async v=>{try{const b=await L.post("/settings/project",v);return a(C=>[...C,b]),b}catch(b){throw u(b.message),b}},[]),w=d.useCallback(async(v,b)=>{try{const C=await L.put(`/settings/project/${v}`,b);return a(I=>I.map(M=>M.setting_id===v?C:M)),C}catch(C){throw u(C.message),C}},[]),y=d.useCallback(async v=>{try{await L.delete(`/settings/project/${v}`),a(b=>b.filter(C=>C.setting_id!==v))}catch(b){throw u(b.message),b}},[]),k=d.useCallback(async v=>{try{return await L.get(`/settings/owner-units/${v}`)}catch(b){throw u(b.message),b}},[]),h=d.useCallback(async(v,b,C=0)=>{try{return await L.post("/settings/owner-units",{project_id:v,unit_name:b,display_order:C})}catch(I){throw u(I.message),I}},[]),g=d.useCallback(async(v=null)=>{x(!0),u(null);try{const b=v?`/settings/holidays?year=${v}`:"/settings/holidays",C=await L.get(b);return l(C.items||[]),C}catch(b){throw u(b.message),b}finally{x(!1)}},[]),S=d.useCallback(async v=>{try{const b=await L.post("/settings/holidays",v);return l(C=>[...C,b].sort((I,M)=>new Date(I.holiday_date)-new Date(M.holiday_date))),b}catch(b){throw u(b.message),b}},[]),F=d.useCallback(async(v,b)=>{try{const C=await L.put(`/settings/holidays/${v}`,b);return l(I=>I.map(M=>M.holiday_id===v?C:M).sort((M,Y)=>new Date(M.holiday_date)-new Date(Y.holiday_date))),C}catch(C){throw u(C.message),C}},[]),O=d.useCallback(async v=>{try{await L.delete(`/settings/holidays/${v}`),l(b=>b.filter(C=>C.holiday_id!==v))}catch(b){throw u(b.message),b}},[]);return{systemSettings:t,projectSettings:n,holidays:r,loading:i,error:p,fetchSystemSettings:c,updateSystemSetting:_,getSystemSetting:o,fetchProjectSettings:R,createProjectSetting:m,updateProjectSetting:w,deleteProjectSetting:y,fetchOwnerUnits:k,addOwnerUnit:h,fetchHolidays:g,createHoliday:S,updateHoliday:F,deleteHoliday:O}},dn=({initialData:t=null,onSubmit:s,onCancel:n})=>{const[a,r]=d.useState({project_id:"",project_name:"",description:"",status:"Active"}),[l,i]=d.useState({});d.useEffect(()=>{t&&r({project_id:t.project_id||"",project_name:t.project_name||"",description:t.description||"",status:t.status||"Active"})},[t]);const x=c=>{const{name:_,value:o}=c.target;r(R=>({...R,[_]:o})),l[_]&&i(R=>({...R,[_]:null}))},p=()=>{const c={};return a.project_id?/^[A-Z0-9_-]+$/i.test(a.project_id)||(c.project_id="Â∞àÊ°à ID Âè™ËÉΩÂåÖÂê´Ëã±Êñá„ÄÅÊï∏Â≠ó„ÄÅÂ∫ïÁ∑öÂíåÈÄ£Â≠óËôü"):c.project_id="Ë´ãËº∏ÂÖ•Â∞àÊ°à ID",a.project_name||(c.project_name="Ë´ãËº∏ÂÖ•Â∞àÊ°àÂêçÁ®±"),i(c),Object.keys(c).length===0},u=c=>{if(c.preventDefault(),!p())return;const _={...a,description:a.description||null};s(_)};return e.jsxs("form",{onSubmit:u,className:"space-y-6 bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t?"Á∑®ËºØÂ∞àÊ°à":"Êñ∞Â¢ûÂ∞àÊ°à"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project_id",className:"label",children:"Â∞àÊ°à ID *"}),e.jsx("input",{type:"text",id:"project_id",name:"project_id",value:a.project_id,onChange:x,disabled:!!t,placeholder:"‰æãÂ¶Ç: PRJ001, PROJECT_2024",className:"input-field"}),l.project_id&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.project_id}),!t&&e.jsx("p",{className:"text-gray-500 text-xs mt-1",children:"Â∞àÊ°à ID ÂâµÂª∫ÂæåÁÑ°Ê≥ï‰øÆÊîπ"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"label",children:"ÁãÄÊÖã"}),e.jsxs("select",{id:"status",name:"status",value:a.status,onChange:x,className:"input-field",children:[e.jsx("option",{value:"Active",children:"ÈÄ≤Ë°å‰∏≠ (Active)"}),e.jsx("option",{value:"Completed",children:"Â∑≤ÂÆåÊàê (Completed)"}),e.jsx("option",{value:"On Hold",children:"Êö´ÂÅú (On Hold)"}),e.jsx("option",{value:"Cancelled",children:"Â∑≤ÂèñÊ∂à (Cancelled)"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"project_name",className:"label",children:"Â∞àÊ°àÂêçÁ®± *"}),e.jsx("input",{type:"text",id:"project_name",name:"project_name",value:a.project_name,onChange:x,placeholder:"Ë´ãËº∏ÂÖ•Â∞àÊ°àÂêçÁ®±",className:"input-field"}),l.project_name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.project_name})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"description",className:"label",children:"Â∞àÊ°àÊèèËø∞"}),e.jsx("textarea",{id:"description",name:"description",value:a.description,onChange:x,rows:"4",placeholder:"Ë´ãËº∏ÂÖ•Â∞àÊ°àÊèèËø∞...",className:"input-field"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:n,className:"btn-secondary",children:"ÂèñÊ∂à"}),e.jsx("button",{type:"submit",className:"btn-primary",children:t?"Êõ¥Êñ∞":"Êñ∞Â¢û"})]})]})},on=()=>{const[t,s]=d.useState(!1),[n,a]=d.useState(null),[r,l]=d.useState({status:""}),[i,x]=d.useState({}),{projectsList:p,loading:u,error:c,total:_,fetchProjects:o,getProjectStats:R,createProject:m,updateProject:w,deleteProject:y}=_e(),{fetchSystemSettings:k,updateSystemSetting:h,getSystemSetting:g}=Ne(),S=g("default_project_id","");d.useEffect(()=>{o(r),k()},[o,k,r]);const F=async B=>{try{await h("default_project_id",B),alert(`Â∑≤Â∞á„Äå${B}„ÄçË®≠ÁÇ∫È†êË®≠Â∞àÊ°à`)}catch(W){alert(`Ë®≠ÂÆöÂ§±Êïó: ${W.message}`)}};d.useEffect(()=>{const B=async()=>{const W={};for(const T of p)try{const E=await R(T.project_id);W[T.project_id]=E}catch(E){console.error(`Failed to load stats for ${T.project_id}`,E)}x(W)};p.length>0&&B()},[p,R]);const O=()=>{a(null),s(!0)},v=B=>{a(B),s(!0)},b=async B=>{if(window.confirm(`Á¢∫ÂÆöË¶ÅÂà™Èô§Â∞àÊ°à„Äå${B.project_name}„ÄçÂóéÔºü

‚ö†Ô∏è Ë≠¶ÂëäÔºöÈÄôÂ∞áÂà™Èô§ÊâÄÊúâÁõ∏ÈóúÁöÑ WBS È†ÖÁõÆ„ÄÅÂïèÈ°åÂíåÂæÖËæ¶‰∫ãÈ†ÖÔºåÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÂæ©ÂéüÔºÅ`))try{await y(B.project_id),alert("Âà™Èô§ÊàêÂäü")}catch(W){alert(`Âà™Èô§Â§±Êïó: ${W.message}`)}},C=async B=>{try{n?(await w(n.project_id,B),alert("Êõ¥Êñ∞ÊàêÂäü")):(await m(B),alert("Êñ∞Â¢ûÊàêÂäü")),s(!1),a(null)}catch(W){alert(`Êìç‰ΩúÂ§±Êïó: ${W.message}`)}},I=()=>{s(!1),a(null)},M=B=>{switch(B){case"Active":return"bg-green-100 text-green-800";case"Completed":return"bg-blue-100 text-blue-800";case"On Hold":return"bg-yellow-100 text-yellow-800";case"Cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Y=B=>{switch(B){case"Healthy":return"bg-green-100 text-green-800";case"Warning":return"bg-yellow-100 text-yellow-800";case"Critical":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return t?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(dn,{initialData:n,onSubmit:C,onCancel:I})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Â∞àÊ°àÁÆ°ÁêÜ"}),e.jsx("button",{onClick:O,className:"btn-primary",children:"+ Êñ∞Â¢ûÂ∞àÊ°à"})]}),e.jsx("div",{className:"flex gap-4 items-center",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status-filter",className:"label",children:"ÁãÄÊÖãÁØ©ÈÅ∏"}),e.jsxs("select",{id:"status-filter",value:r.status,onChange:B=>l({...r,status:B.target.value}),className:"input-field",children:[e.jsx("option",{value:"",children:"ÂÖ®ÈÉ®"}),e.jsx("option",{value:"Active",children:"ÈÄ≤Ë°å‰∏≠"}),e.jsx("option",{value:"Completed",children:"Â∑≤ÂÆåÊàê"}),e.jsx("option",{value:"On Hold",children:"Êö´ÂÅú"}),e.jsx("option",{value:"Cancelled",children:"Â∑≤ÂèñÊ∂à"})]})]})})]}),c&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:c}),u&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"ËºâÂÖ•‰∏≠..."})]}),!u&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.length===0?e.jsxs("div",{className:"col-span-full text-center py-12 text-gray-500",children:[e.jsx("p",{className:"text-lg",children:"Êö´ÁÑ°Â∞àÊ°à"}),e.jsx("button",{onClick:O,className:"mt-4 btn-primary",children:"Âª∫Á´ãÁ¨¨‰∏ÄÂÄãÂ∞àÊ°à"})]}):p.map(B=>{const W=i[B.project_id];return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:[B.project_name,S===B.project_id&&e.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-yellow-100 text-yellow-800 rounded-full",children:"È†êË®≠"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:B.project_id})]}),e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${M(B.status)}`,children:B.status})]}),B.description&&e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:B.description}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4 py-4 border-t border-b border-gray-200",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:B.total_wbs}),e.jsx("p",{className:"text-xs text-gray-500",children:"WBS È†ÖÁõÆ"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:B.total_issues}),e.jsx("p",{className:"text-xs text-gray-500",children:"ÂïèÈ°å"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:B.total_pending}),e.jsx("p",{className:"text-xs text-gray-500",children:"ÂæÖËæ¶"})]})]}),W&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Êï¥È´îÈÄ≤Â∫¶"}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[W.overall_progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:`${W.overall_progress}%`}})}),e.jsxs("div",{className:"flex justify-between mt-2",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${Y(W.health_status)}`,children:W.health_status}),W.overdue_wbs>0&&e.jsxs("span",{className:"text-xs text-red-600",children:["‚ö†Ô∏è ",W.overdue_wbs," È†ÖÈÄæÊúü"]})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(te,{to:`/wbs?project=${B.project_id}`,className:"flex-1 text-center btn-primary text-sm py-2",children:"Êü•Áúã WBS"}),e.jsx("button",{onClick:()=>v(B),className:"flex-1 btn-secondary text-sm py-2",children:"Á∑®ËºØ"}),S!==B.project_id?e.jsx("button",{onClick:()=>F(B.project_id),className:"px-3 py-2 text-yellow-700 bg-yellow-100 hover:bg-yellow-200 rounded-md text-sm font-medium transition-colors",title:"Ë®≠ÁÇ∫È†êË®≠Â∞àÊ°à",children:"Ë®≠È†êË®≠"}):e.jsx("span",{className:"px-3 py-2 text-gray-400 bg-gray-100 rounded-md text-sm",children:"Â∑≤È†êË®≠"}),e.jsx("button",{onClick:()=>b(B),className:"px-3 py-2 text-white bg-red-600 hover:bg-red-700 rounded-md text-sm font-medium transition-colors",title:"Âà™Èô§Â∞àÊ°à",children:"Âà™Èô§"})]})]},B.project_id)})}),e.jsxs("div",{className:"mt-6 text-sm text-gray-600",children:["ÂÖ± ",_," ÂÄãÂ∞àÊ°à"]})]})]})},Qe=(t,s)=>{const n=(t.wbs_id||"").split(".").map(l=>parseInt(l)||0),a=(s.wbs_id||"").split(".").map(l=>parseInt(l)||0),r=Math.max(n.length,a.length);for(let l=0;l<r;l++){const i=n[l]||0,x=a[l]||0;if(i!==x)return i-x}return 0},We=(t=null)=>{const[s,n]=d.useState([]),[a,r]=d.useState(!1),[l,i]=d.useState(null),[x,p]=d.useState(0),u=d.useCallback(async(y={})=>{r(!0),i(null);try{const k={...y,project_id:t||y.project_id},h=await L.get("/wbs/",{params:k}),g=[...h.items||[]].sort(Qe);n(g),p(h.total||0)}catch(k){i(k.message),n([])}finally{r(!1)}},[t]),c=d.useCallback(async y=>{const k=y||t;if(!k)return i("Project ID is required for tree view"),[];r(!0),i(null);try{return(await L.get(`/wbs/tree/${k}`)).tree||[]}catch(h){return i(h.message),[]}finally{r(!1)}},[t]),_=d.useCallback(async y=>{r(!0),i(null);try{return await L.get(`/wbs/${y}`)}catch(k){throw i(k.message),k}finally{r(!1)}},[]),o=d.useCallback(async y=>{r(!0),i(null);try{const k=await L.post("/wbs/",y);return await u(),k}catch(k){throw i(k.message),k}finally{r(!1)}},[u]),R=d.useCallback(async(y,k)=>{r(!0),i(null);try{const h=await L.put(`/wbs/${y}`,k);return await u(),h}catch(h){throw i(h.message),h}finally{r(!1)}},[u]),m=d.useCallback(async y=>{r(!0),i(null);try{await L.delete(`/wbs/${y}`),await u()}catch(k){throw i(k.message),k}finally{r(!1)}},[u]),w=d.useCallback(async y=>{r(!0),i(null);try{const k=await L.post("/wbs/batch",y);return await u(),k}catch(k){throw i(k.message),k}finally{r(!1)}},[u]);return d.useEffect(()=>{t&&u()},[t,u]),{wbsList:s,loading:a,error:l,total:x,fetchWBS:u,fetchWBSTree:c,getWBS:_,createWBS:o,updateWBS:R,deleteWBS:m,createWBSBatch:w,naturalSortWbsId:Qe}},jt=()=>{const[t,s]=d.useState(!1),[n,a]=d.useState(null),r=d.useCallback(async(u,c)=>{s(!0),a(null);try{const _=new FormData;return _.append("file",u),await L.post(`/csv/import/wbs?project_id=${c}`,_,{headers:{"Content-Type":"multipart/form-data"}})}catch(_){throw a(_.message),_}finally{s(!1)}},[]),l=d.useCallback(async u=>{s(!0),a(null);try{const c=await fetch(`/api/csv/export/wbs/${u}`,{method:"GET",headers:{Accept:"text/csv"}});if(!c.ok){const m=await c.json();throw new Error(m.detail||"Export failed")}const _=await c.blob(),o=window.URL.createObjectURL(_),R=document.createElement("a");return R.href=o,R.download=`WBS_${u}.csv`,document.body.appendChild(R),R.click(),document.body.removeChild(R),window.URL.revokeObjectURL(o),{success:!0}}catch(c){throw a(c.message),c}finally{s(!1)}},[]),i=d.useCallback(async()=>{s(!0),a(null);try{const u=await fetch("/api/csv/template/wbs",{method:"GET",headers:{Accept:"text/csv"}});if(!u.ok){const R=await u.json();throw new Error(R.detail||"Template download failed")}const c=await u.blob(),_=window.URL.createObjectURL(c),o=document.createElement("a");return o.href=_,o.download="WBS_Template.csv",document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(_),{success:!0}}catch(u){throw a(u.message),u}finally{s(!1)}},[]),x=d.useCallback(async u=>{s(!0),a(null);try{const c=await fetch(`/api/csv/export/pending/${u}`,{method:"GET",headers:{Accept:"text/csv"}});if(!c.ok){const m=await c.json();throw new Error(m.detail||"Export failed")}const _=await c.blob(),o=window.URL.createObjectURL(_),R=document.createElement("a");return R.href=o,R.download=`Pending_${u}.csv`,document.body.appendChild(R),R.click(),document.body.removeChild(R),window.URL.revokeObjectURL(o),{success:!0}}catch(c){throw a(c.message),c}finally{s(!1)}},[]),p=d.useCallback(async u=>{s(!0),a(null);try{const c=await fetch(`/api/csv/export/issues/${u}`,{method:"GET",headers:{Accept:"text/csv"}});if(!c.ok){const m=await c.json();throw new Error(m.detail||"Export failed")}const _=await c.blob(),o=window.URL.createObjectURL(_),R=document.createElement("a");return R.href=o,R.download=`Issues_${u}.csv`,document.body.appendChild(R),R.click(),document.body.removeChild(R),window.URL.revokeObjectURL(o),{success:!0}}catch(c){throw a(c.message),c}finally{s(!1)}},[]);return{loading:t,error:n,importWBSFromExcel:r,exportWBSToExcel:l,downloadWBSTemplate:i,exportPendingToExcel:x,exportIssuesToExcel:p}},bt=()=>{const[t,s]=d.useState([]),[n,a]=d.useState(!1),[r,l]=d.useState(null),[i,x]=d.useState(0),p=d.useCallback(async(h={})=>{a(!0),l(null);try{const g={...h},S=await L.get("/issues/",{params:g});s(S.items||[]),x(S.total||0)}catch(g){l(g.message),s([])}finally{a(!1)}},[]),u=d.useCallback(async h=>{a(!0),l(null);try{return await L.get(`/issues/${h}`)}catch(g){throw l(g.message),g}finally{a(!1)}},[]),c=d.useCallback(async h=>{a(!0),l(null);try{return await L.get(`/issues/${h}/history`)}catch(g){throw l(g.message),g}finally{a(!1)}},[]),_=d.useCallback(async h=>{a(!0),l(null);try{return await L.post("/issues/",h)}catch(g){throw l(g.message),g}finally{a(!1)}},[]),o=d.useCallback(async(h,g,S="User")=>{a(!0),l(null);try{return await L.put(`/issues/${h}?changed_by=${S}`,g)}catch(F){throw l(F.message),F}finally{a(!1)}},[]),R=d.useCallback(async h=>{a(!0),l(null);try{await L.delete(`/issues/${h}`)}catch(g){throw l(g.message),g}finally{a(!1)}},[]),m=d.useCallback(async(h,g)=>{a(!0),l(null);try{return await L.put(`/issues/${h}/escalate`,g)}catch(S){throw l(S.message),S}finally{a(!1)}},[]),w=d.useCallback(async(h,g)=>{a(!0),l(null);try{return await L.put(`/issues/${h}/resolve`,g)}catch(S){throw l(S.message),S}finally{a(!1)}},[]),y=d.useCallback(async(h,g="User")=>{a(!0),l(null);try{return await L.put(`/issues/${h}/close?changed_by=${g}`)}catch(S){throw l(S.message),S}finally{a(!1)}},[]),k=d.useCallback(async(h=null)=>{a(!0),l(null);try{const g=h?{project_id:h}:{};return await L.get("/issues/stats",{params:g})}catch(g){throw l(g.message),g}finally{a(!1)}},[]);return{issuesList:t,loading:n,error:r,total:i,fetchIssues:p,getIssue:u,getIssueHistory:c,createIssue:_,updateIssue:o,deleteIssue:R,escalateIssue:m,resolveIssue:w,closeIssue:y,getStats:k}},ge=(t,s="yyyy/MM/dd")=>{if(!t)return"-";const n=typeof t=="string"?new Date(t):t;if(isNaN(n.getTime()))return t;const a=n.getFullYear(),r=String(n.getMonth()+1).padStart(2,"0"),l=String(n.getDate()).padStart(2,"0");return s.replace("yyyy",a).replace("MM",r).replace("dd",l)},Ve=(t,s="yyyy/MM/dd")=>{if(!t)return"-";const n=typeof t=="string"?new Date(t):t;if(isNaN(n.getTime()))return t;const a=String(n.getMonth()+1).padStart(2,"0"),r=String(n.getDate()).padStart(2,"0"),l=s.includes("/")?"/":s.includes("-")?"-":"/";return s.toLowerCase().startsWith("dd")?`${r}${l}${a}`:`${a}${l}${r}`},un=({initialData:t=null,onSubmit:s,onCancel:n,projectId:a,availableWBSList:r=[]})=>{const[l,i]=d.useState([]),[x,p]=d.useState([]),{fetchOwnerUnits:u}=Ne(),[c,_]=d.useState({original:null,revised:null,actual:null}),[o,R]=d.useState({project_id:a||"",wbs_id:"",parent_id:"",task_name:"",category:"Task",owner_unit:"",original_planned_start:"",original_planned_end:"",revised_planned_start:"",revised_planned_end:"",actual_start_date:"",actual_end_date:"",work_days:"",actual_progress:0,status:"Êú™ÈñãÂßã",notes:"",is_internal:!1}),[m,w]=d.useState({}),y=d.useCallback(async(b,C,I)=>{if(!b||!C){_(M=>({...M,[I]:null}));return}try{const M=await L.get("/wbs/calculate-work-days",{params:{start_date:b,end_date:C}});_(Y=>({...Y,[I]:M.work_days}))}catch(M){console.error("Failed to calculate work days:",M),_(Y=>({...Y,[I]:null}))}},[]);d.useEffect(()=>{y(o.original_planned_start,o.original_planned_end,"original")},[o.original_planned_start,o.original_planned_end,y]),d.useEffect(()=>{y(o.revised_planned_start,o.revised_planned_end,"revised")},[o.revised_planned_start,o.revised_planned_end,y]),d.useEffect(()=>{y(o.actual_start_date,o.actual_end_date,"actual")},[o.actual_start_date,o.actual_end_date,y]);const k=c.original,h=c.revised,g=c.actual;d.useEffect(()=>{if(t){let b=t.parent_id||"";b&&b.includes("_")&&(b=b.split("_")[1]),R({...t,parent_id:b,original_planned_start:t.original_planned_start||"",original_planned_end:t.original_planned_end||"",revised_planned_start:t.revised_planned_start||"",revised_planned_end:t.revised_planned_end||"",actual_start_date:t.actual_start_date||"",actual_end_date:t.actual_end_date||""})}},[t]),d.useEffect(()=>{const C=[...t?r.filter(I=>I.item_id!==t.item_id):r].sort(Qe);i(C)},[r,t]),d.useEffect(()=>{a&&u(a).then(b=>{p(b)}).catch(b=>{console.error("Failed to fetch owner units:",b),p([])})},[a]),d.useEffect(()=>{if(!t&&o.parent_id&&l.length>0){const b=F(o.parent_id);b!==o.wbs_id&&R(C=>({...C,wbs_id:b}))}},[l,o.parent_id]);const S=b=>{const{name:C,value:I,type:M,checked:Y}=b.target,B=M==="checkbox"?Y:I;if(C==="parent_id"&&I&&!t){const W=F(I);R(T=>({...T,parent_id:I,wbs_id:W}))}else R(W=>({...W,[C]:B}));m[C]&&w(W=>({...W,[C]:null}))},F=b=>{if(!b)return"";const C=l.filter(M=>M.parent_id?(M.parent_id.includes("_")?M.parent_id.split("_")[1]:M.parent_id)===b:!1);if(C.length===0)return`${b}.1`;let I=0;return C.forEach(M=>{const Y=M.wbs_id.split(".");if(Y.length>0){const B=parseInt(Y[Y.length-1]);!isNaN(B)&&B>I&&(I=B)}}),`${b}.${I+1}`},O=()=>{const b={};return o.project_id||(b.project_id="Ë´ãËº∏ÂÖ•Â∞àÊ°à ID"),o.wbs_id||(b.wbs_id="Ë´ãËº∏ÂÖ• WBS Á∑®Ëôü"),o.task_name||(b.task_name="Ë´ãËº∏ÂÖ•‰ªªÂãôÂêçÁ®±"),w(b),Object.keys(b).length===0},v=b=>{if(b.preventDefault(),!O())return;const C={...o,work_days:o.work_days?parseInt(o.work_days):null,actual_progress:parseInt(o.actual_progress)||0};Object.keys(C).forEach(I=>{C[I]===""&&(C[I]=null)}),s(C),t||R({project_id:a||"",wbs_id:"",parent_id:o.parent_id,task_name:"",category:"Task",owner_unit:o.owner_unit,original_planned_start:"",original_planned_end:"",revised_planned_start:"",revised_planned_end:"",actual_start_date:"",actual_end_date:"",work_days:"",actual_progress:0,status:"Êú™ÈñãÂßã",notes:""})};return e.jsxs("form",{onSubmit:v,className:"space-y-6 bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t?"Á∑®ËºØ WBS È†ÖÁõÆ":"Êñ∞Â¢û WBS È†ÖÁõÆ"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project_id",className:"label",children:"Â∞àÊ°à ID *"}),e.jsx("input",{type:"text",id:"project_id",name:"project_id",value:o.project_id,onChange:S,disabled:!!t,className:"input-field"}),m.project_id&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.project_id})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"wbs_id",className:"label",children:"WBS Á∑®Ëôü *"}),e.jsx("input",{type:"text",id:"wbs_id",name:"wbs_id",value:o.wbs_id,onChange:S,disabled:!!t,placeholder:"‰æãÂ¶Ç: 1, 2.1, 2.1.3",className:"input-field"}),m.wbs_id&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.wbs_id})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"parent_id",className:"label",children:"Áà∂È†ÖÁõÆ (ÈÅ∏Â°´)"}),e.jsxs("select",{id:"parent_id",name:"parent_id",value:o.parent_id,onChange:S,className:"input-field",children:[e.jsx("option",{value:"",children:"-- ÁÑ° (È†ÇÂ±§È†ÖÁõÆ) --"}),l.map(b=>e.jsxs("option",{value:b.wbs_id,children:[b.wbs_id," - ",b.task_name]},b.item_id))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ÈÅ∏ÊìáÁà∂È†ÖÁõÆ‰ª•Âª∫Á´ãÈöéÂ±§Èóú‰øÇÔºåÁïôÁ©∫Ë°®Á§∫È†ÇÂ±§È†ÖÁõÆ"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"task_name",className:"label",children:"‰ªªÂãôÂêçÁ®± *"}),e.jsx("input",{type:"text",id:"task_name",name:"task_name",value:o.task_name,onChange:S,className:"input-field"}),m.task_name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.task_name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"label",children:"È°ûÂà•"}),e.jsxs("select",{id:"category",name:"category",value:o.category,onChange:S,className:"input-field",children:[e.jsx("option",{value:"Task",children:"Task"}),e.jsx("option",{value:"Milestone",children:"Milestone"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"owner_unit",className:"label",children:"Ë≤†Ë≤¨ÂñÆ‰Ωç"}),e.jsx("input",{type:"text",id:"owner_unit",name:"owner_unit",value:o.owner_unit,onChange:S,list:"owner-units-list",placeholder:"ÈÅ∏ÊìáÊàñËº∏ÂÖ•Ë≤†Ë≤¨ÂñÆ‰Ωç",className:"input-field"}),e.jsx("datalist",{id:"owner-units-list",children:x.map((b,C)=>e.jsx("option",{value:b},C))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Âæû‰∏ãÊãâÈÅ∏ÂñÆÈÅ∏ÊìáÊàñÁõ¥Êé•Ëº∏ÂÖ•Êñ∞ÁöÑÂñÆ‰ΩçÂêçÁ®±"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"ÈöéÊÆµ 1: ÂéüÂßãË®àÁï´"}),k!==null&&e.jsxs("span",{className:"text-sm font-medium text-blue-600 bg-blue-50 px-3 py-1 rounded-full",children:["Â∑•‰ΩúÂ§©Êï∏: ",k," Â§©"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"original_planned_start",className:"label",children:"È†êË®àÈñãÂßãÊó•Êúü"}),e.jsx("input",{type:"date",id:"original_planned_start",name:"original_planned_start",value:o.original_planned_start,onChange:S,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"original_planned_end",className:"label",children:"È†êË®àÁµêÊùüÊó•Êúü"}),e.jsx("input",{type:"date",id:"original_planned_end",name:"original_planned_end",value:o.original_planned_end,onChange:S,className:"input-field"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"ÈöéÊÆµ 2: Ë™øÊï¥Ë®àÁï´"}),h!==null&&e.jsxs("span",{className:"text-sm font-medium text-purple-600 bg-purple-50 px-3 py-1 rounded-full",children:["Â∑•‰ΩúÂ§©Êï∏: ",h," Â§©"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"revised_planned_start",className:"label",children:"Ë™øÊï¥ÂæåÈñãÂßãÊó•Êúü"}),e.jsx("input",{type:"date",id:"revised_planned_start",name:"revised_planned_start",value:o.revised_planned_start,onChange:S,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"revised_planned_end",className:"label",children:"Ë™øÊï¥ÂæåÁµêÊùüÊó•Êúü"}),e.jsx("input",{type:"date",id:"revised_planned_end",name:"revised_planned_end",value:o.revised_planned_end,onChange:S,className:"input-field"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"ÈöéÊÆµ 3: ÂØ¶ÈöõÂü∑Ë°å"}),g!==null&&e.jsxs("span",{className:"text-sm font-medium text-green-600 bg-green-50 px-3 py-1 rounded-full",children:["Â∑•‰ΩúÂ§©Êï∏: ",g," Â§©"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"actual_start_date",className:"label",children:"ÂØ¶ÈöõÈñãÂßãÊó•Êúü"}),e.jsx("input",{type:"date",id:"actual_start_date",name:"actual_start_date",value:o.actual_start_date,onChange:S,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"actual_end_date",className:"label",children:"ÂØ¶ÈöõÁµêÊùüÊó•Êúü"}),e.jsx("input",{type:"date",id:"actual_end_date",name:"actual_end_date",value:o.actual_end_date,onChange:S,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"work_days",className:"label",children:"Â∑•‰ΩúÂ§©Êï∏ (ÂèØÊâãÂãïËº∏ÂÖ•)"}),e.jsx("input",{type:"number",id:"work_days",name:"work_days",value:o.work_days,onChange:S,min:"0",placeholder:g?g.toString():"",className:"input-field"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"actual_progress",className:"label",children:"ÂØ¶ÈöõÂÆåÊàêÈÄ≤Â∫¶ (%)"}),e.jsx("input",{type:"number",id:"actual_progress",name:"actual_progress",value:o.actual_progress,onChange:S,min:"0",max:"100",className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"label",children:"ÁãÄÊÖã"}),e.jsxs("select",{id:"status",name:"status",value:o.status,onChange:S,className:"input-field",children:[e.jsx("option",{value:"Êú™ÈñãÂßã",children:"Êú™ÈñãÂßã"}),e.jsx("option",{value:"ÈÄ≤Ë°å‰∏≠",children:"ÈÄ≤Ë°å‰∏≠"}),e.jsx("option",{value:"Â∑≤ÂÆåÊàê",children:"Â∑≤ÂÆåÊàê"})]})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_internal",name:"is_internal",checked:o.is_internal,onChange:S,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"is_internal",className:"ml-2 block text-sm text-gray-700",children:"ÂÖßÈÉ®ÂÆâÊéí"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"label",children:"ÂÇôË®ª"}),e.jsx("textarea",{id:"notes",name:"notes",value:o.notes,onChange:S,rows:"3",className:"input-field"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:n,className:"btn-secondary",children:"ÂèñÊ∂à"}),e.jsx("button",{type:"submit",className:"btn-primary",children:t?"Êõ¥Êñ∞":"Êñ∞Â¢û"})]})]})},xn=()=>{const[t,s]=Re(),[n,a]=d.useState(!1),[r,l]=d.useState(null),[i,x]=d.useState(t.get("project")||""),[p,u]=d.useState(t.get("highlight")||""),[c,_]=d.useState({status:"",parent_wbs_id:""}),[o,R]=d.useState({overdueOnly:!1,behindScheduleOnly:!1,dueThisWeek:!1,notCompleted:!1,internalOnly:!1,ownerUnit:"",wbsCode:""}),[m,w]=d.useState(""),[y,k]=d.useState(!1),[h,g]=d.useState(new Set),[S,F]=d.useState(!1),[O,v]=d.useState(1),b=d.useRef(null),C=d.useRef(null),I=d.useRef(!1),{wbsList:M,loading:Y,error:B,total:W,fetchWBS:T,createWBS:E,updateWBS:H,deleteWBS:G}=We(),{loading:Z,error:ie,importWBSFromExcel:ae,exportWBSToExcel:oe,downloadWBSTemplate:ye}=jt(),{projectsList:ne,fetchProjects:ue}=_e(),{issuesList:P,fetchIssues:q}=bt(),{systemSettings:re,fetchSystemSettings:D,getSystemSetting:A}=Ne();d.useEffect(()=>{ue(),D()},[ue,D]),d.useEffect(()=>{if(!i&&ne.length>0&&re.length>0){const f=A("default_project_id",""),U=ne.some($=>$.project_id===f);x(U?f:ne[0].project_id)}},[i,ne,re,A]),d.useEffect(()=>{if(i){const f=A("items_per_page",1e3);q({project_id:i,limit:f})}},[q,i,re,A]);const Q=c.parent_wbs_id||o.overdueOnly||o.behindScheduleOnly||o.dueThisWeek||o.notCompleted||o.internalOnly||o.ownerUnit||o.wbsCode||c.status==="not_completed",X=p&&!I.current;d.useEffect(()=>{if(i){if(Q||X)T({project_id:i,limit:1e4,skip:0}),X&&(I.current=!0);else if(!I.current){const f=A("items_per_page",1e3),U=(O-1)*f,$={};c.status&&c.status!=="not_completed"&&($.status=c.status),T({project_id:i,...$,limit:f,skip:U})}}},[T,i,c,O,re,A,Q,X]),d.useEffect(()=>{v(1)},[i,c,o]),d.useEffect(()=>{if(i){const f=new URLSearchParams(t);f.set("project",i),s(f)}},[i]),d.useEffect(()=>{const f=t.get("highlight")||"";f&&f!==p&&(I.current=!1,u(f))},[t]),d.useEffect(()=>{if(m){const f=setTimeout(()=>w(""),5e3);return()=>clearTimeout(f)}},[m]),d.useEffect(()=>{if(p&&M.length>0&&!Y&&!n){const f=M.find(J=>J.item_id===p);if(f&&f.wbs_id){const J=f.wbs_id.split("."),z=new Set;for(let K=1;K<J.length;K++)z.add(J.slice(0,K).join("."));g(K=>{const le=new Set(K);return z.forEach(de=>le.add(de)),le})}const U=setTimeout(()=>{C.current&&C.current.scrollIntoView({behavior:"smooth",block:"center"})},500),$=setTimeout(()=>{u("");const J=new URLSearchParams(t);J.delete("highlight"),s(J,{replace:!0})},5e3);return()=>{clearTimeout(U),clearTimeout($)}}},[p,M,Y,n]),d.useEffect(()=>{if(M.length>0&&!S){const f=new Set,U=rt(M),$=J=>{J.forEach(z=>{z.children&&z.children.length>0&&(f.add(z.wbs_id),$(z.children))})};$(U),g(f),F(!0)}},[M,S]);const pe=()=>{l(null),a(!0)},j=f=>{l(f),a(!0)},ee=async f=>{if(window.confirm(`Á¢∫ÂÆöË¶ÅÂà™Èô§ WBS È†ÖÁõÆ„Äå${f.task_name}„ÄçÂóéÔºü`))try{await G(f.item_id),alert("Âà™Èô§ÊàêÂäü");const U=A("items_per_page",1e3);T({project_id:i,...c,limit:U})}catch(U){alert(`Âà™Èô§Â§±Êïó: ${U.message}`)}},Ue=async f=>{try{if(r){const $=r.item_id;await H($,f),w("Êõ¥Êñ∞ÊàêÂäü"),a(!1),l(null),k(!1),u($)}else{const $=await E(f);w("Êñ∞Â¢ûÊàêÂäü"),l(null),k(!0),$&&$.item_id&&u($.item_id)}const U=A("items_per_page",1e3);T({project_id:i,...c,limit:U})}catch(U){alert(`Êìç‰ΩúÂ§±Êïó: ${U.message}`)}},He=()=>{a(!1),l(null),k(!1)},Oe=()=>{var f;(f=b.current)==null||f.click()},Te=async f=>{var $;const U=($=f.target.files)==null?void 0:$[0];if(U){if(!i){alert("Ë´ãÂÖàÈÅ∏ÊìáÂ∞àÊ°à");return}try{const J=await ae(U,i);let z=`ÊàêÂäüÂåØÂÖ• ${J.imported} Á≠ÜÔºåÂ§±Êïó ${J.failed} Á≠Ü`;if(J.failed>0&&J.failed_items&&(z+=`

Â§±ÊïóÈ†ÖÁõÆË©≥ÊÉÖÔºö`,J.failed_items.forEach(K=>{z+=`
Á¨¨ ${K.row} Ë°å (${K.wbs_id}): ${K.error}`})),J.imported>0?w(z):alert(`ÂåØÂÖ•Â§±Êïó
`+z),J.imported>0){const K=A("items_per_page",1e3);await T({project_id:i,...c,limit:K})}b.current&&(b.current.value="")}catch(J){alert(`ÂåØÂÖ•Â§±Êïó: ${J.message}`)}}},ms=async()=>{if(!i){alert("Ë´ãÂÖàÈÅ∏ÊìáÂ∞àÊ°à");return}try{await oe(i),w("ÂåØÂá∫ÊàêÂäüÔºÅ")}catch(f){alert(`ÂåØÂá∫Â§±Êïó: ${f.message}`)}},hs=async()=>{try{await ye(),w("ÁØÑÊú¨‰∏ãËºâÊàêÂäüÔºÅ")}catch(f){alert(`‰∏ãËºâÁØÑÊú¨Â§±Êïó: ${f.message}`)}},ps=f=>{switch(f){case"Â∑≤ÂÆåÊàê":return"bg-green-100 text-green-800";case"ÈÄ≤Ë°å‰∏≠":return"bg-blue-100 text-blue-800";case"Êú™ÈñãÂßã":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},gs=f=>f>0?"text-green-600":f<0?"text-red-600":"text-gray-600",fs=f=>{g(U=>{const $=new Set(U);return $.has(f)?$.delete(f):$.add(f),$})},ys=()=>{const f=new Set,U=J=>{J.forEach(z=>{z.children&&z.children.length>0&&(f.add(z.wbs_id),U(z.children))})},$=rt(M);U($),g(f)},js=()=>{g(new Set)},rt=f=>{const U=new Map;f.forEach(z=>{U.set(z.wbs_id,{...z,children:[]})});const $=[];f.forEach(z=>{const K=U.get(z.wbs_id);if(!z.parent_id)$.push(K);else{const le=z.parent_id.includes("_")?z.parent_id.split("_")[1]:z.parent_id,de=U.get(le);de?de.children.push(K):$.push(K)}});const J=z=>{z.children&&z.children.length>0&&(z.children.sort((K,le)=>{const de=K.wbs_id.split(".").map(Number),we=le.wbs_id.split(".").map(Number);for(let Se=0;Se<Math.max(de.length,we.length);Se++){const $e=de[Se]||0,vt=we[Se]||0;if($e!==vt)return $e-vt}return 0}),z.children.forEach(K=>J(K)))};return $.sort((z,K)=>{const le=z.wbs_id.split(".").map(Number),de=K.wbs_id.split(".").map(Number);for(let we=0;we<Math.max(le.length,de.length);we++){const Se=le[we]||0,$e=de[we]||0;if(Se!==$e)return Se-$e}return 0}),$.forEach(z=>J(z)),$.length>0&&console.log("WBS Tree Structure:",$.map(z=>{var K,le;return{wbs_id:z.wbs_id,task_name:z.task_name,children_count:((K=z.children)==null?void 0:K.length)||0,children:(le=z.children)==null?void 0:le.map(de=>de.wbs_id)}})),$},_t=(f,U=0)=>{const $=[];return f.forEach(J=>{$.push({...J,level:U}),J.children&&J.children.length>0&&h.has(J.wbs_id)&&$.push(..._t(J.children,U+1))}),$},lt=(()=>{let f=[...M];if(c.parent_wbs_id&&(f=f.filter($=>$.wbs_id===c.parent_wbs_id?!0:$.parent_id?($.parent_id.includes("_")?$.parent_id.split("_")[1]:$.parent_id)===c.parent_wbs_id:!1)),o.ownerUnit&&o.ownerUnit.trim()&&(f=f.filter($=>{var J;return(J=$.owner_unit)==null?void 0:J.toLowerCase().includes(o.ownerUnit.toLowerCase())})),o.wbsCode&&o.wbsCode.trim()&&(f=f.filter($=>{var J;return(J=$.wbs_id)==null?void 0:J.toLowerCase().includes(o.wbsCode.toLowerCase())})),o.overdueOnly&&(f=f.filter($=>$.is_overdue===!0)),o.behindScheduleOnly&&(f=f.filter($=>$.is_behind_schedule===!0)),o.dueThisWeek){const $=new Date,J=new Date($);J.setDate($.getDate()+7),f=f.filter(z=>{const K=z.revised_planned_end||z.original_planned_end;if(!K)return!1;const le=new Date(K);return le>=$&&le<=J})}o.notCompleted&&(f=f.filter($=>$.status!=="Â∑≤ÂÆåÊàê")),c.status==="not_completed"&&(f=f.filter($=>$.status!=="Â∑≤ÂÆåÊàê")),o.internalOnly&&(f=f.filter($=>$.is_internal===!0));const U=rt(f);return _t(U)})(),ve=A("items_per_page",100),qe=A("date_format","yyyy/MM/dd"),ze=Q?lt.length:W,he=Math.ceil(ze/ve),Nt=Q?lt.slice((O-1)*ve,O*ve):lt,bs=f=>!P||P.length===0?0:P.filter(U=>U.affected_wbs?U.affected_wbs.split(",").map(J=>J.trim()).includes(f):!1).length;return n?e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx(un,{initialData:r,onSubmit:Ue,onCancel:He,projectId:i,availableWBSList:M}),y&&!r&&e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx("button",{onClick:He,className:"btn-secondary",children:"‚Üê ÂõûÂà∞ÂàóË°®"})})]}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"WBS È†ÖÁõÆÁÆ°ÁêÜ"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:hs,className:"btn-secondary",disabled:Z,children:"üì• ‰∏ãËºâÁØÑÊú¨"}),e.jsx("button",{onClick:Oe,className:"btn-secondary",disabled:Z||!i,children:"üì§ ÂåØÂÖ• Excel"}),e.jsx("button",{onClick:ms,className:"btn-secondary",disabled:Z||!i,children:"üìä ÂåØÂá∫ Excel"}),e.jsx("button",{onClick:pe,className:"btn-primary",children:"+ Êñ∞Â¢û WBS"})]})]}),e.jsx("input",{type:"file",ref:b,onChange:Te,accept:".xlsx,.xls",className:"hidden"}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project-select",className:"label",children:"Â∞àÊ°à"}),e.jsx("select",{id:"project-select",value:i,onChange:f=>x(f.target.value),className:"input-field",children:ne.length===0?e.jsx("option",{value:"",children:"Ë´ãÂÖàÂª∫Á´ãÂ∞àÊ°à"}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Ë´ãÈÅ∏ÊìáÂ∞àÊ°à"}),ne.map(f=>e.jsxs("option",{value:f.project_id,children:[f.project_id," - ",f.project_name]},f.project_id))]})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"parent-wbs-filter",className:"label",children:"Áà∂ WBS ID"}),e.jsxs("select",{id:"parent-wbs-filter",value:c.parent_wbs_id,onChange:f=>_({...c,parent_wbs_id:f.target.value}),className:"input-field",children:[e.jsx("option",{value:"",children:"ÂÖ®ÈÉ®"}),M.filter(U=>!U.parent_id).sort((U,$)=>{const J=U.wbs_id.split(".").map(Number),z=$.wbs_id.split(".").map(Number);for(let K=0;K<Math.max(J.length,z.length);K++){const le=J[K]||0,de=z[K]||0;if(le!==de)return le-de}return 0}).map(U=>e.jsxs("option",{value:U.wbs_id,children:[U.wbs_id," - ",U.task_name]},U.item_id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status-filter",className:"label",children:"ÁãÄÊÖã"}),e.jsxs("select",{id:"status-filter",value:c.status,onChange:f=>_({...c,status:f.target.value}),className:"input-field",children:[e.jsx("option",{value:"",children:"ÂÖ®ÈÉ®"}),e.jsx("option",{value:"not_completed",children:"Êú™ÂÆåÊàê"}),e.jsx("option",{value:"Êú™ÈñãÂßã",children:"Êú™ÈñãÂßã"}),e.jsx("option",{value:"ÈÄ≤Ë°å‰∏≠",children:"ÈÄ≤Ë°å‰∏≠"}),e.jsx("option",{value:"Â∑≤ÂÆåÊàê",children:"Â∑≤ÂÆåÊàê"})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>{v(1)},className:"btn-secondary",children:"ÊêúÂ∞ã"})})]}),e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Êô∫ÊÖßÁØ©ÈÅ∏"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm text-gray-700 font-medium",children:"Ë≤†Ë≤¨ÂñÆ‰Ωç"}),e.jsx("input",{type:"text",value:o.ownerUnit,onChange:f=>R({...o,ownerUnit:f.target.value}),placeholder:"Ëº∏ÂÖ•Ë≤†Ë≤¨ÂñÆ‰Ωç",className:"input-field text-sm"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm text-gray-700 font-medium",children:"WBS Code"}),e.jsx("input",{type:"text",value:o.wbsCode,onChange:f=>R({...o,wbsCode:f.target.value}),placeholder:"Ëº∏ÂÖ• WBS Á∑®Ëôü",className:"input-field text-sm"})]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:o.overdueOnly,onChange:f=>R({...o,overdueOnly:f.target.checked}),className:"mr-2 rounded"}),e.jsxs("span",{className:"text-gray-700 flex items-center",children:["Âè™ÁúãÈÄæÊúüÈ†ÖÁõÆ",e.jsx("span",{className:"ml-1 text-red-500",children:"‚ö†Ô∏è"})]})]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:o.behindScheduleOnly,onChange:f=>R({...o,behindScheduleOnly:f.target.checked}),className:"mr-2 rounded"}),e.jsxs("span",{className:"text-gray-700 flex items-center",children:["Âè™ÁúãÈÄ≤Â∫¶ËêΩÂæå",e.jsx("span",{className:"ml-1 text-yellow-500",children:"üìâ"})]})]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:o.dueThisWeek,onChange:f=>R({...o,dueThisWeek:f.target.checked}),className:"mr-2 rounded"}),e.jsx("span",{className:"text-gray-700",children:"Âè™ÁúãÊú¨ÈÄ±Âà∞Êúü"})]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:o.notCompleted,onChange:f=>R({...o,notCompleted:f.target.checked}),className:"mr-2 rounded"}),e.jsx("span",{className:"text-gray-700",children:"Êú™ÂÆåÊàê"})]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:o.internalOnly,onChange:f=>R({...o,internalOnly:f.target.checked}),className:"mr-2 rounded"}),e.jsx("span",{className:"text-gray-700",children:"ÂÖßÈÉ®ÂÆâÊéí"})]}),(o.ownerUnit||o.wbsCode||o.overdueOnly||o.behindScheduleOnly||o.dueThisWeek||o.notCompleted||o.internalOnly)&&e.jsx("button",{onClick:()=>R({overdueOnly:!1,behindScheduleOnly:!1,dueThisWeek:!1,notCompleted:!1,internalOnly:!1,ownerUnit:"",wbsCode:""}),className:"text-sm text-primary-600 hover:text-primary-800 underline self-end",children:"Ê∏ÖÈô§ÊâÄÊúâÁØ©ÈÅ∏"})]})]})]}),m&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded mb-4",children:m}),(B||ie)&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:B||ie}),Y&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"ËºâÂÖ•‰∏≠..."})]}),!Y&&e.jsxs(e.Fragment,{children:[he>1&&e.jsxs("div",{className:"mb-3 flex items-center justify-between bg-gray-50 p-2 rounded",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["ÂÖ± ",ze," Á≠ÜÔºåÁ¨¨ ",O," / ",he," È†Å"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>v(f=>Math.max(1,f-1)),disabled:O===1,className:"px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"‚Üê ‰∏ä‰∏ÄÈ†Å"}),e.jsx("select",{value:O,onChange:f=>v(Number(f.target.value)),className:"px-2 py-1 text-sm border border-gray-300 rounded",children:Array.from({length:he},(f,U)=>U+1).map(f=>e.jsxs("option",{value:f,children:["Á¨¨ ",f," È†Å"]},f))}),e.jsx("button",{onClick:()=>v(f=>Math.min(he,f+1)),disabled:O===he,className:"px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"‰∏ã‰∏ÄÈ†Å ‚Üí"})]})]}),e.jsxs("div",{className:"mb-3 flex justify-end gap-2",children:[e.jsx("button",{onClick:ys,className:"text-sm px-3 py-1 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded",children:"‚ûï ÂÖ®ÈÉ®Â±ïÈñã"}),e.jsx("button",{onClick:js,className:"text-sm px-3 py-1 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded",children:"‚ûñ ÂÖ®ÈÉ®Êî∂Ëµ∑"})]}),e.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-x-auto",children:e.jsxs("table",{className:"w-full divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase",style:{width:"120px"},children:"WBS ID"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase",style:{minWidth:"150px"},children:"‰ªªÂãôÂêçÁ®±"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase",style:{width:"100px"},children:"Ë≤†Ë≤¨ÂñÆ‰Ωç"}),e.jsx("th",{className:"px-1 py-2 text-left text-xs font-medium text-gray-500 uppercase",style:{width:"85px"},children:"È†êË®àÈñãÂßã"}),e.jsx("th",{className:"px-1 py-2 text-left text-xs font-medium text-gray-500 uppercase",style:{width:"85px"},children:"È†êË®àÁµêÊùü"}),e.jsx("th",{className:"px-1 py-2 text-left text-xs font-medium text-gray-500 uppercase",style:{width:"85px"},children:"Ë™øÊï¥ÈñãÂßã"}),e.jsx("th",{className:"px-1 py-2 text-left text-xs font-medium text-gray-500 uppercase",style:{width:"85px"},children:"Ë™øÊï¥ÁµêÊùü"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase",style:{width:"100px"},children:"ÈÄ≤Â∫¶"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase",style:{width:"70px"},children:"ÁãÄÊÖã"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase",style:{width:"100px"},children:"Êìç‰Ωú"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Nt.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"px-6 py-4 text-center text-gray-500",children:M.length===0?"Êö´ÁÑ°Ë≥áÊñô":"ÁÑ°Á¨¶ÂêàÁØ©ÈÅ∏Ê¢ù‰ª∂ÁöÑË≥áÊñô"})}):Nt.map(f=>{const U=f.item_id===p;return e.jsxs("tr",{ref:U?C:null,className:`${f.is_overdue?"bg-red-50":""} ${U?"bg-yellow-200 animate-pulse ring-2 ring-yellow-400":""}`,children:[e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-xs font-medium text-gray-900",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{style:{width:`${f.level*20}px`},className:"inline-block"}),f.children&&f.children.length>0?e.jsx("button",{onClick:()=>fs(f.wbs_id),className:"w-5 h-5 flex items-center justify-center text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded",title:h.has(f.wbs_id)?"Êî∂Ëµ∑":"Â±ïÈñã",children:h.has(f.wbs_id)?"‚ñº":"‚ñ∂"}):e.jsx("span",{className:"w-5 h-5 inline-block"}),e.jsx("span",{className:f.level>0?"text-blue-600":"text-gray-900 font-bold",children:f.wbs_id})]})}),e.jsx("td",{className:"px-2 py-2 text-xs text-gray-900",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:f.level>0?"font-normal":"font-semibold",children:f.task_name}),f.is_overdue&&e.jsx("span",{className:"text-red-500",title:"ÈÄæÊúü",children:"‚ö†Ô∏è"}),f.is_behind_schedule&&!f.is_overdue&&e.jsx("span",{className:"text-yellow-500",title:"ÈÄ≤Â∫¶ËêΩÂæå",children:"üìâ"}),(()=>{const $=bs(f.wbs_id);return $>0?e.jsxs("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-800 text-xs rounded-full font-semibold",title:`${$} ÂÄãÁõ∏ÈóúÂïèÈ°å`,children:[$," ÂïèÈ°å"]}):null})()]})}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-xs text-gray-500",children:f.owner_unit||"-"}),e.jsx("td",{className:"px-1 py-2 whitespace-nowrap text-xs text-gray-500",children:Ve(f.original_planned_start,qe)}),e.jsx("td",{className:"px-1 py-2 whitespace-nowrap text-xs text-gray-500",children:Ve(f.original_planned_end,qe)}),e.jsx("td",{className:"px-1 py-2 whitespace-nowrap text-xs text-gray-500",children:f.revised_planned_start?e.jsx("span",{className:"text-blue-600",children:Ve(f.revised_planned_start,qe)}):"-"}),e.jsx("td",{className:"px-1 py-2 whitespace-nowrap text-xs text-gray-500",children:f.revised_planned_end?e.jsx("span",{className:"text-blue-600",children:Ve(f.revised_planned_end,qe)}):"-"}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-xs",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${f.actual_progress}%`}})}),e.jsxs("span",{className:"text-gray-900 font-semibold",children:[f.actual_progress,"%"]}),f.progress_variance!==void 0&&f.progress_variance!==0&&e.jsxs("span",{className:`ml-2 text-xs ${gs(f.progress_variance)}`,children:["(",f.progress_variance>0?"+":"",f.progress_variance,")"]})]}),f.estimated_progress!==void 0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["È†ê‰º∞: ",f.estimated_progress,"%"]})]})}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap",children:e.jsx("span",{className:`px-1.5 py-0.5 inline-flex text-xs leading-tight font-semibold rounded ${ps(f.status)}`,children:f.status})}),e.jsxs("td",{className:"px-2 py-2 whitespace-nowrap text-xs font-medium",children:[e.jsx("button",{onClick:()=>j(f),className:"text-primary-600 hover:text-primary-900 mr-2",children:"Á∑®ËºØ"}),e.jsx("button",{onClick:()=>ee(f),className:"text-red-600 hover:text-red-900",children:"Âà™Èô§"})]})]},f.item_id)})})]})}),e.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-gray-600",children:Q?e.jsxs(e.Fragment,{children:["ÁØ©ÈÅ∏ÁµêÊûú ",ze," Á≠Ü",he>1&&` | È°ØÁ§∫Á¨¨ ${(O-1)*ve+1}-${Math.min(O*ve,ze)} Á≠Ü`]}):e.jsxs(e.Fragment,{children:["ÂÖ± ",W," Á≠ÜË≥áÊñô",he>1&&` | È°ØÁ§∫Á¨¨ ${(O-1)*ve+1}-${Math.min(O*ve,W)} Á≠Ü`]})}),he>1&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>v(f=>Math.max(1,f-1)),disabled:O===1,className:"px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"‚Üê ‰∏ä‰∏ÄÈ†Å"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Á¨¨ ",O," / ",he," È†Å"]}),e.jsx("button",{onClick:()=>v(f=>Math.min(he,f+1)),disabled:O===he,className:"px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"‰∏ã‰∏ÄÈ†Å ‚Üí"}),e.jsx("select",{value:O,onChange:f=>v(Number(f.target.value)),className:"ml-2 px-2 py-1 text-sm border border-gray-300 rounded",children:Array.from({length:he},(f,U)=>U+1).map(f=>e.jsxs("option",{value:f,children:["Á¨¨ ",f," È†Å"]},f))})]})]})]})]})},mn=()=>{const[t,s]=Re(),n=t.get("project_id")||"",[a,r]=d.useState([]),[l,i]=d.useState(!1),[x,p]=d.useState(null),[u,c]=d.useState(new Set),{projectsList:_,fetchProjects:o}=_e();d.useEffect(()=>{o()},[]),d.useEffect(()=>{n?R():r([])},[n]);const R=async()=>{try{i(!0),p(null);const F=await L.get(`/wbs/tree/${n}`);r(F.tree||[]);const O=new Set,v=b=>{b.forEach(C=>{O.add(C.item_id),C.children&&C.children.length>0&&v(C.children)})};v(F.tree||[]),c(O)}catch(F){p(F.message||"ËºâÂÖ•Ê®πÁãÄÁµêÊßãÂ§±Êïó"),r([])}finally{i(!1)}},m=F=>{const O=F.target.value;s(O?{project_id:O}:{})},w=F=>{c(O=>{const v=new Set(O);return v.has(F)?v.delete(F):v.add(F),v})},y=()=>{const F=new Set,O=v=>{v.forEach(b=>{F.add(b.item_id),b.children&&b.children.length>0&&O(b.children)})};O(a),c(new Set(F))},k=()=>{c(()=>new Set)},h=F=>{switch(F){case"Â∑≤ÂÆåÊàê":return"text-green-600 bg-green-50";case"ÈÄ≤Ë°å‰∏≠":return"text-blue-600 bg-blue-50";case"Êú™ÈñãÂßã":return"text-gray-600 bg-gray-50";default:return"text-gray-600 bg-gray-50"}},g=(F,O)=>O<-10?"text-red-600":O<0?"text-orange-600":O>10?"text-green-600":"text-gray-700",S=({node:F,level:O=0})=>{const v=F.children&&F.children.length>0,b=u.has(F.item_id);return e.jsxs("div",{className:"tree-node",children:[e.jsxs("div",{className:"flex items-center py-2 px-3 hover:bg-gray-50 border-b border-gray-100",style:{paddingLeft:`${O*2+.75}rem`},children:[e.jsx("div",{className:"w-6 flex-shrink-0",children:v&&e.jsx("button",{onClick:()=>w(F.item_id),className:"text-gray-600 hover:text-gray-900 focus:outline-none",children:b?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}),e.jsx("div",{className:"w-24 flex-shrink-0 font-mono text-sm font-semibold text-gray-700",children:F.wbs_id}),e.jsx("div",{className:"flex-1 min-w-0 px-2",children:e.jsx("span",{className:"text-sm text-gray-900",children:F.task_name})}),e.jsx("div",{className:"w-20 flex-shrink-0 text-center",children:e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-purple-50 text-purple-700",children:F.category})}),e.jsx("div",{className:"w-32 flex-shrink-0 text-sm text-gray-600 truncate",children:F.owner_unit}),e.jsx("div",{className:"w-24 flex-shrink-0 text-center",children:e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${h(F.status)}`,children:F.status})}),e.jsxs("div",{className:"w-32 flex-shrink-0 text-sm text-center",children:[e.jsxs("span",{className:g(F.actual_progress,F.progress_variance),children:[F.actual_progress,"%"]}),F.progress_variance!==0&&e.jsxs("span",{className:"text-xs ml-1",children:["(",F.progress_variance>0?"+":"",F.progress_variance,")"]})]}),e.jsx("div",{className:"w-64 flex-shrink-0 text-xs",children:F.revised_planned_start||F.revised_planned_end?e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-gray-400 line-through",children:["Âéü: ",F.original_planned_start," ~ ",F.original_planned_end]}),e.jsxs("div",{className:"text-blue-600 font-semibold",children:["Ë™ø: ",F.revised_planned_start||F.original_planned_start," ~ ",F.revised_planned_end||F.original_planned_end]})]}):e.jsxs("div",{className:"text-gray-600",children:[F.original_planned_start," ~ ",F.original_planned_end]})})]}),v&&b&&e.jsx("div",{className:"tree-children",children:F.children.map(C=>e.jsx(S,{node:C,level:O+1},C.item_id))})]})};return e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"WBS Ê®πÁãÄÈöéÂ±§Ë¶ñÂúñ"}),e.jsx("p",{className:"text-gray-600",children:"‰ª•ÈöéÂ±§ÁµêÊßãÊü•ÁúãÂ∞àÊ°à WBS È†ÖÁõÆ"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow mb-6 p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project_id",className:"label",children:"ÈÅ∏ÊìáÂ∞àÊ°à *"}),e.jsxs("select",{id:"project_id",value:n,onChange:m,className:"input-field",children:[e.jsx("option",{value:"",children:"-- Ë´ãÈÅ∏ÊìáÂ∞àÊ°à --"}),_.map(F=>e.jsxs("option",{value:F.project_id,children:[F.project_id," - ",F.project_name]},F.project_id))]})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("button",{onClick:y,disabled:!n||l,className:"btn-secondary",children:"ÂÖ®ÈÉ®Â±ïÈñã"}),e.jsx("button",{onClick:k,disabled:!n||l,className:"btn-secondary",children:"ÂÖ®ÈÉ®ÊäòÁñä"})]})]})}),n?l?e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"ËºâÂÖ•‰∏≠..."})]}):x?e.jsx("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:e.jsx("p",{className:"text-red-600",children:x})}):a.length===0?e.jsx("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:e.jsx("p",{className:"text-gray-500",children:"Ê≠§Â∞àÊ°àÁõÆÂâçÊ≤íÊúâ WBS È†ÖÁõÆ"})}):e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 border-b border-gray-200 px-3 py-3 flex items-center font-semibold text-sm text-gray-700",children:[e.jsx("div",{className:"w-6 flex-shrink-0"}),e.jsx("div",{className:"w-24 flex-shrink-0",children:"WBS ID"}),e.jsx("div",{className:"flex-1 min-w-0 px-2",children:"‰ªªÂãôÂêçÁ®±"}),e.jsx("div",{className:"w-20 flex-shrink-0 text-center",children:"È°ûÂà•"}),e.jsx("div",{className:"w-32 flex-shrink-0",children:"Ë≤†Ë≤¨ÂñÆ‰Ωç"}),e.jsx("div",{className:"w-24 flex-shrink-0 text-center",children:"ÁãÄÊÖã"}),e.jsx("div",{className:"w-32 flex-shrink-0 text-center",children:"ÈÄ≤Â∫¶"}),e.jsx("div",{className:"w-64 flex-shrink-0",children:"Ë®àÁï´ÊúüÈñì (ÂéüÂßã/Ë™øÊï¥)"})]}),e.jsx("div",{className:"tree-root",children:a.map(F=>e.jsx(S,{node:F,level:0},F.item_id))})]}):e.jsx("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:e.jsx("p",{className:"text-gray-500",children:"Ë´ãÈÅ∏ÊìáÂ∞àÊ°à‰ª•Êü•Áúã WBS Ê®πÁãÄÁµêÊßã"})})]})},hn=({analysis:t,onClose:s})=>{if(!t)return null;const n=r=>r||"-",a=r=>r===0?"text-gray-700":r>0?"text-red-600":"text-green-600";return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-5xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 pb-4 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"ÊôÇÁ®ãÂΩ±ÈüøÂàÜÊûê"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["ËÆäÊõ¥‰æÜÊ∫ê: ",e.jsx("span",{className:"font-semibold",children:t.source_wbs_id})," - ",t.source_task_name]})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:"‚úï"})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"ÊôÇÁ®ãËÆäÊõ¥ÊëòË¶Å"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ËÆäÊõ¥Ê¨Ñ‰Ωç: "}),e.jsx("span",{className:"font-semibold",children:t.date_change.field})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ÂéüÂßãÊó•Êúü: "}),e.jsx("span",{className:"font-semibold",children:n(t.date_change.old_value)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Êñ∞Êó•Êúü: "}),e.jsx("span",{className:"font-semibold text-blue-600",children:n(t.date_change.new_value)})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:t.total_affected}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"ÂèóÂΩ±ÈüøÈ†ÖÁõÆÊï∏"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:t.affected_items.filter(r=>r.delay_days>0).length}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"ÈúÄË¶ÅÂª∂Âæå"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:[e.jsx("div",{className:`text-3xl font-bold ${t.critical_path_affected?"text-red-600":"text-green-600"}`,children:t.critical_path_affected?"ÊòØ":"Âê¶"}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"ÂΩ±ÈüøÈóúÈçµË∑ØÂæë"})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-700 mb-3",children:["Âª∫Ë≠∞Ë™øÊï¥Ë®àÁï´ (",t.affected_items.length," È†Ö)"]}),t.affected_items.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Ê≤íÊúâÈ†ÖÁõÆÂèóÂà∞ÂΩ±Èüø"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"WBS ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"‰ªªÂãôÂêçÁ®±"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"ÁõÆÂâçÈñãÂßã"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Âª∫Ë≠∞ÈñãÂßã"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"ÁõÆÂâçÁµêÊùü"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Âª∫Ë≠∞ÁµêÊùü"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Âª∂ÈÅ≤Â§©Êï∏"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ÂéüÂõ†"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.affected_items.map((r,l)=>e.jsxs("tr",{className:r.delay_days>5?"bg-red-50":r.delay_days>0?"bg-yellow-50":"",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:r.wbs_id}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 max-w-xs truncate",children:r.task_name}),e.jsx("td",{className:"px-4 py-3 text-sm text-center text-gray-600",children:n(r.current_start)}),e.jsx("td",{className:"px-4 py-3 text-sm text-center",children:r.suggested_start?e.jsx("span",{className:"font-semibold text-blue-600",children:n(r.suggested_start)}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-center text-gray-600",children:n(r.current_end)}),e.jsx("td",{className:"px-4 py-3 text-sm text-center",children:r.suggested_end?e.jsx("span",{className:"font-semibold text-blue-600",children:n(r.suggested_end)}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-center",children:e.jsxs("span",{className:`font-semibold ${a(r.delay_days)}`,children:[r.delay_days>0?`+${r.delay_days}`:r.delay_days," Â§©"]})}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-600 max-w-xs",children:[r.reason,r.dependency_chain.length>0&&e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Èèà: ",r.dependency_chain.join(" ‚Üí ")]})]})]},l))})]})})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:s,className:"btn-secondary",children:"ÈóúÈñâ"}),e.jsx("button",{onClick:()=>{alert("Â•óÁî®Ë™øÊï¥ÂäüËÉΩÈñãÁôº‰∏≠...")},className:"btn-primary",disabled:t.affected_items.length===0,children:"Â•óÁî®Âª∫Ë≠∞Ë™øÊï¥"})]})]})})})},pn=()=>{const[t,s]=Re(),n=t.get("project_id")||"",[a,r]=d.useState([]),[l,i]=d.useState(!1),[x,p]=d.useState(null),[u,c]=d.useState(!1),[_,o]=d.useState(null),[R,m]=d.useState(null),[w,y]=d.useState(!1),{projectsList:k,fetchProjects:h}=_e(),{wbsList:g,fetchWBS:S}=We(),[F,O]=d.useState({predecessor_id:"",successor_id:"",dependency_type:"FS",lag_days:0,impact_level:"Medium",impact_description:"",is_active:!0});d.useEffect(()=>{h()},[]),d.useEffect(()=>{n?(S({project_id:n,limit:1e3}),v()):r([])},[n]);const v=async()=>{try{i(!0),p(null);const E=await L.get("/dependencies/",{params:{project_id:n,limit:1e3}});r(E.items||[])}catch(E){p(E.message||"ËºâÂÖ•‰æùË≥¥Èóú‰øÇÂ§±Êïó")}finally{i(!1)}},b=E=>{const H=E.target.value;s(H?{project_id:H}:{})},C=E=>{const{name:H,value:G,type:Z,checked:ie}=E.target;O(ae=>({...ae,[H]:Z==="checkbox"?ie:G}))},I=async E=>{if(E.preventDefault(),!F.predecessor_id||!F.successor_id){alert("Ë´ãÈÅ∏ÊìáÂâçÁΩÆÈ†ÖÁõÆÂíåÂæåÁ∫åÈ†ÖÁõÆ");return}if(F.predecessor_id===F.successor_id){alert("ÂâçÁΩÆÈ†ÖÁõÆÂíåÂæåÁ∫åÈ†ÖÁõÆ‰∏çËÉΩÁõ∏Âêå");return}try{_?(await L.put(`/dependencies/${_}`,F),alert("‰æùË≥¥Èóú‰øÇÂ∑≤Êõ¥Êñ∞")):(await L.post("/dependencies/",F),alert("‰æùË≥¥Èóú‰øÇÂ∑≤Êñ∞Â¢û")),W(),v()}catch(H){alert(`Êìç‰ΩúÂ§±Êïó: ${H.message}`)}},M=E=>{O({predecessor_id:E.predecessor_id,successor_id:E.successor_id,dependency_type:E.dependency_type,lag_days:E.lag_days,impact_level:E.impact_level,impact_description:E.impact_description||"",is_active:E.is_active}),o(E.dependency_id),c(!0)},Y=async E=>{if(window.confirm("Á¢∫ÂÆöË¶ÅÂà™Èô§Ê≠§‰æùË≥¥Èóú‰øÇÂóéÔºü"))try{await L.delete(`/dependencies/${E}`),alert("‰æùË≥¥Èóú‰øÇÂ∑≤Âà™Èô§"),v()}catch(H){alert(`Âà™Èô§Â§±Êïó: ${H.message}`)}},B=async E=>{try{i(!0);const H=await L.post(`/dependencies/item/${E.predecessor_id}/analyze-impact`,{field:"revised_planned_end",old_value:"2024-01-01",new_value:"2024-01-15"});m(H),y(!0)}catch(H){alert(`ÂàÜÊûêÂ§±Êïó: ${H.message}`)}finally{i(!1)}},W=()=>{O({predecessor_id:"",successor_id:"",dependency_type:"FS",lag_days:0,impact_level:"Medium",impact_description:"",is_active:!0}),o(null),c(!1)},T=E=>({Critical:"text-red-600 bg-red-50",High:"text-orange-600 bg-orange-50",Medium:"text-yellow-600 bg-yellow-50",Low:"text-green-600 bg-green-50"})[E]||"text-gray-600 bg-gray-50";return e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"‰æùË≥¥Èóú‰øÇÁÆ°ÁêÜ"}),e.jsx("p",{className:"text-gray-600",children:"ÁÆ°ÁêÜ WBS È†ÖÁõÆ‰πãÈñìÁöÑ‰æùË≥¥Èóú‰øÇÔºåÂàÜÊûêÊôÇÁ®ãÂΩ±Èüø"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow mb-6 p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project_id",className:"label",children:"ÈÅ∏ÊìáÂ∞àÊ°à *"}),e.jsxs("select",{id:"project_id",value:n,onChange:b,className:"input-field",children:[e.jsx("option",{value:"",children:"-- Ë´ãÈÅ∏ÊìáÂ∞àÊ°à --"}),k.map(E=>e.jsxs("option",{value:E.project_id,children:[E.project_id," - ",E.project_name]},E.project_id))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>c(!u),disabled:!n,className:"btn-primary",children:u?"ÂèñÊ∂àÊñ∞Â¢û":"+ Êñ∞Â¢û‰æùË≥¥Èóú‰øÇ"})})]})}),u&&n&&e.jsxs("div",{className:"bg-blue-50 rounded-lg shadow mb-6 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:_?"Á∑®ËºØ‰æùË≥¥Èóú‰øÇ":"Êñ∞Â¢û‰æùË≥¥Èóú‰øÇ"}),e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"ÂâçÁΩÆÈ†ÖÁõÆ (Ë¢´‰æùË≥¥ÁöÑ) *"}),e.jsxs("select",{name:"predecessor_id",value:F.predecessor_id,onChange:C,className:"input-field",required:!0,children:[e.jsx("option",{value:"",children:"-- ÈÅ∏ÊìáÂâçÁΩÆÈ†ÖÁõÆ --"}),g.map(E=>e.jsxs("option",{value:E.item_id,children:[E.wbs_id," - ",E.task_name]},E.item_id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"ÂæåÁ∫åÈ†ÖÁõÆ (‰æùË≥¥Âà•‰∫∫ÁöÑ) *"}),e.jsxs("select",{name:"successor_id",value:F.successor_id,onChange:C,className:"input-field",required:!0,children:[e.jsx("option",{value:"",children:"-- ÈÅ∏ÊìáÂæåÁ∫åÈ†ÖÁõÆ --"}),g.map(E=>e.jsxs("option",{value:E.item_id,children:[E.wbs_id," - ",E.task_name]},E.item_id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"‰æùË≥¥È°ûÂûã *"}),e.jsxs("select",{name:"dependency_type",value:F.dependency_type,onChange:C,className:"input-field",children:[e.jsx("option",{value:"FS",children:"FS (Finish-to-Start) - ÂÆåÊàêÂæåÊâçËÉΩÈñãÂßã"}),e.jsx("option",{value:"SS",children:"SS (Start-to-Start) - ÈñãÂßãÂæåÊâçËÉΩÈñãÂßã"}),e.jsx("option",{value:"FF",children:"FF (Finish-to-Finish) - ÂÆåÊàêÂæåÊâçËÉΩÂÆåÊàê"}),e.jsx("option",{value:"SF",children:"SF (Start-to-Finish) - ÈñãÂßãÂæåÊâçËÉΩÂÆåÊàê"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Âª∂ÈÅ≤Â§©Êï∏ (Lag/Lead)"}),e.jsx("input",{type:"number",name:"lag_days",value:F.lag_days,onChange:C,className:"input-field",placeholder:"Ê≠£Êï∏=Âª∂ÈÅ≤ÔºåË≤†Êï∏=ÊèêÂâç"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"ÂΩ±ÈüøÁ®ãÂ∫¶"}),e.jsxs("select",{name:"impact_level",value:F.impact_level,onChange:C,className:"input-field",children:[e.jsx("option",{value:"Critical",children:"Critical"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"label flex items-center",children:[e.jsx("input",{type:"checkbox",name:"is_active",checked:F.is_active,onChange:C,className:"mr-2"}),"ÂïüÁî®Ê≠§‰æùË≥¥Èóú‰øÇ"]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"ÂΩ±ÈüøË™™Êòé"}),e.jsx("textarea",{name:"impact_description",value:F.impact_description,onChange:C,className:"input-field",rows:"2",placeholder:"ÊèèËø∞Ê≠§‰æùË≥¥Èóú‰øÇÁöÑÂΩ±ÈüøÁØÑÂúç..."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary",children:_?"Êõ¥Êñ∞":"Êñ∞Â¢û"}),e.jsx("button",{type:"button",onClick:W,className:"btn-secondary",children:"ÂèñÊ∂à"})]})]})]}),n?l?e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"ËºâÂÖ•‰∏≠..."})]}):x?e.jsx("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:e.jsx("p",{className:"text-red-600",children:x})}):a.length===0?e.jsx("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:e.jsx("p",{className:"text-gray-500",children:"Ê≠§Â∞àÊ°àÁõÆÂâçÊ≤íÊúâ‰æùË≥¥Èóú‰øÇ"})}):e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ÂâçÁΩÆÈ†ÖÁõÆ"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"È°ûÂûã"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ÂæåÁ∫åÈ†ÖÁõÆ"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Âª∂ÈÅ≤"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"ÂΩ±Èüø"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"ÁãÄÊÖã"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Êìç‰Ωú"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(E=>e.jsxs("tr",{className:E.is_active?"":"opacity-50",children:[e.jsxs("td",{className:"px-4 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:E.predecessor_wbs_id}),e.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:E.predecessor_task_name})]}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"text-xs font-semibold px-2 py-1 bg-purple-100 text-purple-700 rounded",children:E.dependency_type})}),e.jsxs("td",{className:"px-4 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:E.successor_wbs_id}),e.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:E.successor_task_name})]}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsxs("span",{className:"text-sm text-gray-700",children:[E.lag_days>0?`+${E.lag_days}`:E.lag_days," Â§©"]})}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${T(E.impact_level)}`,children:E.impact_level})}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${E.is_active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:E.is_active?"ÂïüÁî®":"ÂÅúÁî®"})}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx("button",{onClick:()=>M(E),className:"text-blue-600 hover:text-blue-900 text-sm",children:"Á∑®ËºØ"}),e.jsx("button",{onClick:()=>Y(E.dependency_id),className:"text-red-600 hover:text-red-900 text-sm",children:"Âà™Èô§"}),e.jsx("button",{onClick:()=>B(E),className:"text-green-600 hover:text-green-900 text-sm",children:"ÂàÜÊûêÂΩ±Èüø"})]})})]},E.dependency_id))})]})}):e.jsx("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:e.jsx("p",{className:"text-gray-500",children:"Ë´ãÈÅ∏ÊìáÂ∞àÊ°à‰ª•Êü•Áúã‰æùË≥¥Èóú‰øÇ"})}),w&&R&&e.jsx(hn,{analysis:R,onClose:()=>{y(!1),m(null)}})]})},gn=()=>{const[t,s]=d.useState([]),[n,a]=d.useState(!1),[r,l]=d.useState(null),[i,x]=d.useState(0),p=d.useCallback(async(y={})=>{a(!0),l(null);try{const k={...y},h=await L.get("/pending/",{params:k});s(h.items||[]),x(h.total||0)}catch(k){l(k.message),s([])}finally{a(!1)}},[]),u=d.useCallback(async y=>{a(!0),l(null);try{return await L.get(`/pending/${y}`)}catch(k){throw l(k.message),k}finally{a(!1)}},[]),c=d.useCallback(async y=>{a(!0),l(null);try{return await L.post("/pending/",y)}catch(k){throw l(k.message),k}finally{a(!1)}},[]),_=d.useCallback(async(y,k)=>{a(!0),l(null);try{return await L.put(`/pending/${y}`,k)}catch(h){throw l(h.message),h}finally{a(!1)}},[]),o=d.useCallback(async y=>{a(!0),l(null);try{await L.delete(`/pending/${y}`)}catch(k){throw l(k.message),k}finally{a(!1)}},[]),R=d.useCallback(async y=>{a(!0),l(null);try{return await L.put(`/pending/${y}/reply`)}catch(k){throw l(k.message),k}finally{a(!1)}},[]),m=d.useCallback(async(y=null)=>{a(!0),l(null);try{const k=y?{project_id:y}:{};return await L.get("/pending/overdue",{params:k})}catch(k){throw l(k.message),k}finally{a(!1)}},[]),w=d.useCallback(async(y=null)=>{a(!0),l(null);try{const k=y?{project_id:y}:{};return await L.get("/pending/stats",{params:k})}catch(k){throw l(k.message),k}finally{a(!1)}},[]);return{pendingList:t,loading:n,error:r,total:i,fetchPending:p,getPending:u,createPending:c,updatePending:_,deletePending:o,markAsReplied:R,getOverdueItems:m,getStats:w}},fn=({initialData:t=null,onSubmit:s,onCancel:n,projectId:a})=>{const r=()=>{const g=new Date,S=g.getFullYear(),F=String(g.getMonth()+1).padStart(2,"0"),O=String(g.getDate()).padStart(2,"0");return`${S}-${F}-${O}`},[l,i]=d.useState({project_id:a||"",task_date:r(),source_type:"ÂÆ¢Êà∂",contact_info:"",description:"",planned_start_date:"",expected_completion_date:"",handling_notes:"",related_wbs:"",related_action_item:"",related_issue_id:"",status:"ÂæÖËôïÁêÜ",priority:"Medium"}),[x,p]=d.useState({}),{wbsList:u,fetchWBS:c}=We(),{issuesList:_,fetchIssues:o}=bt(),{projectsList:R,fetchProjects:m}=_e(),w=d.useMemo(()=>[...u||[]].sort(Qe),[u]);d.useEffect(()=>{m()},[]),d.useEffect(()=>{l.project_id&&(c({project_id:l.project_id,limit:1e3}),o({project_id:l.project_id,limit:1e3}))},[l.project_id]),d.useEffect(()=>{t&&i({...t,task_date:t.task_date||"",planned_start_date:t.planned_start_date||"",expected_completion_date:t.expected_completion_date||"",related_issue_id:t.related_issue_id||""})},[t]);const y=g=>{const{name:S,value:F}=g.target;i(O=>({...O,[S]:F})),x[S]&&p(O=>({...O,[S]:null}))},k=()=>{const g={};return l.project_id||(g.project_id="Ë´ãËº∏ÂÖ•Â∞àÊ°à ID"),l.task_date||(g.task_date="Ë´ãÈÅ∏Êìá‰ªªÂãôÊó•Êúü"),l.source_type||(g.source_type="Ë´ãÈÅ∏Êìá‰æÜÊ∫êÈ°ûÂûã"),l.description||(g.description="Ë´ãËº∏ÂÖ•‰ªªÂãôË™™Êòé"),p(g),Object.keys(g).length===0},h=g=>{if(g.preventDefault(),!k())return;const S={...l,related_issue_id:l.related_issue_id?parseInt(l.related_issue_id):null};Object.keys(S).forEach(F=>{S[F]===""&&(S[F]=null)}),s(S)};return e.jsxs("form",{onSubmit:h,className:"space-y-6 bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t?"Á∑®ËºØÂæÖËæ¶È†ÖÁõÆ":"Êñ∞Â¢ûÂæÖËæ¶È†ÖÁõÆ"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project_id",className:"label",children:"Â∞àÊ°à *"}),e.jsx("select",{id:"project_id",name:"project_id",value:l.project_id,onChange:y,disabled:!!t,className:"input-field",children:R.length===0?e.jsx("option",{value:"",children:"Ë´ãÂÖàÂª∫Á´ãÂ∞àÊ°à"}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Ë´ãÈÅ∏ÊìáÂ∞àÊ°à"}),R.map(g=>e.jsxs("option",{value:g.project_id,children:[g.project_id," - ",g.project_name]},g.project_id))]})}),x.project_id&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:x.project_id})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"task_date",className:"label",children:"‰ªªÂãôÊó•Êúü *"}),e.jsx("input",{type:"date",id:"task_date",name:"task_date",value:l.task_date,onChange:y,className:"input-field"}),x.task_date&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:x.task_date})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"source_type",className:"label",children:"‰æÜÊ∫êÈ°ûÂûã *"}),e.jsxs("select",{id:"source_type",name:"source_type",value:l.source_type,onChange:y,className:"input-field",children:[e.jsx("option",{value:"ÂÆ¢Êà∂",children:"ÂÆ¢Êà∂"}),e.jsx("option",{value:"Ëá™Â∑±",children:"Ëá™Â∑±"}),e.jsx("option",{value:"ÂÖßÈÉ®",children:"ÂÖßÈÉ®"})]}),x.source_type&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:x.source_type})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"priority",className:"label",children:"ÂÑ™ÂÖàÁ¥ö"}),e.jsxs("select",{id:"priority",name:"priority",value:l.priority,onChange:y,className:"input-field",children:[e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"contact_info",className:"label",children:"ËÅØÁµ°‰∫∫Ë≥áË®ä"}),e.jsx("input",{type:"text",id:"contact_info",name:"contact_info",value:l.contact_info,onChange:y,placeholder:"‰æãÂ¶Ç: ÁéãÂ∞èÊòé (ÂÆ¢Êà∂Á™óÂè£)",className:"input-field"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"description",className:"label",children:"‰ªªÂãôË™™Êòé *"}),e.jsx("textarea",{id:"description",name:"description",value:l.description,onChange:y,rows:"3",className:"input-field"}),x.description&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:x.description})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"planned_start_date",className:"label",children:"È†êË®àÈñãÂßãÊó•Êúü"}),e.jsx("input",{type:"date",id:"planned_start_date",name:"planned_start_date",value:l.planned_start_date,onChange:y,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"expected_completion_date",className:"label",children:"È†êË®àÂÆåÊàêÊó•Êúü"}),e.jsx("input",{type:"date",id:"expected_completion_date",name:"expected_completion_date",value:l.expected_completion_date,onChange:y,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"label",children:"ÁãÄÊÖã"}),e.jsxs("select",{id:"status",name:"status",value:l.status,onChange:y,className:"input-field",children:[e.jsx("option",{value:"ÂæÖËôïÁêÜ",children:"ÂæÖËôïÁêÜ"}),e.jsx("option",{value:"ËôïÁêÜ‰∏≠",children:"ËôïÁêÜ‰∏≠"}),e.jsx("option",{value:"Â∑≤ÂÆåÊàê",children:"Â∑≤ÂÆåÊàê"}),e.jsx("option",{value:"Â∑≤ÂèñÊ∂à",children:"Â∑≤ÂèñÊ∂à"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"handling_notes",className:"label",children:"ËôïÁêÜÂÇôË®ª"}),e.jsx("textarea",{id:"handling_notes",name:"handling_notes",value:l.handling_notes,onChange:y,rows:"2",placeholder:"Ë®òÈåÑËôïÁêÜÈÅéÁ®ãÊàñÂÇôË®ª",className:"input-field"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"ÈóúËÅØÈ†ÖÁõÆ"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"related_wbs",className:"label",children:"ÈóúËÅØ WBS"}),e.jsxs("select",{id:"related_wbs",name:"related_wbs",value:l.related_wbs,onChange:y,className:"input-field",children:[e.jsx("option",{value:"",children:"-- Ë´ãÈÅ∏Êìá WBS --"}),w&&w.length>0?w.map(g=>e.jsxs("option",{value:g.wbs_id,children:[g.wbs_id," - ",g.task_name]},g.item_id)):e.jsx("option",{value:"",disabled:!0,children:"ËºâÂÖ•‰∏≠..."})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"related_action_item",className:"label",children:"ÈóúËÅØ Action Item"}),e.jsx("input",{type:"text",id:"related_action_item",name:"related_action_item",value:l.related_action_item,onChange:y,placeholder:"ÊâãÂãïËº∏ÂÖ• Action Item",className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"related_issue_id",className:"label",children:"ÈóúËÅØ Issue"}),e.jsxs("select",{id:"related_issue_id",name:"related_issue_id",value:l.related_issue_id,onChange:y,className:"input-field",children:[e.jsx("option",{value:"",children:"-- Ë´ãÈÅ∏Êìá Issue --"}),_&&_.length>0?_.map(g=>e.jsxs("option",{value:g.issue_id,children:[g.issue_number," - ",g.issue_title]},g.issue_id)):e.jsx("option",{value:"",disabled:!0,children:"ËºâÂÖ•‰∏≠..."})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:n,className:"btn-secondary",children:"ÂèñÊ∂à"}),e.jsx("button",{type:"submit",className:"btn-primary",children:t?"Êõ¥Êñ∞":"Êñ∞Â¢û"})]})]})},yn=({pendingItem:t,onClose:s,onReplyAdded:n})=>{const[a,r]=d.useState([]),[l,i]=d.useState(!0),[x,p]=d.useState(!1),[u,c]=d.useState({replied_by:"",reply_content:"",reply_date:new Date().toISOString().split("T")[0]});d.useEffect(()=>{_()},[t.pending_id]);const _=async()=>{try{i(!0);const R=await L.get(`/pending/${t.pending_id}/replies`);r(R)}catch(R){console.error("Failed to fetch replies:",R)}finally{i(!1)}},o=async R=>{if(R.preventDefault(),!u.replied_by.trim()){alert("Ë´ãËº∏ÂÖ•ÂõûË¶Ü‰∫∫");return}try{await L.post(`/pending/${t.pending_id}/replies`,u),alert("ÂõûË¶ÜÂ∑≤Ê∑ªÂä†"),c({replied_by:"",reply_content:"",reply_date:new Date().toISOString().split("T")[0]}),p(!1),_(),n&&n()}catch(m){alert(`Ê∑ªÂä†ÂõûË¶ÜÂ§±Êïó: ${m.message}`)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"ÂõûË¶ÜÊ≠∑Âè≤"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:"‚úï"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"ÂæÖËæ¶‰∫ãÈ†Ö"}),e.jsx("p",{className:"text-gray-900",children:t.description}),e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[e.jsxs("span",{children:["‰æÜÊ∫ê: ",t.source_type]}),t.expected_reply_date&&e.jsxs("span",{className:"ml-4",children:["È†êË®àÂõûË¶Ü: ",t.expected_reply_date]})]})]}),!x&&e.jsx("button",{onClick:()=>p(!0),className:"btn-primary mb-4",children:"+ Êñ∞Â¢ûÂõûË¶Ü"}),x&&e.jsxs("form",{onSubmit:o,className:"bg-blue-50 p-4 rounded-lg mb-4",children:[e.jsx("h4",{className:"font-semibold text-gray-700 mb-3",children:"Êñ∞Â¢ûÂõûË¶Ü"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"ÂõûË¶Ü‰∫∫ *"}),e.jsx("input",{type:"text",value:u.replied_by,onChange:R=>c({...u,replied_by:R.target.value}),className:"input-field",placeholder:"Ëº∏ÂÖ•ÂõûË¶Ü‰∫∫ÂßìÂêç"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"ÂõûË¶ÜÊó•Êúü"}),e.jsx("input",{type:"date",value:u.reply_date,onChange:R=>c({...u,reply_date:R.target.value}),className:"input-field"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"label",children:"ÂõûË¶ÜÂÖßÂÆπ"}),e.jsx("textarea",{value:u.reply_content,onChange:R=>c({...u,reply_content:R.target.value}),className:"input-field",rows:"3",placeholder:"Ëº∏ÂÖ•ÂõûË¶ÜÂÖßÂÆπÔºàÈÅ∏Â°´Ôºâ"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary",children:"ÈÄÅÂá∫"}),e.jsx("button",{type:"button",onClick:()=>p(!1),className:"btn-secondary",children:"ÂèñÊ∂à"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-gray-700 mb-3",children:["ÂõûË¶ÜË®òÈåÑ (",a.length,")"]}),l?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"ËºâÂÖ•‰∏≠..."})]}):a.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Â∞öÁÑ°ÂõûË¶ÜË®òÈåÑ"}):e.jsx("div",{className:"space-y-3",children:a.map((R,m)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-900",children:R.replied_by}),e.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["#",a.length-m]})]}),e.jsx("span",{className:"text-sm text-gray-600",children:R.reply_date})]}),R.reply_content&&e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:R.reply_content}),e.jsxs("div",{className:"mt-2 text-xs text-gray-400",children:["Âª∫Á´ãÊôÇÈñì: ",new Date(R.created_at).toLocaleString("zh-TW")]})]},R.reply_id))})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:s,className:"btn-secondary",children:"ÈóúÈñâ"})})]})})})},jn=()=>{const[t,s]=Re(),[n,a]=d.useState(!1),[r,l]=d.useState(null),[i,x]=d.useState(!1),[p,u]=d.useState(null),[c,_]=d.useState(t.get("project")||""),[o,R]=d.useState({status:"",source_type:"",priority:""}),[m,w]=d.useState({clientSource:!1,selfResponsibility:!1,internalOnly:!1,overdueOnly:!1,dueThisWeek:!1,notCompleted:!1,dateRange:""}),{pendingList:y,loading:k,error:h,total:g,fetchPending:S,createPending:F,updatePending:O,deletePending:v}=gn(),{projectsList:b,fetchProjects:C}=_e(),{loading:I,exportPendingToExcel:M}=jt(),{systemSettings:Y,fetchSystemSettings:B,getSystemSetting:W}=Ne();d.useEffect(()=>{C(),B()},[C,B]),d.useEffect(()=>{if(!c&&b.length>0&&Y.length>0){const P=W("default_project_id",""),q=b.some(re=>re.project_id===P);_(q?P:b[0].project_id)}},[c,b,Y,W]),d.useEffect(()=>{c&&S({project_id:c,...o})},[S,c,o]),d.useEffect(()=>{c&&s({project:c})},[c,s]);const T=()=>{l(null),a(!0)},E=P=>{l(P),a(!0)},H=async P=>{if(window.confirm(`Á¢∫ÂÆöË¶ÅÂà™Èô§ÂæÖËæ¶È†ÖÁõÆ„Äå${P.description.substring(0,30)}...„ÄçÂóéÔºü`))try{await v(P.pending_id),alert("Âà™Èô§ÊàêÂäü"),S({project_id:c,...o})}catch(q){alert(`Âà™Èô§Â§±Êïó: ${q.message}`)}},G=async P=>{try{r?(await O(r.pending_id,P),alert("Êõ¥Êñ∞ÊàêÂäü")):(await F(P),alert("Êñ∞Â¢ûÊàêÂäü")),a(!1),l(null),S({project_id:c,...o})}catch(q){alert(`Êìç‰ΩúÂ§±Êïó: ${q.message}`)}},Z=()=>{a(!1),l(null)},ie=P=>{switch(P){case"Â∑≤ÂÆåÊàê":return"bg-green-100 text-green-800";case"ËôïÁêÜ‰∏≠":return"bg-blue-100 text-blue-800";case"ÂæÖËôïÁêÜ":return"bg-yellow-100 text-yellow-800";case"Â∑≤ÂèñÊ∂à":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},ae=P=>{switch(P){case"High":return"bg-red-100 text-red-800";case"Medium":return"bg-orange-100 text-orange-800";case"Low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},oe=P=>{switch(P){case"ÂÆ¢Êà∂":return"bg-purple-100 text-purple-800";case"Ëá™Â∑±":return"bg-blue-100 text-blue-800";case"ÂÖßÈÉ®":return"bg-cyan-100 text-cyan-800";default:return"bg-gray-100 text-gray-800"}},ne=(()=>{let P=[...y];if(m.clientSource&&(P=P.filter(q=>q.source_type==="ÂÆ¢Êà∂")),m.selfResponsibility&&(P=P.filter(q=>q.source_type==="Ëá™Â∑±")),m.internalOnly&&(P=P.filter(q=>q.source_type==="ÂÖßÈÉ®")),m.overdueOnly&&(P=P.filter(q=>q.is_overdue===!0)),m.dueThisWeek){const q=new Date,re=new Date(q);re.setDate(q.getDate()+7),P=P.filter(D=>{if(!D.expected_completion_date)return!1;const A=new Date(D.expected_completion_date);return A>=q&&A<=re})}if(m.notCompleted&&(P=P.filter(q=>q.status==="ÂæÖËôïÁêÜ"||q.status==="ËôïÁêÜ‰∏≠")),m.dateRange){const q=new Date;q.setHours(0,0,0,0),P=P.filter(re=>{if(!re.task_date)return!1;const D=new Date(re.task_date);switch(D.setHours(0,0,0,0),m.dateRange){case"today":return D.getTime()===q.getTime();case"yesterday":const A=new Date(q);return A.setDate(A.getDate()-1),D.getTime()===A.getTime();case"last7days":const Q=new Date(q);return Q.setDate(Q.getDate()-7),D>=Q&&D<=q;case"last30days":const X=new Date(q);return X.setDate(X.getDate()-30),D>=X&&D<=q;case"thisMonth":return D.getMonth()===q.getMonth()&&D.getFullYear()===q.getFullYear();case"lastMonth":const pe=new Date(q.getFullYear(),q.getMonth()-1,1),j=new Date(q.getFullYear(),q.getMonth(),0);return D>=pe&&D<=j;default:return!0}})}return P})(),ue=W("date_format","yyyy/MM/dd");return n?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(fn,{initialData:r,onSubmit:G,onCancel:Z,projectId:c})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"ÂæÖËæ¶Ê∏ÖÂñÆÁÆ°ÁêÜ"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{if(!c){alert("Ë´ãÂÖàÈÅ∏ÊìáÂ∞àÊ°à");return}try{await M(c),alert("ÂåØÂá∫ÊàêÂäü")}catch(P){alert(`ÂåØÂá∫Â§±Êïó: ${P.message}`)}},disabled:I,className:"btn-secondary",children:I?"ÂåØÂá∫‰∏≠...":"üì• ÂåØÂá∫ Excel"}),e.jsx("button",{onClick:T,className:"btn-primary",children:"+ Êñ∞Â¢ûÂæÖËæ¶È†ÖÁõÆ"})]})]}),e.jsxs("div",{className:"flex gap-4 items-center flex-wrap",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project-select",className:"label",children:"Â∞àÊ°à"}),e.jsx("select",{id:"project-select",value:c,onChange:P=>_(P.target.value),className:"input-field",children:b.length===0?e.jsx("option",{value:"",children:"Ë´ãÂÖàÂª∫Á´ãÂ∞àÊ°à"}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Ë´ãÈÅ∏ÊìáÂ∞àÊ°à"}),b.map(P=>e.jsxs("option",{value:P.project_id,children:[P.project_id," - ",P.project_name]},P.project_id))]})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"source-filter",className:"label",children:"‰æÜÊ∫ê"}),e.jsxs("select",{id:"source-filter",value:o.source_type,onChange:P=>R({...o,source_type:P.target.value}),className:"input-field",children:[e.jsx("option",{value:"",children:"ÂÖ®ÈÉ®"}),e.jsx("option",{value:"ÂÆ¢Êà∂",children:"ÂÆ¢Êà∂"}),e.jsx("option",{value:"Ëá™Â∑±",children:"Ëá™Â∑±"}),e.jsx("option",{value:"ÂÖßÈÉ®",children:"ÂÖßÈÉ®"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status-filter",className:"label",children:"ÁãÄÊÖã"}),e.jsxs("select",{id:"status-filter",value:o.status,onChange:P=>R({...o,status:P.target.value}),className:"input-field",children:[e.jsx("option",{value:"",children:"ÂÖ®ÈÉ®"}),e.jsx("option",{value:"ÂæÖËôïÁêÜ",children:"ÂæÖËôïÁêÜ"}),e.jsx("option",{value:"ËôïÁêÜ‰∏≠",children:"ËôïÁêÜ‰∏≠"}),e.jsx("option",{value:"Â∑≤ÂÆåÊàê",children:"Â∑≤ÂÆåÊàê"}),e.jsx("option",{value:"Â∑≤ÂèñÊ∂à",children:"Â∑≤ÂèñÊ∂à"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"priority-filter",className:"label",children:"ÂÑ™ÂÖàÁ¥ö"}),e.jsxs("select",{id:"priority-filter",value:o.priority,onChange:P=>R({...o,priority:P.target.value}),className:"input-field",children:[e.jsx("option",{value:"",children:"ÂÖ®ÈÉ®"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>S({project_id:c,...o}),className:"btn-secondary",children:"ÊêúÂ∞ã"})})]}),e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Êô∫ÊÖßÁØ©ÈÅ∏"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:m.clientSource,onChange:P=>w({...m,clientSource:P.target.checked}),className:"mr-2 rounded"}),e.jsx("span",{className:"text-gray-700",children:"Âè™ÁúãÂÆ¢Êà∂‰æÜÊ∫ê"})]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:m.selfResponsibility,onChange:P=>w({...m,selfResponsibility:P.target.checked}),className:"mr-2 rounded"}),e.jsx("span",{className:"text-gray-700",children:"Âè™ÁúãËá™Â∑±Ë≤†Ë≤¨"})]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:m.internalOnly,onChange:P=>w({...m,internalOnly:P.target.checked}),className:"mr-2 rounded"}),e.jsx("span",{className:"text-gray-700",children:"Âè™ÁúãÂÖßÈÉ®È†ÖÁõÆ"})]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:m.overdueOnly,onChange:P=>w({...m,overdueOnly:P.target.checked}),className:"mr-2 rounded"}),e.jsxs("span",{className:"text-gray-700 flex items-center",children:["Âè™ÁúãÈÄæÊúüÈ†ÖÁõÆ",e.jsx("span",{className:"ml-1 text-red-500",children:"‚ö†Ô∏è"})]})]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:m.dueThisWeek,onChange:P=>w({...m,dueThisWeek:P.target.checked}),className:"mr-2 rounded"}),e.jsx("span",{className:"text-gray-700",children:"Âè™ÁúãÊú¨ÈÄ±Âà∞Êúü"})]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:m.notCompleted,onChange:P=>w({...m,notCompleted:P.target.checked}),className:"mr-2 rounded"}),e.jsx("span",{className:"text-gray-700",children:"Âè™ÁúãÊú™ÂÆåÊàê"})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-1",children:[e.jsx("label",{htmlFor:"date-range-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"‰ªªÂãôÊó•ÊúüÂçÄÈñì"}),e.jsxs("select",{id:"date-range-filter",value:m.dateRange,onChange:P=>w({...m,dateRange:P.target.value}),className:"input-field text-sm w-full",children:[e.jsx("option",{value:"",children:"ÂÖ®ÈÉ®Êó•Êúü"}),e.jsx("option",{value:"today",children:"‰ªäÂ§©"}),e.jsx("option",{value:"yesterday",children:"Êò®Â§©"}),e.jsx("option",{value:"last7days",children:"ÊúÄËøë 7 Â§©"}),e.jsx("option",{value:"last30days",children:"ÊúÄËøë 30 Â§©"}),e.jsx("option",{value:"thisMonth",children:"Êú¨Êúà"}),e.jsx("option",{value:"lastMonth",children:"‰∏äÂÄãÊúà"})]})]}),Object.values(m).some(P=>P)&&e.jsx("button",{onClick:()=>w({clientSource:!1,selfResponsibility:!1,internalOnly:!1,overdueOnly:!1,dueThisWeek:!1,notCompleted:!1,dateRange:""}),className:"text-sm text-primary-600 hover:text-primary-800 underline",children:"Ê∏ÖÈô§ÊâÄÊúâÁØ©ÈÅ∏"})]})]})]}),h&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:h}),k&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"ËºâÂÖ•‰∏≠..."})]}),!k&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"‰ªªÂãôÊó•Êúü"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"‰æÜÊ∫ê"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ë™™Êòé"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"È†êË®àÈñãÂßã"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"È†êË®àÂÆåÊàê"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ÂØ¶ÈöõÂÆåÊàê"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ÂÑ™ÂÖàÁ¥ö"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ÁãÄÊÖã"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Êìç‰Ωú"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ne.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"px-6 py-4 text-center text-gray-500",children:y.length===0?"Êö´ÁÑ°Ë≥áÊñô":"ÁÑ°Á¨¶ÂêàÁØ©ÈÅ∏Ê¢ù‰ª∂ÁöÑË≥áÊñô"})}):ne.map(P=>e.jsxs("tr",{className:P.is_overdue?"bg-red-50":"",children:[e.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:[ge(P.task_date,ue),P.is_overdue&&e.jsx("span",{className:"ml-2 text-red-500",children:"‚ö†Ô∏è"})]}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${oe(P.source_type)}`,children:P.source_type})}),e.jsxs("td",{className:"px-4 py-4 text-sm text-gray-900 max-w-xs",children:[e.jsx("div",{className:"truncate",children:P.description}),P.related_wbs&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex items-center gap-1",children:[e.jsx("span",{className:"font-semibold",children:"ÂΩ±Èüø:"}),e.jsx("span",{className:"truncate",children:P.related_wbs})]})]}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:ge(P.planned_start_date,ue)}),e.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:[ge(P.expected_completion_date,ue),P.days_until_due!==null&&P.days_until_due<0&&e.jsxs("span",{className:"ml-2 text-red-600 text-xs",children:["(ÈÄæÊúü ",Math.abs(P.days_until_due)," Â§©)"]})]}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:ge(P.actual_completion_date,ue)}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ae(P.priority)}`,children:P.priority})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ie(P.status)}`,children:P.status})}),e.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium",children:[e.jsx("button",{onClick:()=>E(P),className:"text-primary-600 hover:text-primary-900 mr-3",children:"Á∑®ËºØ"}),e.jsx("button",{onClick:()=>H(P),className:"text-red-600 hover:text-red-900",children:"Âà™Èô§"})]})]},P.pending_id))})]})}),e.jsx("div",{className:"mt-4 text-sm text-gray-600",children:ne.length!==y.length?e.jsxs(e.Fragment,{children:["È°ØÁ§∫ ",ne.length," Á≠ÜÔºàÂÖ± ",g," Á≠ÜË≥áÊñôÔºâ"]}):e.jsxs(e.Fragment,{children:["ÂÖ± ",g," Á≠ÜË≥áÊñô"]})})]}),i&&p&&e.jsx(yn,{pendingItem:p,onClose:()=>{x(!1),u(null)},onReplyAdded:()=>{S({project_id:c,...o})}})]})},bn=({initialData:t=null,onSubmit:s,onCancel:n,projectId:a})=>{const[r,l]=d.useState({project_id:a||"",issue_title:"",issue_description:"",issue_type:"ÊäÄË°ìÂïèÈ°å",issue_category:"ÈòªÁ§ôËÄÖ",severity:"Medium",priority:"Medium",reported_by:"",assigned_to:"",owner_type:"ÂÖßÈÉ®",affected_wbs:"",impact_description:"",estimated_impact_days:"",status:"Open",resolution:"",root_cause:"",target_resolution_date:"",actual_resolution_date:"",closed_date:"",reported_date:new Date().toISOString().split("T")[0],source:"Manual"}),[i,x]=d.useState({}),[p,u]=d.useState([]),{wbsList:c,fetchWBS:_}=We(),{projectsList:o,fetchProjects:R}=_e(),{fetchOwnerUnits:m}=Ne(),[w,y]=d.useState([]);d.useEffect(()=>{R()},[]),d.useEffect(()=>{r.project_id&&m(r.project_id).then(v=>{y(v||[])}).catch(()=>y([]))},[r.project_id,m]);const k=d.useMemo(()=>{const v=c.map(I=>I.owner_unit).filter(Boolean),b=w;return[...new Set([...b,...v])].sort()},[c,w]);d.useEffect(()=>{r.project_id&&_({project_id:r.project_id,limit:1e3})},[r.project_id]),d.useEffect(()=>{if(t&&(l({...t,target_resolution_date:t.target_resolution_date||"",actual_resolution_date:t.actual_resolution_date||"",closed_date:t.closed_date||"",reported_date:t.reported_date||"",estimated_impact_days:t.estimated_impact_days||""}),t.affected_wbs)){const v=t.affected_wbs.split(",").map(b=>b.trim()).filter(Boolean);u(v)}},[t]);const h=v=>{const{name:b,value:C}=v.target;l(I=>({...I,[b]:C})),i[b]&&x(I=>({...I,[b]:null}))},g=v=>{u(b=>b.includes(v)?b.filter(C=>C!==v):[...b,v])},S=v=>{u(b=>b.filter(C=>C!==v))},F=()=>{const v={};return r.project_id||(v.project_id="Ë´ãËº∏ÂÖ•Â∞àÊ°à ID"),r.issue_title||(v.issue_title="Ë´ãËº∏ÂÖ•ÂïèÈ°åÊ®ôÈ°å"),r.issue_type||(v.issue_type="Ë´ãÈÅ∏ÊìáÂïèÈ°åÈ°ûÂûã"),r.issue_category||(v.issue_category="Ë´ãÈÅ∏ÊìáÂïèÈ°åÂàÜÈ°û"),r.severity||(v.severity="Ë´ãÈÅ∏ÊìáÂö¥ÈáçÊÄß"),r.priority||(v.priority="Ë´ãÈÅ∏ÊìáÂÑ™ÂÖàÁ¥ö"),r.reported_by||(v.reported_by="Ë´ãËº∏ÂÖ•ÂõûÂ†±‰∫∫"),x(v),Object.keys(v).length===0},O=v=>{if(v.preventDefault(),!F())return;const b={...r,estimated_impact_days:r.estimated_impact_days?parseInt(r.estimated_impact_days):null,affected_wbs:p.length>0?p.join(", "):null};Object.keys(b).forEach(C=>{b[C]===""&&(b[C]=null)}),s(b)};return e.jsxs("form",{onSubmit:O,className:"space-y-6 bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t?"Á∑®ËºØÂïèÈ°å":"Êñ∞Â¢ûÂïèÈ°å"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Âü∫Êú¨Ë≥áË®ä"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"project_id",className:"label",children:"Â∞àÊ°à *"}),e.jsx("select",{id:"project_id",name:"project_id",value:r.project_id,onChange:h,disabled:!!t,className:"input-field",children:o.length===0?e.jsx("option",{value:"",children:"Ë´ãÂÖàÂª∫Á´ãÂ∞àÊ°à"}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Ë´ãÈÅ∏ÊìáÂ∞àÊ°à"}),o.map(v=>e.jsxs("option",{value:v.project_id,children:[v.project_id," - ",v.project_name]},v.project_id))]})}),i.project_id&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.project_id})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"issue_title",className:"label",children:"ÂïèÈ°åÊ®ôÈ°å *"}),e.jsx("input",{type:"text",id:"issue_title",name:"issue_title",value:r.issue_title,onChange:h,className:"input-field"}),i.issue_title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.issue_title})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"issue_description",className:"label",children:"ÂïèÈ°åË™™Êòé"}),e.jsx("textarea",{id:"issue_description",name:"issue_description",value:r.issue_description,onChange:h,rows:"3",className:"input-field"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"ÂàÜÈ°û"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"issue_type",className:"label",children:"ÂïèÈ°åÈ°ûÂûã *"}),e.jsxs("select",{id:"issue_type",name:"issue_type",value:r.issue_type,onChange:h,className:"input-field",children:[e.jsx("option",{value:"ÊäÄË°ìÂïèÈ°å",children:"ÊäÄË°ìÂïèÈ°å"}),e.jsx("option",{value:"ÈúÄÊ±ÇÂïèÈ°å",children:"ÈúÄÊ±ÇÂïèÈ°å"}),e.jsx("option",{value:"Ë≥áÊ∫êÂïèÈ°å",children:"Ë≥áÊ∫êÂïèÈ°å"}),e.jsx("option",{value:"ÊôÇÁ®ãÂïèÈ°å",children:"ÊôÇÁ®ãÂïèÈ°å"}),e.jsx("option",{value:"ÂÖ∂‰ªñ",children:"ÂÖ∂‰ªñ"})]}),i.issue_type&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.issue_type})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"issue_category",className:"label",children:"ÂïèÈ°åÂàÜÈ°û *"}),e.jsxs("select",{id:"issue_category",name:"issue_category",value:r.issue_category,onChange:h,className:"input-field",children:[e.jsx("option",{value:"ÈòªÁ§ôËÄÖ",children:"ÈòªÁ§ôËÄÖ"}),e.jsx("option",{value:"È¢®Èö™",children:"È¢®Èö™"}),e.jsx("option",{value:"ËÆäÊõ¥Ë´ãÊ±Ç",children:"ËÆäÊõ¥Ë´ãÊ±Ç"}),e.jsx("option",{value:"Áº∫Èô∑",children:"Áº∫Èô∑"})]}),i.issue_category&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.issue_category})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"severity",className:"label",children:"Âö¥ÈáçÊÄß *"}),e.jsxs("select",{id:"severity",name:"severity",value:r.severity,onChange:h,className:"input-field",children:[e.jsx("option",{value:"Critical",children:"Critical"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]}),i.severity&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.severity})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"priority",className:"label",children:"ÂÑ™ÂÖàÁ¥ö *"}),e.jsxs("select",{id:"priority",name:"priority",value:r.priority,onChange:h,className:"input-field",children:[e.jsx("option",{value:"Urgent",children:"Urgent"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]}),i.priority&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.priority})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Ë≤†Ë≤¨‰∫∫"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reported_by",className:"label",children:"ÂõûÂ†±‰∫∫ *"}),e.jsx("input",{type:"text",id:"reported_by",name:"reported_by",value:r.reported_by,onChange:h,className:"input-field"}),i.reported_by&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.reported_by})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"assigned_to",className:"label",children:"ÊåáÊ¥æÁµ¶"}),e.jsxs("select",{id:"assigned_to",name:"assigned_to",value:r.assigned_to,onChange:h,className:"input-field",children:[e.jsx("option",{value:"",children:"-- Ë´ãÈÅ∏Êìá --"}),k.map(v=>e.jsx("option",{value:v,children:v},v))]}),k.length===0&&e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"ÊèêÁ§∫ÔºöË´ãÂÖàÂú® WBS ÁÆ°ÁêÜ‰∏≠Ë®≠ÂÆöÂñÆ‰Ωç"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"owner_type",className:"label",children:"Ë≤†Ë≤¨È°ûÂûã"}),e.jsxs("select",{id:"owner_type",name:"owner_type",value:r.owner_type,onChange:h,className:"input-field",children:[e.jsx("option",{value:"ÂÆ¢Êà∂",children:"ÂÆ¢Êà∂"}),e.jsx("option",{value:"ÂÖßÈÉ®",children:"ÂÖßÈÉ®"}),e.jsx("option",{value:"Âª†ÂïÜ",children:"Âª†ÂïÜ"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"ÂΩ±ÈüøÁØÑÂúç"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"affected_wbs_selector",className:"label",children:"ÂèóÂΩ±ÈüøÁöÑ WBS"}),e.jsxs("select",{id:"affected_wbs_selector",onChange:v=>{v.target.value&&(g(v.target.value),v.target.value="")},className:"input-field",children:[e.jsx("option",{value:"",children:"-- ÈªûÊìäÈÅ∏Êìá WBS --"}),c&&c.length>0?c.filter(v=>!p.includes(v.wbs_id)).map(v=>e.jsxs("option",{value:v.wbs_id,children:[v.wbs_id," - ",v.task_name]},v.item_id)):e.jsx("option",{value:"",disabled:!0,children:c?"ÁÑ°ÂèØÁî®ÁöÑ WBS È†ÖÁõÆ":"ËºâÂÖ•‰∏≠..."})]}),p.length>0&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:p.map(v=>{const b=c.find(C=>C.wbs_id===v);return e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:[e.jsxs("span",{children:[v,b&&` - ${b.task_name}`]}),e.jsx("button",{type:"button",onClick:()=>S(v),className:"text-blue-600 hover:text-blue-800 font-bold",title:"ÁßªÈô§",children:"√ó"})]},v)})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"estimated_impact_days",className:"label",children:"È†ê‰º∞ÂΩ±ÈüøÂ§©Êï∏"}),e.jsx("input",{type:"number",id:"estimated_impact_days",name:"estimated_impact_days",value:r.estimated_impact_days,onChange:h,min:"0",className:"input-field"})]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"impact_description",className:"label",children:"ÂΩ±ÈüøË™™Êòé"}),e.jsx("textarea",{id:"impact_description",name:"impact_description",value:r.impact_description,onChange:h,rows:"2",className:"input-field"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"ÁãÄÊÖãËàáÊôÇÁ®ã"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"label",children:"ÁãÄÊÖã"}),e.jsxs("select",{id:"status",name:"status",value:r.status,onChange:h,className:"input-field",children:[e.jsx("option",{value:"Open",children:"Open"}),e.jsx("option",{value:"In Progress",children:"In Progress"}),e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Resolved",children:"Resolved"}),e.jsx("option",{value:"Closed",children:"Closed"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reported_date",className:"label",children:"ÂõûÂ†±Êó•Êúü"}),e.jsx("input",{type:"date",id:"reported_date",name:"reported_date",value:r.reported_date,onChange:h,disabled:!!t,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"target_resolution_date",className:"label",children:"ÁõÆÊ®ôËß£Ê±∫Êó•Êúü"}),e.jsx("input",{type:"date",id:"target_resolution_date",name:"target_resolution_date",value:r.target_resolution_date,onChange:h,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"actual_resolution_date",className:"label",children:"ÂØ¶ÈöõËß£Ê±∫Êó•Êúü"}),e.jsx("input",{type:"date",id:"actual_resolution_date",name:"actual_resolution_date",value:r.actual_resolution_date,onChange:h,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"closed_date",className:"label",children:"ÁµêÊ°àÊó•Êúü"}),e.jsx("input",{type:"date",id:"closed_date",name:"closed_date",value:r.closed_date,onChange:h,className:"input-field"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Ëß£Ê±∫ÊñπÊ°à"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"resolution",className:"label",children:"Ëß£Ê±∫ÊñπÊ°à"}),e.jsx("textarea",{id:"resolution",name:"resolution",value:r.resolution,onChange:h,rows:"2",className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"root_cause",className:"label",children:"Ê†πÊú¨ÂéüÂõ†ÂàÜÊûê"}),e.jsx("textarea",{id:"root_cause",name:"root_cause",value:r.root_cause,onChange:h,rows:"2",className:"input-field"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:n,className:"btn-secondary",children:"ÂèñÊ∂à"}),e.jsx("button",{type:"submit",className:"btn-primary",children:t?"Êõ¥Êñ∞":"Êñ∞Â¢û"})]})]})},_n=()=>{const[t,s]=Re(),[n,a]=d.useState(!1),[r,l]=d.useState(null),[i,x]=d.useState(t.get("project")||""),[p,u]=d.useState({status:"",severity:"",priority:""}),[c,_]=d.useState({myResponsibility:!1,clientOwner:!1,overdueOnly:!1,notCompleted:!1,targetDateRange:""}),[o,R]=d.useState(""),{issuesList:m,loading:w,error:y,total:k,fetchIssues:h,createIssue:g,updateIssue:S,deleteIssue:F,escalateIssue:O,resolveIssue:v,closeIssue:b}=bt(),{projectsList:C,fetchProjects:I}=_e(),{loading:M,exportIssuesToExcel:Y}=jt(),{systemSettings:B,fetchSystemSettings:W,getSystemSetting:T}=Ne();d.useEffect(()=>{I(),W()},[I,W]),d.useEffect(()=>{if(!i&&C.length>0&&B.length>0){const D=T("default_project_id",""),A=C.some(Q=>Q.project_id===D);x(A?D:C[0].project_id)}},[i,C,B,T]),d.useEffect(()=>{i&&h({project_id:i,...p})},[h,i,p]),d.useEffect(()=>{i&&s({project:i})},[i,s]);const E=()=>{l(null),a(!0)},H=D=>{l(D),a(!0)},G=async D=>{if(window.confirm(`Á¢∫ÂÆöË¶ÅÂà™Èô§ÂïèÈ°å„Äå${D.issue_title}„ÄçÂóéÔºü`))try{await F(D.issue_id),alert("Âà™Èô§ÊàêÂäü"),h({project_id:i,...p})}catch(A){alert(`Âà™Èô§Â§±Êïó: ${A.message}`)}},Z=async D=>{try{r?(await S(r.issue_id,D),alert("Êõ¥Êñ∞ÊàêÂäü")):(await g(D),alert("Êñ∞Â¢ûÊàêÂäü")),a(!1),l(null),h({project_id:i,...p})}catch(A){alert(`Êìç‰ΩúÂ§±Êïó: ${A.message}`)}},ie=()=>{a(!1),l(null)},ae=async D=>{const A=prompt("Ë´ãËº∏ÂÖ•ÂçáÁ¥öÂ±§Á¥ö (PM/Senior Manager/Executive):"),Q=prompt("Ë´ãËº∏ÂÖ•ÂçáÁ¥öÂéüÂõ†:"),X=prompt("Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑÂßìÂêç:");if(A&&Q&&X)try{await O(D,{escalation_level:A,escalation_reason:Q,changed_by:X}),alert("ÂçáÁ¥öÊàêÂäü"),h({project_id:i,...p})}catch(pe){alert(`ÂçáÁ¥öÂ§±Êïó: ${pe.message}`)}},oe=async D=>{const A=prompt("Ë´ãËº∏ÂÖ•Ëß£Ê±∫ÊñπÊ°à:"),Q=prompt("Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑÂßìÂêç:");if(A&&Q)try{await v(D,{resolution:A,resolved_by:Q}),alert("Â∑≤Ê®ôË®òÁÇ∫Â∑≤Ëß£Ê±∫"),h({project_id:i,...p})}catch(X){alert(`Ê®ôË®òÂ§±Êïó: ${X.message}`)}},ye=async D=>{const A=prompt("Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑÂßìÂêç:");if(A)try{await b(D,{closed_by:A}),alert("Â∑≤ÈóúÈñâÂïèÈ°å"),h({project_id:i,...p})}catch(Q){alert(`ÈóúÈñâÂ§±Êïó: ${Q.message}`)}},ne=D=>{switch(D){case"Open":return"bg-blue-100 text-blue-800";case"In Progress":return"bg-yellow-100 text-yellow-800";case"Pending":return"bg-orange-100 text-orange-800";case"Resolved":return"bg-green-100 text-green-800";case"Closed":return"bg-gray-100 text-gray-800";case"Cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},ue=D=>{switch(D){case"Urgent":return"bg-red-600 text-white";case"High":return"bg-red-100 text-red-800";case"Medium":return"bg-orange-100 text-orange-800";case"Low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},q=(()=>{let D=[...m];if(c.myResponsibility&&o&&(D=D.filter(A=>A.assigned_to===o)),c.clientOwner&&(D=D.filter(A=>A.owner_type==="ÂÆ¢Êà∂")),c.overdueOnly&&(D=D.filter(A=>A.is_overdue===!0)),c.notCompleted){const A=["Closed","Cancelled","Resolved"];D=D.filter(Q=>!A.includes(Q.status))}if(p.status==="not_completed"){const A=["Closed","Cancelled","Resolved"];D=D.filter(Q=>!A.includes(Q.status))}if(c.targetDateRange){const A=new Date;A.setHours(0,0,0,0),D=D.filter(Q=>{if(!Q.target_resolution_date)return!1;const X=new Date(Q.target_resolution_date);switch(X.setHours(0,0,0,0),c.targetDateRange){case"today":return X.getTime()===A.getTime();case"yesterday":const pe=new Date(A);return pe.setDate(pe.getDate()-1),X.getTime()===pe.getTime();case"last7days":const j=new Date(A);return j.setDate(j.getDate()-7),X>=j&&X<=A;case"last30days":const ee=new Date(A);return ee.setDate(ee.getDate()-30),X>=ee&&X<=A;case"thisMonth":return X.getMonth()===A.getMonth()&&X.getFullYear()===A.getFullYear();case"lastMonth":const Ue=new Date(A.getFullYear(),A.getMonth()-1,1),He=new Date(A.getFullYear(),A.getMonth(),0);return X>=Ue&&X<=He;case"next7days":const Oe=new Date(A);return Oe.setDate(Oe.getDate()+7),X>=A&&X<=Oe;case"next30days":const Te=new Date(A);return Te.setDate(Te.getDate()+30),X>=A&&X<=Te;default:return!0}})}return D})(),re=T("date_format","yyyy/MM/dd");return n?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(bn,{initialData:r,onSubmit:Z,onCancel:ie,projectId:i})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"ÂïèÈ°åËøΩËπ§ÁÆ°ÁêÜ"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{if(!i){alert("Ë´ãÂÖàÈÅ∏ÊìáÂ∞àÊ°à");return}try{await Y(i),alert("ÂåØÂá∫ÊàêÂäü")}catch(D){alert(`ÂåØÂá∫Â§±Êïó: ${D.message}`)}},disabled:M,className:"btn-secondary",children:M?"ÂåØÂá∫‰∏≠...":"üì• ÂåØÂá∫ Excel"}),e.jsx("button",{onClick:E,className:"btn-primary",children:"+ Êñ∞Â¢ûÂïèÈ°å"})]})]}),e.jsxs("div",{className:"flex gap-4 items-center flex-wrap",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project-select",className:"label",children:"Â∞àÊ°à"}),e.jsx("select",{id:"project-select",value:i,onChange:D=>x(D.target.value),className:"input-field",children:C.length===0?e.jsx("option",{value:"",children:"Ë´ãÂÖàÂª∫Á´ãÂ∞àÊ°à"}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Ë´ãÈÅ∏ÊìáÂ∞àÊ°à"}),C.map(D=>e.jsxs("option",{value:D.project_id,children:[D.project_id," - ",D.project_name]},D.project_id))]})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status-filter",className:"label",children:"ÁãÄÊÖã"}),e.jsxs("select",{id:"status-filter",value:p.status,onChange:D=>u({...p,status:D.target.value}),className:"input-field",children:[e.jsx("option",{value:"",children:"ÂÖ®ÈÉ®"}),e.jsx("option",{value:"not_completed",children:"Êú™ÂÆåÊàê"}),e.jsx("option",{value:"Open",children:"Open"}),e.jsx("option",{value:"In Progress",children:"In Progress"}),e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Resolved",children:"Resolved"}),e.jsx("option",{value:"Closed",children:"Closed"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"severity-filter",className:"label",children:"Âö¥ÈáçÊÄß"}),e.jsxs("select",{id:"severity-filter",value:p.severity,onChange:D=>u({...p,severity:D.target.value}),className:"input-field",children:[e.jsx("option",{value:"",children:"ÂÖ®ÈÉ®"}),e.jsx("option",{value:"Critical",children:"Critical"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"priority-filter",className:"label",children:"ÂÑ™ÂÖàÁ¥ö"}),e.jsxs("select",{id:"priority-filter",value:p.priority,onChange:D=>u({...p,priority:D.target.value}),className:"input-field",children:[e.jsx("option",{value:"",children:"ÂÖ®ÈÉ®"}),e.jsx("option",{value:"Urgent",children:"Urgent"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>h({project_id:i,...p}),className:"btn-secondary",children:"ÊêúÂ∞ã"})})]}),e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Êô∫ÊÖßÁØ©ÈÅ∏"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:c.myResponsibility,onChange:D=>_({...c,myResponsibility:D.target.checked}),className:"mr-2 rounded"}),e.jsx("span",{className:"text-gray-700",children:"Âè™ÁúãÊàëË≤†Ë≤¨ÁöÑ"})]}),c.myResponsibility&&e.jsx("input",{type:"text",value:o,onChange:D=>R(D.target.value),placeholder:"Ëº∏ÂÖ•ÊÇ®ÁöÑÂßìÂêç",className:"input-field text-sm ml-6"})]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:c.clientOwner,onChange:D=>_({...c,clientOwner:D.target.checked}),className:"mr-2 rounded"}),e.jsx("span",{className:"text-gray-700",children:"Âè™ÁúãÂÆ¢Êà∂Ë≤¨‰ªª"})]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:c.internalOnly,onChange:D=>_({...c,internalOnly:D.target.checked}),className:"mr-2 rounded"}),e.jsx("span",{className:"text-gray-700",children:"Âè™ÁúãÂÖßÈÉ®È†ÖÁõÆ"})]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:c.overdueOnly,onChange:D=>_({...c,overdueOnly:D.target.checked}),className:"mr-2 rounded"}),e.jsxs("span",{className:"text-gray-700 flex items-center",children:["Âè™ÁúãÈÄæÊúüÈ†ÖÁõÆ",e.jsx("span",{className:"ml-1 text-red-500",children:"‚ö†Ô∏è"})]})]}),e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:c.notCompleted,onChange:D=>_({...c,notCompleted:D.target.checked}),className:"mr-2 rounded"}),e.jsx("span",{className:"text-gray-700",children:"Êú™ÂÆåÊàê"})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-1",children:[e.jsx("label",{htmlFor:"target-date-range-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"ÁõÆÊ®ôËß£Ê±∫Êó•ÊúüÂçÄÈñì"}),e.jsxs("select",{id:"target-date-range-filter",value:c.targetDateRange,onChange:D=>_({...c,targetDateRange:D.target.value}),className:"input-field text-sm w-full",children:[e.jsx("option",{value:"",children:"ÂÖ®ÈÉ®Êó•Êúü"}),e.jsx("option",{value:"today",children:"‰ªäÂ§©"}),e.jsx("option",{value:"yesterday",children:"Êò®Â§©"}),e.jsx("option",{value:"last7days",children:"ÈÅéÂéª 7 Â§©"}),e.jsx("option",{value:"last30days",children:"ÈÅéÂéª 30 Â§©"}),e.jsx("option",{value:"next7days",children:"Êú™‰æÜ 7 Â§©"}),e.jsx("option",{value:"next30days",children:"Êú™‰æÜ 30 Â§©"}),e.jsx("option",{value:"thisMonth",children:"Êú¨Êúà"}),e.jsx("option",{value:"lastMonth",children:"‰∏äÂÄãÊúà"})]})]}),Object.values(c).some(D=>D)&&e.jsx("button",{onClick:()=>_({myResponsibility:!1,clientOwner:!1,internalOnly:!1,overdueOnly:!1,escalatedOnly:!1,reportedDateRange:"",targetDateRange:""}),className:"text-sm text-primary-600 hover:text-primary-800 underline",children:"Ê∏ÖÈô§ÊâÄÊúâÁØ©ÈÅ∏"})]})]})]}),y&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:y}),w&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"ËºâÂÖ•‰∏≠..."})]}),!w&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Á∑®Ëôü"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ÂïèÈ°åÊ®ôÈ°å"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"È°ûÂûã"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ÂÑ™ÂÖàÁ¥ö"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ÂõûÂ†±Êó•Êúü"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ÁõÆÊ®ôËß£Ê±∫Êó•Êúü"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ÂØ¶ÈöõËß£Ê±∫Êó•Êúü"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ÁãÄÊÖã"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Êìç‰Ωú"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:q.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"px-6 py-4 text-center text-gray-500",children:m.length===0?"Êö´ÁÑ°Ë≥áÊñô":"ÁÑ°Á¨¶ÂêàÁØ©ÈÅ∏Ê¢ù‰ª∂ÁöÑË≥áÊñô"})}):q.map(D=>e.jsxs("tr",{className:D.is_overdue?"bg-red-50":"",children:[e.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[D.issue_number,D.is_escalated&&e.jsx("span",{className:"ml-2 text-orange-500",children:"‚¨ÜÔ∏è"})]}),e.jsxs("td",{className:"px-4 py-4 text-sm text-gray-900 max-w-xs",children:[e.jsxs("div",{className:"truncate",children:[D.issue_title,D.is_overdue&&e.jsx("span",{className:"ml-2 text-red-500",children:"‚ö†Ô∏è"})]}),D.affected_wbs&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex items-center gap-1",children:[e.jsx("span",{className:"font-semibold",children:"ÂΩ±Èüø:"}),e.jsx("span",{className:"truncate",children:D.affected_wbs})]})]}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:D.issue_type}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ue(D.priority)}`,children:D.priority})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-600",children:ge(D.reported_date,re)}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-600",children:ge(D.target_resolution_date,re)}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-600",children:ge(D.actual_resolution_date,re)}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ne(D.status)}`,children:D.status})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>H(D),className:"text-primary-600 hover:text-primary-900",title:"Á∑®ËºØ",children:"Á∑®ËºØ"}),D.status!=="Resolved"&&D.status!=="Closed"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>ae(D.issue_id),className:"text-orange-600 hover:text-orange-900",title:"ÂçáÁ¥ö",children:"ÂçáÁ¥ö"}),e.jsx("button",{onClick:()=>oe(D.issue_id),className:"text-green-600 hover:text-green-900",title:"Ëß£Ê±∫",children:"Ëß£Ê±∫"})]}),D.status==="Resolved"&&D.status!=="Closed"&&e.jsx("button",{onClick:()=>ye(D.issue_id),className:"text-gray-600 hover:text-gray-900",title:"ÈóúÈñâ",children:"ÈóúÈñâ"}),e.jsx("button",{onClick:()=>G(D),className:"text-red-600 hover:text-red-900",title:"Âà™Èô§",children:"Âà™Èô§"})]})})]},D.issue_id))})]})}),e.jsx("div",{className:"mt-4 text-sm text-gray-600",children:q.length!==m.length?e.jsxs(e.Fragment,{children:["È°ØÁ§∫ ",q.length," Á≠ÜÔºàÂÖ± ",k," Á≠ÜË≥áÊñôÔºâ"]}):e.jsxs(e.Fragment,{children:["ÂÖ± ",k," Á≠ÜË≥áÊñô"]})})]})]})},Nn=({tasks:t,viewMode:s="Day",onTaskClick:n,onDateChange:a})=>{const r=d.useRef(null),l=d.useRef(null);d.useEffect(()=>{if(console.log("GanttChart effect triggered:",{hasRef:!!r.current,tasksCount:(t==null?void 0:t.length)||0,tasks:t}),!r.current||!t||t.length===0){console.log("Skipping Gantt render - missing requirements");return}const x=t.map(p=>{const u=p.revised_planned_start||p.original_planned_start||p.actual_start_date,c=p.revised_planned_end||p.original_planned_end||p.actual_end_date,_=new Date,o=new Date(_);o.setDate(o.getDate()+1);const R=u||_.toISOString().split("T")[0],m=c||o.toISOString().split("T")[0],w=new Date(R).getTime(),k=new Date(m).getTime()>w?m:new Date(w+864e5).toISOString().split("T")[0],h={id:p.wbs_id,name:`${p.wbs_id} ${p.task_name||""}`.trim(),start:R,end:k,progress:p.actual_progress||0,dependencies:p.dependencies||"",custom_class:i(p)};return console.log("Converted task:",p.wbs_id,h),h});console.log("Gantt tasks prepared:",x),l.current&&(l.current=null,r.current.innerHTML="");try{console.log("Creating Gantt instance with",x.length,"tasks"),l.current=new Ss(r.current,x,{view_mode:s,bar_height:30,bar_corner_radius:3,arrow_curve:5,padding:18,date_format:"YYYY-MM-DD",custom_popup_html:p=>{const u=t.find(o=>o.wbs_id===p.id),c=p._start?new Date(p._start).toLocaleDateString("zh-TW"):"N/A",_=p._end?new Date(p._end).toLocaleDateString("zh-TW"):"N/A";return`
            <div class="gantt-popup">
              <h3 style="margin: 0 0 10px 0; font-size: 14px;">${p.name}</h3>
              <p style="margin: 5px 0; font-size: 12px;"><strong>WBS ID:</strong> ${p.id}</p>
              <p style="margin: 5px 0; font-size: 12px;"><strong>ÈñãÂßã:</strong> ${c}</p>
              <p style="margin: 5px 0; font-size: 12px;"><strong>ÁµêÊùü:</strong> ${_}</p>
              <p style="margin: 5px 0; font-size: 12px;"><strong>ÈÄ≤Â∫¶:</strong> ${p.progress}%</p>
              ${u!=null&&u.primary_owner?`<p style="margin: 5px 0; font-size: 12px;"><strong>Ë≤†Ë≤¨‰∫∫:</strong> ${u.primary_owner}</p>`:""}
              ${u!=null&&u.status?`<p style="margin: 5px 0; font-size: 12px;"><strong>ÁãÄÊÖã:</strong> ${u.status}</p>`:""}
            </div>
          `},on_click:p=>{if(n){const u=t.find(c=>c.wbs_id===p.id);n(u)}},on_date_change:(p,u,c)=>{a&&a(p.id,u,c)}}),console.log("Gantt chart created successfully")}catch(p){console.error("Error creating Gantt chart:",p),console.error("Error stack:",p.stack),console.error("Tasks that caused error:",x)}return()=>{l.current&&(l.current=null)}},[t,s,n,a]);const i=x=>x.status==="Â∑≤ÂÆåÊàê"?"gantt-bar-complete":x.status==="ÈÄ≤Ë°å‰∏≠"?"gantt-bar-in-progress":x.status==="Âª∂ÈÅ≤"?"gantt-bar-delayed":x.progress_variance&&x.progress_variance<-10?"gantt-bar-behind":"";return e.jsx("div",{className:"gantt-container",children:e.jsx("svg",{ref:r})})},vn=()=>{const[t,s]=Re(),[n,a]=d.useState(t.get("project")||""),[r,l]=d.useState("Day"),[i,x]=d.useState(null),[p,u]=d.useState(!1),[c,_]=d.useState("all"),[o,R]=d.useState({startDate:"",endDate:""}),{wbsList:m,loading:w,error:y,fetchWBS:k}=We(),{projectsList:h,fetchProjects:g}=_e(),{systemSettings:S,fetchSystemSettings:F,getSystemSetting:O}=Ne();d.useEffect(()=>{g(),F()},[g,F]),d.useEffect(()=>{if(!n&&h.length>0&&S.length>0){const T=O("default_project_id",""),E=h.some(H=>H.project_id===T);a(E?T:h[0].project_id)}},[n,h,S,O]),d.useEffect(()=>{if(S.length>0){const T=O("default_view_mode","Day");l(T)}},[S,O]),d.useEffect(()=>{if(n){console.log("Fetching WBS for project:",n);const T=O("items_per_page",1e3);k({project_id:n,limit:T})}},[n,k,S,O]),d.useEffect(()=>{n&&s({project:n})},[n,s]),d.useEffect(()=>{console.log("WBS List updated:",m.length,"items",m)},[m]);const v=T=>{x(T),u(!0)},b=async(T,E,H)=>{console.log("Date changed:",T,E,H),alert(`‰ªªÂãô ${T} Êó•ÊúüÂ∑≤Êõ¥Êîπ:
ÈñãÂßã: ${E.toLocaleDateString("zh-TW")}
ÁµêÊùü: ${H.toLocaleDateString("zh-TW")}`)},C=m.filter(T=>{if(c==="parents"){if(T.parent_id)return!1}else if(c==="children"&&!T.parent_id)return!1;if(!o.startDate&&!o.endDate)return!0;const E=T.revised_planned_start||T.original_planned_start,H=T.revised_planned_end||T.original_planned_end;return!(o.startDate&&H&&H<o.startDate||o.endDate&&E&&E>o.endDate)}),I=T=>{const{name:E,value:H}=T.target;R(G=>({...G,[E]:H}))},M=()=>{R({startDate:"",endDate:""}),_("all")},Y=O("date_format","yyyy/MM/dd"),B=[{value:"Quarter Day",label:"6Â∞èÊôÇ"},{value:"Half Day",label:"ÂçäÊó•"},{value:"Day",label:"Êó•"},{value:"Week",label:"ÈÄ±"},{value:"Month",label:"Êúà"},{value:"Year",label:"Âπ¥"}],W=[{value:"all",label:"ÂÖ®ÈÉ®"},{value:"parents",label:"ÂÉÖÁà∂È†ÖÁõÆ"},{value:"children",label:"ÂÉÖÂ≠êÈ†ÖÁõÆ"}];return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"ÁîòÁâπÂúñË¶ñÂúñ"}),e.jsxs("div",{className:"flex flex-wrap gap-4 items-center bg-white p-4 rounded-lg shadow",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project-select",className:"label",children:"Â∞àÊ°à"}),e.jsx("select",{id:"project-select",value:n,onChange:T=>a(T.target.value),className:"input-field",children:h.length===0?e.jsx("option",{value:"",children:"Ë´ãÂÖàÂª∫Á´ãÂ∞àÊ°à"}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Ë´ãÈÅ∏ÊìáÂ∞àÊ°à"}),h.map(T=>e.jsxs("option",{value:T.project_id,children:[T.project_id," - ",T.project_name]},T.project_id))]})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"view-mode",className:"label",children:"Á∏ÆÊîæ"}),e.jsx("select",{id:"view-mode",value:r,onChange:T=>l(T.target.value),className:"input-field",children:B.map(T=>e.jsx("option",{value:T.value,children:T.label},T.value))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"parent-filter",className:"label",children:"Â±§Á¥öÁØ©ÈÅ∏"}),e.jsx("select",{id:"parent-filter",value:c,onChange:T=>_(T.target.value),className:"input-field",children:W.map(T=>e.jsx("option",{value:T.value,children:T.label},T.value))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"label",children:"ÈñãÂßãÊó•Êúü"}),e.jsx("input",{type:"date",id:"start-date",name:"startDate",value:o.startDate,onChange:I,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"end-date",className:"label",children:"ÁµêÊùüÊó•Êúü"}),e.jsx("input",{type:"date",id:"end-date",name:"endDate",value:o.endDate,onChange:I,className:"input-field"})]}),(o.startDate||o.endDate||c!=="all")&&e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:M,className:"btn-secondary",children:"Ê∏ÖÈô§ÁØ©ÈÅ∏"})}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>{const T=O("items_per_page",1e3);k({project_id:n,limit:T})},className:"btn-secondary",disabled:w,children:w?"ËºâÂÖ•‰∏≠...":"ÈáçÊñ∞ËºâÂÖ•"})}),e.jsx("div",{className:"ml-auto text-sm text-gray-600",children:o.startDate||o.endDate||c!=="all"?e.jsxs(e.Fragment,{children:["È°ØÁ§∫ ",C.length," / ",m.length," ÂÄã‰ªªÂãô"]}):e.jsxs(e.Fragment,{children:["ÂÖ± ",m.length," ÂÄã‰ªªÂãô"]})})]})]}),y&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:y}),w&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"ËºâÂÖ•‰∏≠..."})]}),!w&&C.length>0&&e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsx(Nn,{tasks:C,viewMode:r,onTaskClick:v,onDateChange:b})}),!w&&m.length===0&&e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow text-center text-gray-500",children:[e.jsx("p",{className:"text-lg",children:"Êö´ÁÑ° WBS Ë≥áÊñô"}),e.jsx("p",{className:"mt-2 text-sm",children:"Ë´ãÂÖàÂª∫Á´ã WBS È†ÖÁõÆÊàñÈÅ∏ÊìáÂÖ∂‰ªñÂ∞àÊ°à"})]}),!w&&m.length>0&&C.length===0&&e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow text-center text-gray-500",children:[e.jsx("p",{className:"text-lg",children:"ÁÑ°Á¨¶ÂêàÊ¢ù‰ª∂ÁöÑ WBS Ë≥áÊñô"}),e.jsx("p",{className:"mt-2 text-sm",children:"Ë´ãË™øÊï¥Êó•ÊúüÁØ©ÈÅ∏Ê¢ù‰ª∂"})]}),p&&i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"‰ªªÂãôË©≥ÊÉÖ"}),e.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:"‚úï"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"WBS ID"}),e.jsx("p",{className:"text-gray-900",children:i.wbs_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"‰ªªÂãôÂêçÁ®±"}),e.jsx("p",{className:"text-gray-900",children:i.task_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Ë≤†Ë≤¨‰∫∫"}),e.jsx("p",{className:"text-gray-900",children:i.primary_owner||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"ÁãÄÊÖã"}),e.jsxs("p",{className:"text-gray-900",children:[i.status||"-",i.is_overdue&&e.jsx("span",{className:"ml-2 text-red-600 font-semibold",children:"ÈÄæÊúü"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"È†êË®àÈñãÂßã"}),e.jsx("p",{className:"text-gray-900",children:ge(i.original_planned_start,Y)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"È†êË®àÁµêÊùü"}),e.jsx("p",{className:"text-gray-900",children:ge(i.original_planned_end,Y)})]}),i.revised_planned_start&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Ë™øÊï¥ÂæåÈñãÂßã"}),e.jsx("p",{className:"text-blue-600",children:ge(i.revised_planned_start,Y)})]}),i.revised_planned_end&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Ë™øÊï¥ÂæåÁµêÊùü"}),e.jsx("p",{className:"text-blue-600",children:ge(i.revised_planned_end,Y)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"ÂØ¶ÈöõÈÄ≤Â∫¶"}),e.jsxs("p",{className:"text-gray-900",children:[i.actual_progress||0,"%"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"È†ê‰º∞ÈÄ≤Â∫¶"}),e.jsxs("p",{className:"text-gray-900",children:[i.estimated_progress||0,"%"]})]}),i.progress_variance!==null&&i.progress_variance!==void 0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"ÈÄ≤Â∫¶Â∑ÆÁï∞"}),e.jsxs("p",{className:i.progress_variance<0?"text-red-600":"text-green-600",children:[i.progress_variance>0?"+":"",i.progress_variance,"%"]})]})]})}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>u(!1),className:"btn-secondary",children:"ÈóúÈñâ"})})]})})})]})},wn=()=>{const[t,s]=d.useState([]),[n,a]=d.useState(null),[r,l]=d.useState(!1),[i,x]=d.useState(null),[p,u]=d.useState("");d.useEffect(()=>{c(),_()},[]);const c=async()=>{try{l(!0),x(null);const g=await L.get("/backup/list");s(g.backups||[])}catch(g){x(g.message||"ËºâÂÖ•ÂÇô‰ªΩÂàóË°®Â§±Êïó")}finally{l(!1)}},_=async()=>{try{const g=await L.get("/backup/stats");a(g.stats)}catch(g){console.error("Failed to fetch stats:",g)}},o=async()=>{if(window.confirm("Á¢∫ÂÆöË¶ÅÂª∫Á´ãÊñ∞ÁöÑË≥áÊñôÂ∫´ÂÇô‰ªΩÂóéÔºü"))try{l(!0),await L.post("/backup/create",{description:p}),alert("ÂÇô‰ªΩÂª∫Á´ãÊàêÂäüÔºÅ"),u(""),c(),_()}catch(g){alert(`Âª∫Á´ãÂÇô‰ªΩÂ§±Êïó: ${g.message}`)}finally{l(!1)}},R=async g=>{try{const S=`${L.defaults.baseURL}/backup/download/${g}`,F=document.createElement("a");F.href=S,F.download=g,document.body.appendChild(F),F.click(),document.body.removeChild(F)}catch(S){alert(`‰∏ãËºâÂÇô‰ªΩÂ§±Êïó: ${S.message}`)}},m=async g=>{if(window.confirm(`Ë≠¶ÂëäÔºöÈÇÑÂéüÂÇô‰ªΩÂ∞áÊúÉË¶ÜËìãÁõÆÂâçÁöÑË≥áÊñôÂ∫´ÔºÅ

Á≥ªÁµ±ÊúÉÂú®ÈÇÑÂéüÂâçËá™ÂãïÂª∫Á´ãÁõÆÂâçË≥áÊñôÂ∫´ÁöÑÂÇô‰ªΩ„ÄÇ

Á¢∫ÂÆöË¶ÅÁπºÁ∫åÂóéÔºü`))try{l(!0),await L.post("/backup/restore",{filename:g}),alert(`Ë≥áÊñôÂ∫´Â∑≤ÊàêÂäüÈÇÑÂéüÔºÅ

È†ÅÈù¢Â∞áÈáçÊñ∞ËºâÂÖ•‰ª•ÂèçÊò†ËÆäÊõ¥„ÄÇ`),window.location.reload()}catch(S){alert(`ÈÇÑÂéüÂÇô‰ªΩÂ§±Êïó: ${S.message}`),l(!1)}},w=async g=>{if(window.confirm(`Á¢∫ÂÆöË¶ÅÂà™Èô§ÂÇô‰ªΩ "${g}" ÂóéÔºü

Ê≠§Êìç‰ΩúÁÑ°Ê≥ïÂæ©ÂéüÔºÅ`))try{l(!0),await L.delete(`/backup/delete/${g}`),alert("ÂÇô‰ªΩÂ∑≤Âà™Èô§"),c()}catch(S){alert(`Âà™Èô§ÂÇô‰ªΩÂ§±Êïó: ${S.message}`)}finally{l(!1)}},y=async()=>{const g=prompt("Ë´ãËº∏ÂÖ•Ë¶Å‰øùÁïôÁöÑÂÇô‰ªΩÊï∏ÈáèÔºàÂÖ∂È§òÂ∞áË¢´Âà™Èô§ÔºâÔºö","10");if(!(!g||isNaN(g)||parseInt(g)<1)&&window.confirm(`Á¢∫ÂÆöË¶ÅÊ∏ÖÁêÜËàäÂÇô‰ªΩÔºåÂè™‰øùÁïôÊúÄËøëÁöÑ ${g} ÂÄãÂÇô‰ªΩÂóéÔºü`))try{l(!0);const S=await L.post(`/backup/cleanup?keep_count=${g}`);alert(S.message),c()}catch(S){alert(`Ê∏ÖÁêÜÂÇô‰ªΩÂ§±Êïó: ${S.message}`)}finally{l(!1)}},k=g=>g<1024?`${g} B`:g<1024*1024?`${(g/1024).toFixed(2)} KB`:`${(g/(1024*1024)).toFixed(2)} MB`,h=g=>new Date(g).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});return e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Ë≥áÊñôÂ∫´ÂÇô‰ªΩÁÆ°ÁêÜ"}),e.jsx("p",{className:"text-gray-600",children:"Âª∫Á´ã„ÄÅ‰∏ãËºâ„ÄÅÈÇÑÂéüÂíåÁÆ°ÁêÜË≥áÊñôÂ∫´ÂÇô‰ªΩ"})]}),n&&e.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 mb-6 rounded",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"ÁõÆÂâçË≥áÊñôÂ∫´Ë≥áË®ä"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-blue-800",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Ë≥áÊñôÂ∫´Â§ßÂ∞èÔºö"}),k(n.size)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Â∞àÊ°àÊï∏Ôºö"}),n.tables.projects||0]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"WBS È†ÖÁõÆÔºö"}),n.tables.tracking_items||0]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"ÂæÖËæ¶‰∫ãÈ†ÖÔºö"}),n.tables.pending_items||0]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow mb-6 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Âª∫Á´ãÊñ∞ÂÇô‰ªΩ"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{type:"text",value:p,onChange:g=>u(g.target.value),placeholder:"ÂÇô‰ªΩË™™ÊòéÔºàÈÅ∏Â°´Ôºâ",className:"input-field flex-1"}),e.jsx("button",{onClick:o,disabled:r,className:"btn-primary whitespace-nowrap",children:"üíæ Âª∫Á´ãÂÇô‰ªΩ"}),e.jsx("button",{onClick:y,disabled:r,className:"btn-secondary whitespace-nowrap",children:"üßπ Ê∏ÖÁêÜËàäÂÇô‰ªΩ"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["ÂÇô‰ªΩÂàóË°® (",t.length,")"]})}),r&&t.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"ËºâÂÖ•‰∏≠..."})]}):i?e.jsx("div",{className:"p-8 text-center text-red-600",children:i}):t.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"ÁõÆÂâçÊ≤íÊúâÂÇô‰ªΩ"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ê™îÊ°àÂêçÁ®±"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ë™™Êòé"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Â§ßÂ∞è"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Âª∫Á´ãÊôÇÈñì"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Êìç‰Ωú"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(g=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 text-sm font-mono text-gray-900",children:g.filename}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:g.description}),e.jsx("td",{className:"px-6 py-4 text-sm text-center text-gray-600",children:k(g.size)}),e.jsx("td",{className:"px-6 py-4 text-sm text-center text-gray-600",children:h(g.created_at)}),e.jsx("td",{className:"px-6 py-4 text-sm text-center",children:e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx("button",{onClick:()=>R(g.filename),className:"text-blue-600 hover:text-blue-900",title:"‰∏ãËºâÂÇô‰ªΩ",children:"üì• ‰∏ãËºâ"}),e.jsx("button",{onClick:()=>m(g.filename),className:"text-green-600 hover:text-green-900",title:"ÈÇÑÂéüÂÇô‰ªΩ",disabled:r,children:"‚Ü©Ô∏è ÈÇÑÂéü"}),e.jsx("button",{onClick:()=>w(g.filename),className:"text-red-600 hover:text-red-900",title:"Âà™Èô§ÂÇô‰ªΩ",disabled:r,children:"üóëÔ∏è Âà™Èô§"})]})})]},g.filename))})]})})]}),e.jsx("div",{className:"mt-6 bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("span",{className:"text-2xl",children:"‚ö†Ô∏è"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-yellow-800",children:"ÈáçË¶ÅÊèêÈÜí"}),e.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"ÂÇô‰ªΩÊ™îÊ°àÂÑ≤Â≠òÂú®‰º∫ÊúçÂô®ÁöÑ data/backups ÁõÆÈåÑ‰∏≠"}),e.jsx("li",{children:"Âª∫Ë≠∞ÂÆöÊúüÂª∫Á´ãÂÇô‰ªΩÔºå‰∏¶‰∏ãËºâÂà∞Êú¨Ê©ü‰øùÂ≠ò"}),e.jsx("li",{children:"ÈÇÑÂéüÂÇô‰ªΩÂâçÔºåÁ≥ªÁµ±ÊúÉËá™ÂãïÂª∫Á´ãÁõÆÂâçË≥áÊñôÂ∫´ÁöÑÂÇô‰ªΩ"}),e.jsx("li",{children:"Âà™Èô§ÂÇô‰ªΩÂæåÁÑ°Ê≥ïÂæ©ÂéüÔºåË´ãË¨πÊÖéÊìç‰Ωú"}),e.jsx("li",{children:"Âª∫Ë≠∞‰øùÁïôÊúÄËøë 10-20 ÂÄãÂÇô‰ªΩÔºåÂÆöÊúüÊ∏ÖÁêÜËàäÂÇô‰ªΩÁØÄÁúÅÁ©∫Èñì"})]})})]})]})})]})},Sn=()=>{const{systemSettings:t,holidays:s,loading:n,error:a,fetchSystemSettings:r,updateSystemSetting:l,fetchHolidays:i,createHoliday:x,updateHoliday:p,deleteHoliday:u}=Ne(),[c,_]=d.useState(""),[o,R]=d.useState({}),[m,w]=d.useState(new Date().getFullYear()),[y,k]=d.useState(!1),[h,g]=d.useState(null),[S,F]=d.useState({holiday_date:"",holiday_name:""});d.useEffect(()=>{r(),i(m)},[]),d.useEffect(()=>{i(m)},[m]),d.useEffect(()=>{const E={};t.forEach(H=>{E[H.setting_key]=H.setting_value}),R(E)},[t]);const O=E=>{const{name:H,value:G,type:Z,checked:ie}=E.target;R(ae=>({...ae,[H]:Z==="checkbox"?ie?"true":"false":G}))},v=async E=>{E.preventDefault(),_("");try{const H=Object.keys(o).map(G=>{const Z=t.find(ie=>ie.setting_key===G);return!Z||Z.setting_value!==o[G]?l(G,o[G]):null});await Promise.all(H.filter(G=>G!==null)),await r(),_("Ë®≠ÂÆöÂ∑≤ÊàêÂäüÂÑ≤Â≠òÔºÅ"),setTimeout(()=>_(""),3e3)}catch(H){alert("ÂÑ≤Â≠òË®≠ÂÆöÊôÇÁôºÁîüÈåØË™§Ôºö"+H.message)}},b=E=>{const{name:H,value:G}=E.target;F(Z=>({...Z,[H]:G}))},C=()=>{g(null),F({holiday_date:`${m}-01-01`,holiday_name:""}),k(!0)},I=E=>{g(E),F({holiday_date:E.holiday_date,holiday_name:E.holiday_name}),k(!0)},M=async E=>{E.preventDefault();try{const G=new Date(S.holiday_date).getFullYear();h?(await p(h.holiday_id,{year:G,holiday_date:S.holiday_date,holiday_name:S.holiday_name}),_("ÂÅáÊó•Â∑≤Êõ¥Êñ∞ÔºÅ")):(await x({year:G,holiday_date:S.holiday_date,holiday_name:S.holiday_name}),_("ÂÅáÊó•Â∑≤Êñ∞Â¢ûÔºÅ")),k(!1),g(null),i(m),setTimeout(()=>_(""),3e3)}catch(H){alert("Êìç‰ΩúÂ§±ÊïóÔºö"+H.message)}},Y=async E=>{if(window.confirm(`Á¢∫ÂÆöË¶ÅÂà™Èô§„Äå${E.holiday_name}„ÄçÂóéÔºü`))try{await u(E.holiday_id),_("ÂÅáÊó•Â∑≤Âà™Èô§ÔºÅ"),setTimeout(()=>_(""),3e3)}catch(H){alert("Âà™Èô§Â§±ÊïóÔºö"+H.message)}},B=()=>{k(!1),g(null),F({holiday_date:"",holiday_name:""})},W=new Date().getFullYear(),T=[];for(let E=W-2;E<=W+5;E++)T.push(E);return n&&t.length===0?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"ËºâÂÖ•Ë®≠ÂÆö‰∏≠..."})]})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Á≥ªÁµ±Ë®≠ÂÆö"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"ÁÆ°ÁêÜÁ≥ªÁµ±ÁöÑÂÖ®ÂüüË®≠ÂÆöÂèÉÊï∏"})]}),c&&e.jsx("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded",children:c}),a&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:a}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"È°ØÁ§∫Ë®≠ÂÆö"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date_format",className:"label",children:"Êó•ÊúüÊ†ºÂºè"}),e.jsxs("select",{id:"date_format",name:"date_format",value:o.date_format||"yyyy/MM/dd",onChange:O,className:"input-field",children:[e.jsx("option",{value:"yyyy/MM/dd",children:"yyyy/MM/dd (2024/01/15)"}),e.jsx("option",{value:"yyyy-MM-dd",children:"yyyy-MM-dd (2024-01-15)"}),e.jsx("option",{value:"MM/dd/yyyy",children:"MM/dd/yyyy (01/15/2024)"}),e.jsx("option",{value:"dd/MM/yyyy",children:"dd/MM/yyyy (15/01/2024)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"default_view_mode",className:"label",children:"È†êË®≠Ë¶ñÂúñÊ®°ÂºèÔºàÁîòÁâπÂúñÔºâ"}),e.jsxs("select",{id:"default_view_mode",name:"default_view_mode",value:o.default_view_mode||"Day",onChange:O,className:"input-field",children:[e.jsx("option",{value:"Quarter Day",children:"Â≠£Êó•"}),e.jsx("option",{value:"Half Day",children:"ÂçäÊó•"}),e.jsx("option",{value:"Day",children:"Êó•"}),e.jsx("option",{value:"Week",children:"ÈÄ±"}),e.jsx("option",{value:"Month",children:"Êúà"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"items_per_page",className:"label",children:"ÊØèÈ†ÅÈ°ØÁ§∫Á≠ÜÊï∏"}),e.jsxs("select",{id:"items_per_page",name:"items_per_page",value:o.items_per_page||"50",onChange:O,className:"input-field",children:[e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"}),e.jsx("option",{value:"200",children:"200"})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Ë®àÁÆóË¶èÂâá"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"progress_calculation",className:"label",children:"ÈÄ≤Â∫¶Ë®àÁÆóÊñπÂºè"}),e.jsxs("select",{id:"progress_calculation",name:"progress_calculation",value:o.progress_calculation||"date_based",onChange:O,className:"input-field",children:[e.jsx("option",{value:"date_based",children:"Âü∫ÊñºÊó•ÊúüËá™ÂãïË®àÁÆó"}),e.jsx("option",{value:"manual",children:"ÊâãÂãïËº∏ÂÖ•"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Âü∫ÊñºÊó•ÊúüÔºöÊ†πÊìöÈñãÂßã/ÁµêÊùüÊó•ÊúüËá™ÂãïË®àÁÆóÈ†ê‰º∞ÈÄ≤Â∫¶"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Â∑•‰ΩúÂ§©Êï∏Ë®àÁÆó"}),e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("input",{type:"checkbox",id:"include_weekends",name:"include_weekends",checked:o.include_weekends==="true",onChange:O,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"include_weekends",className:"ml-2 block text-sm text-gray-700",children:"ÂåÖÂê´ÈÄ±Êú´ÔºàÈÄ±ÂÖ≠„ÄÅÈÄ±Êó•Ôºâ"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"ÂèñÊ∂àÂãæÈÅ∏ÂâáÂ∑•‰ΩúÂ§©Êï∏Âè™Ë®àÁÆóÈÄ±‰∏ÄËá≥ÈÄ±‰∫î"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"overdue_warning_days",className:"label",children:"ÈÄæÊúüË≠¶Á§∫Â§©Êï∏"}),e.jsx("input",{type:"number",id:"overdue_warning_days",name:"overdue_warning_days",value:o.overdue_warning_days||"3",onChange:O,min:"0",max:"30",className:"input-field"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"ÊèêÂâçÂπæÂ§©ÈñãÂßãÈ°ØÁ§∫ÈÄæÊúüË≠¶Á§∫"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"ÈÄöÁü•Ë®≠ÂÆö"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label text-gray-400",children:"ÈÄæÊúüÊèêÈÜí"}),e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("input",{type:"checkbox",id:"enable_overdue_alert",name:"enable_overdue_alert",checked:o.enable_overdue_alert==="true",disabled:!0,className:"h-4 w-4 text-gray-300 border-gray-300 rounded cursor-not-allowed"}),e.jsx("label",{htmlFor:"enable_overdue_alert",className:"ml-2 block text-sm text-gray-400",children:"ÂïüÁî®ÈÄæÊúüÊèêÈÜí"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"ÔºàÊ≠§ÂäüËÉΩÂ∞öÊú™ÂØ¶‰ΩúÔºåÁõÆÂâçÊ∞∏ÈÅ†ÂïüÁî®Ôºâ"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"progress_lag_threshold",className:"label",children:"ÈÄ≤Â∫¶ËêΩÂæåË≠¶Á§∫ÈñæÂÄºÔºà%Ôºâ"}),e.jsx("input",{type:"number",id:"progress_lag_threshold",name:"progress_lag_threshold",value:o.progress_lag_threshold||"10",onChange:O,min:"0",max:"100",className:"input-field"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"ÂØ¶ÈöõÈÄ≤Â∫¶ËêΩÂæåÈ†ê‰º∞ÈÄ≤Â∫¶ÈÅîÊ≠§ÁôæÂàÜÊØîÊôÇÈ°ØÁ§∫Ë≠¶Á§∫"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>r(),className:"btn-secondary",children:"ÈáçÊñ∞ËºâÂÖ•"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:n,children:n?"ÂÑ≤Â≠ò‰∏≠...":"ÂÑ≤Â≠òË®≠ÂÆö"})]})]}),e.jsxs("div",{className:"mt-8 bg-white p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"ÂÅáÊó•Ë®≠ÂÆö"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{htmlFor:"year-select",className:"text-sm text-gray-600",children:"Âπ¥Â∫¶Ôºö"}),e.jsx("select",{id:"year-select",value:m,onChange:E=>w(parseInt(E.target.value)),className:"input-field py-1 px-2",children:T.map(E=>e.jsx("option",{value:E,children:E},E))})]}),e.jsx("button",{onClick:C,className:"btn-primary text-sm",children:"+ Êñ∞Â¢ûÂÅáÊó•"})]})]}),y&&e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg border",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:h?"Á∑®ËºØÂÅáÊó•":"Êñ∞Â¢ûÂÅáÊó•"}),e.jsxs("form",{onSubmit:M,className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"holiday_date",className:"label",children:"Êó•Êúü"}),e.jsx("input",{type:"date",id:"holiday_date",name:"holiday_date",value:S.holiday_date,onChange:b,required:!0,className:"input-field"})]}),e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx("label",{htmlFor:"holiday_name",className:"label",children:"ÂÅáÊó•ÂêçÁ®±"}),e.jsx("input",{type:"text",id:"holiday_name",name:"holiday_name",value:S.holiday_name,onChange:b,required:!0,placeholder:"‰æãÂ¶ÇÔºöÂÖÉÊó¶",className:"input-field"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary",children:h?"Êõ¥Êñ∞":"Êñ∞Â¢û"}),e.jsx("button",{type:"button",onClick:B,className:"btn-secondary",children:"ÂèñÊ∂à"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Êó•Êúü"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"ÂÅáÊó•ÂêçÁ®±"}),e.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Êìç‰Ωú"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:s.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"3",className:"px-4 py-8 text-center text-gray-500",children:[m," Âπ¥Â∞öÊú™Ë®≠ÂÆöÂÅáÊó•"]})}):s.map(E=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:E.holiday_date}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:E.holiday_name}),e.jsxs("td",{className:"px-4 py-2 text-right",children:[e.jsx("button",{onClick:()=>I(E),className:"text-primary-600 hover:text-primary-800 text-sm mr-3",children:"Á∑®ËºØ"}),e.jsx("button",{onClick:()=>Y(E),className:"text-red-600 hover:text-red-800 text-sm",children:"Âà™Èô§"})]})]},E.holiday_id))})]})}),e.jsx("p",{className:"mt-4 text-sm text-gray-500",children:"Ë®≠ÂÆöÁöÑÂÅáÊó•Â∞áÊúÉÂú®Â∑•‰ΩúÂ§©Êï∏Ë®àÁÆóÊôÇËá™ÂãïÊéíÈô§ÔºàÈúÄÈóúÈñâ„ÄåÂåÖÂê´ÈÄ±Êú´„ÄçË®≠ÂÆöÔºâ"})]})]})};function Cn(){return e.jsx(Ns,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow",children:e.jsx("div",{className:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Project Tracker"}),e.jsxs("nav",{className:"flex space-x-4",children:[e.jsx(te,{to:"/",className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"È¶ñÈ†Å"}),e.jsx(te,{to:"/projects",className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"Â∞àÊ°àÁÆ°ÁêÜ"}),e.jsx(te,{to:"/wbs",className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"WBS ÁÆ°ÁêÜ"}),e.jsx(te,{to:"/wbs/tree",className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"WBS Ê®πÁãÄÂúñ"}),e.jsx(te,{to:"/dependencies",className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"‰æùË≥¥Èóú‰øÇ"}),e.jsx(te,{to:"/pending",className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"ÂæÖËæ¶Ê∏ÖÂñÆ"}),e.jsx(te,{to:"/issues",className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"ÂïèÈ°åËøΩËπ§"}),e.jsx(te,{to:"/gantt",className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"ÁîòÁâπÂúñ"}),e.jsx(te,{to:"/backup",className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"ÂÇô‰ªΩÁÆ°ÁêÜ"}),e.jsx(te,{to:"/settings",className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"Á≥ªÁµ±Ë®≠ÂÆö"})]})]})})}),e.jsx("main",{children:e.jsxs(vs,{children:[e.jsx(je,{path:"/",element:e.jsx(cn,{})}),e.jsx(je,{path:"/projects",element:e.jsx(on,{})}),e.jsx(je,{path:"/wbs",element:e.jsx(xn,{})}),e.jsx(je,{path:"/wbs/tree",element:e.jsx(mn,{})}),e.jsx(je,{path:"/dependencies",element:e.jsx(pn,{})}),e.jsx(je,{path:"/pending",element:e.jsx(jn,{})}),e.jsx(je,{path:"/issues",element:e.jsx(_n,{})}),e.jsx(je,{path:"/gantt",element:e.jsx(vn,{})}),e.jsx(je,{path:"/backup",element:e.jsx(wn,{})}),e.jsx(je,{path:"/settings",element:e.jsx(Sn,{})})]})})]})})}ot.createRoot(document.getElementById("root")).render(e.jsx(ws.StrictMode,{children:e.jsx(Cn,{})}));
